Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Swagatam Haldar 1 Christoph Stein-Thoeringer 1 2 3 Vadim Borisov 1 2 3
Abstract
Understanding the complex interactions within
the microbiome is crucial for developing effec-
tive diagnostic and therapeutic strategies. Tra-
ditional machine learning models often lack in-
terpretability, which is essential for clinical and
biological insights. This paper explores the ap-
plication of symbolic regression (SR) to micro-
biome relative abundance data, with a focus on
colorectal cancer (CRC). SR, known for its high
interpretability, is compared against traditional
machine learning models, e.g., random forest,
gradient boosting decision trees.
These mod-
els are evaluated based on performance metrics
such as F1 score and accuracy. We utilize 71
studies encompassing from various cohorts over
10,000 samples across 749 species features. Our
results indicate that SR not only competes rea-
sonably well in terms of predictive performance,
but also excels in model interpretability. SR pro-
vides explicit mathematical expressions that offer
insights into the biological relationships within
the microbiome, a crucial advantage for clini-
cal and biological interpretation.
Our experi-
ments also show that SR can help understand
complex models like XGBoost via knowledge
distillation. To aid in reproducibility and further
research, we have made the code openly avail-
able at https://github.com/swag2198/
microbiome-symbolic-regression.
1. Introduction
The microbiome, a complex and diverse ecosystem located
across various body sites, plays a crucial role in host func-
tions impacting health and disease (Curry et al., 2021; Go-
maa, 2020; Durack & Lynch, 2019). This study focuses
on the relative abundances of stool microbial species in
*Equal contribution
1University of Tübingen, Germany
2University Clinic Tuebingen, Germany
3Cluster of Excellence
"Controlling Microbes to Fight Infections", University of Tübin-
gen, Germany.
Correspondence to: Swagatam Haldar <swa-
gatam.haldar9@gmail.com>.
Preliminary work. Preprint.
both healthy individuals and patients with colorectal cancer
(CRC), although our methods are applicable to other com-
positional data as well. Understanding the key microbial
players in CRC is essential for developing targeted diagnos-
tic and therapeutic strategies.
Recent advancements in machine learning (ML) have sig-
nificantly improved the analysis of complex biological data.
Traditional ML approaches, such as linear models, decision
trees, ensemble methods, and neural networks, have been
widely used for this purpose (Gordon-Rodriguez et al., 2022;
Hernández Medina et al., 2022). However, these methods
often do not provide explainable insights, which are crucial
for clinical and biological interpretations.
Symbolic regression (SR) emerges as a powerful alternative,
offering clear, interpretable mathematical models of data
relationships. Unlike standard ML models that often act as
blackboxes, SR provides explicit equations that are inher-
ently interpretable. In our study, we leverage SR to dissect
the relationships within microbiome data, implementing it
through a commonly used package gplearn1, enhanced
by custom functions suitable for microbiome analyses. This
helps to construct explanatory graphs that detail microbial
interactions and their implications in CRC.
The contributions of this paper are twofold:
• Introduction of a novel application of symbolic regres-
sion to microbiome data, demonstrating its superior
explainability properties compared to traditional ML
approaches.
• Development and validation of a custom set of func-
tions that extends the capability of SR tools for en-
hanced biological data interpretation, enabling more
effective communication of complex microbial rela-
tionships to non-specialist audiences.
2. Background
2.1. Background on Microbiome Relative Abundance
Data
Microbiome relative abundance data quantifies the propor-
tion of various microbial entities within a sample. Unlike
1https://github.com/trevorstephens/gplearn
1
arXiv:2410.16109v1  [cs.LG]  18 Oct 2024
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
absolute abundance, which counts the exact number of or-
ganisms, relative abundance indicates the relative percent-
age each microorganism contributes to the total sample (Neu
et al., 2021). The inherent complexity of microbiome rel-
ative abundance data represents significant analytical chal-
lenges. Each data point represents a percentage, creating val-
ues ranging from 0 to 100 after normalization. The dataset
is characterized by high dimensionality, with up to 2000
features that are mostly sparse (containing many zeros), and
each row sums to 100. This necessitates specialized analyt-
ical techniques capable of handling data sparsity and high
dimensionality.
Variations in the gut microbiome composition have been
linked to a wide range of health conditions, from psycho-
logical disorders to diabetes and obesity, underscoring the
potential of microbiome studies to impact various medical
fields (Gomaa, 2020; Cullin et al., 2021).
2.2. Background on Symbolic Regression
Supervised machine learning tries to understand the relation-
ship between some input variables (e.g., features of patients)
and output variable(s) or target(s) (e.g., presence of a dis-
ease) by updating the parameters of a model using past ob-
servations. Many machine learning models, such as neural
networks, decision trees, and others, can achieve high accu-
racy but often lack transparency. Symbolic regression (SR)
is a technique that learns the input-target relationship us-
ing transparent equations involving mathematical operators.
The operator set can be simple arithmetic operations (+, −,
×, /), functions of arbitrary arity (e.g., log(.), max(., .)) in-
cluding the flexibility of including custom, domain specific
functions. SR has been applied to noisy scientific data for
equation discovery (Schmidt & Lipson, 2009; Bongard &
Lipson, 2007; Schmidt & Lipson, 2010), and recently used
as a supervised classification method (Korns, 2018; Fong &
Motani, 2024).
SR learns the best mathematical expression from data using
genetic programming or evolutionary algorithms which are
popularized in the 90s (Koza, 1994) and even modern SR
algorithms incorporate GP as their primary workhorse (Pe-
tersen et al., 2021; Cranmer, 2020; Stephens). The core idea
of GP is to maintain a population of equations and evaluate
their fitness (e.g., for classification it could be accuracy or
any other metric), and subsequently perform mutation and
selection of best-performing equation from the population.
3. Symbolic Regression for Relative
Abundance Data
In this section, we discuss the modifications we have made
on top of off-the-shelf symbolic regression to interpret rela-
tive abundance data better. Since we primarily care about
the presence (or absence) of one bacterium (or multiple
species together), we introduce a few custom functions that
enforce such relationships:
presence(x) =
(
1,
if x > 0,
0,
otherwise.
(1)
presence_both(x1, x2) =
(
1,
if x1 > 0 and x2 > 0,
0,
otherwise.
(2)
Similarly, absence and absence_both are defined to indi-
cate the absence of a single species or two species together.
We also define:
ifelse(x1, x2) =
(
x1,
if x1 > x2,
x2,
otherwise.
(3)
to take a bacterium having higher abundance. We denote this
symbolic regression model with these custom functions as
SRf and evaluate its performance along with other baselines.
4. Experiments
The primary goals of our experiments is to first verify the
accuracy of SR against other classification models, and
second, to establish the effectiveness of SR in identifying
the most influential gut microbial species for predicting
CRC.
Datasets:
This study utilized 71 datasets from the
curatedMetagenomicData library (Pasolli et al.,
2017). From these datasets, we selected 11, 137 samples
classified as either healthy or CRC. This selection resulted
in a highly imbalanced dataset, with 10, 473 healthy individ-
uals and only 664 CRC patients. To address this imbalance,
we performed random undersampling of the healthy indi-
viduals. Detailed statistics of the datasets and our data
processing steps are provided in Appendix A.
ML models: We selected a set of the most commonly used
ML models of varying degrees of complexity and inter-
pretability (Borisov et al., 2022): Logistic Regression (LR),
Decision Tree (DT), Random Forest (RF) (Breiman, 2001),
and XGBoost (XG) (Chen & Guestrin, 2016) for bench-
marking against the Symbolic Regression (SR) method. We
abbreviate Symbolic Regression with our custom functions
added as SRf. We used the scikit-learn (Pedregosa et al.,
2011) and gplearn (Stephens) libraries for ML models and
our implementations of SRf.
We investigated the following research questions:
RQ1: How does SR compare with other ML models in
terms of classification accuracy and F1 score? What is the
2
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Table 1. Metrics (balanced) for healthy vs. CRC binary classifica-
tion problem. Result shows SR, although below par compared to
complex models like RF & XG (bolded), performs similarly (with
lower variance) to other interpretable models like LR and DT.
Models
Accuracy (↑)
F1 score (↑)
LR
0.75 ±0.023
0.72 ±0.023
DT
0.74 ±0.024
0.70 ±0.031
RF
0.82 ±0.015
0.78 ±0.018
XG
0.83 ±0.015
0.80 ±0.015
SR
0.75 ±0.011
0.70 ±0.011
SRf
0.75 ±0.015
0.69 ±0.017
effect of incorporating custom functions?
RQ2: How can we identify the influential microbial species
for CRC prediction from the expressions provided by SR?
RQ3: Can SR be used as a knowledge distillation method
to understand or explain a complex, black-box model (e.g.,
XGBoost) with high accuracy but low interpretability?
4.1. Benchmarking
We report the classification accuracy and F1 score of se-
lected ML models in classifying the test set patients into
healthy or CRC categories. As mentioned earlier (Sec. 4),
we have drawn 20 random (balanced) subsamples of our
data and provide the mean and standard deviation of the met-
rics in Table 1. We observed that although the SR models
perform below par compared to complex but uninterpretable
models like XG and RF, they performed similarly to other
interpretable models (LR and DT), and notably with lower
variance.
Interestingly, between SR and SRf, we note a difference in
their total expression lengths (number of nodes in a graph).
The mean length of SR is 19.55, while that for SRf is 14.55.
In 16 out of the 20 runs, the expressions found by SRf are
smaller than those of SR. Thus, adding custom functions
(such as presence, absence, ifelse etc.) has the benefit
of reducing the learned expression size in our experiments.
We show one SRf expression tree learned in Figure 1 (corre-
sponding SR expression in Appendix D).
We emphasize here that even though RF and XG models are
composed of many decision trees, they are not considered
inherently interpretable models. SR and SRf are advanta-
geous over them as they identify few variables and show
explicit mathematical dependencies between them as shown
in Figure 1. We also investigate how SR can be used as an
interpretable surrogate for complex models in Section 4.3.
max
Streptococcus
pasteurianus
add
Gemella
morbillorum
max
Parvimonas
micra
max
max
Dialister
pneumosintes
add
Parvimonas
micra
ifelse >
Fusobacterium
ulcerans
Mogibacterium
diversum
Catenibacterium
mitsuokai
Figure 1. Visualization of an SRf expression learned using
gplearn. The added custom function ifelse helped to reduce its
size down to 15 nodes while the SR (without custom functions)
expression for the same run had 25 nodes (figure in Appendix D).
4.2. Discovering species from SR expressions
Having established that SR performs comparably well for
this task, we now discuss how the interpretable expressions
can be leveraged to discover influential bacteria associated
with CRC (or healthy) individuals. In Table 2, we list the
bacteria species that appear most frequently in the 10 SRf
expressions and discuss their significance, if any.
Validating this feature importance analysis is challenging
due to several factors: absence of ground truth, expensive
wet lab validation, and variability in dataset sources. How-
ever, multiple independent studies have shown that bacte-
ria from our top 10 list are related to the development or
progression of CRC cancer: Gemella morbillorum (Shimo-
mura et al., 2023; Chang et al., 2021), Mogibacterium di-
versum (Chen et al., 2024), Fusobacterium ulcerans (Cullin
et al., 2021; Amitay et al., 2017), Parvimonas micra (Chang
et al., 2021; Zhao et al., 2022; Löwenmark et al., 2020; Os-
man et al., 2021; Conde-Pérez et al., 2024), Fusobacterium
nucleatum (Cullin et al., 2021; Amitay et al., 2017; Osman
3
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Table 2. Top 10 bacteria species out of 749 extracted from sym-
bolic regression (SRf) expressions. This ordered list is computed
by parsing the 20 SRf expressions fitted on random subsamples
of the data and counting how many times each bacterium appears
across all the expressions.
Bacteria
Count
Gemella morbillorum
27
Mogibacterium diversum
25
Fusobacterium ulcerans
25
Parvimonas micra
25
Fusobacterium nucleatum
14
Dialister pneumosintes
10
Catenibacterium mitsuokai
4
Butyricicoccus pullicaecorum
4
Streptococcus cristatus
4
Romboutsia ilealis
3
et al., 2021).
To provide a quantitative perspective, we present the mean
and standard deviation values of the top 10 features in our
datasets in the Appendix (Fig. 4). These statistics offer
insight into the variability and central tendency of the key
features identified by SR.
Overall, this shows that the SRf approach can be a valu-
able tool for identifying key bacterial species associated
with CRC, providing a foundation for further biological
validation and potential therapeutic targets.
4.3. Knowledge Distillation from XGBoost using SR
In Section 4.1, we have shown that the gradient-boosting
decision tree model (XG) is the best-performing model for
the selected binary classification task. However, it is a
black-box model consisting of 50 decision trees, and it is
not straightforward to understand how XGBoost decides
the label for a particular sample. We now demonstrate
how we can obtain simple expressions that achieve similar
performance to XG using SRf.
To distill the knowledge from the fitted XG model, we col-
lect its predicted labels on the training examples, and fit the
SRf models on these new labels (instead of original labels
as used earlier in Sec. 4.1). So now the learned symbolic
expression would mimic the XG model in its predictions,
thereby giving an interpretable surrogate for the blackbox.
We present the distilled expression in Figure 2 (details in
caption). Interestingly, it also features two of the most harm-
ful bacteria as identified in the last section.
5. Related Works
Understanding the interpretability of machine learning mod-
els, especially in the context of microbiome research, has
gained significant attention in recent years. Traditional
absence
absence_both
Mogibacterium
diversum
Parvimonas
micra
Figure 2. Visualization of the SRf expression obtained by fitting it
on predictions by XG. The expression is a composition of absence
& absence_both functions which ultimately implies the presence
of atleast one of the two identified bacteria in CRC patients. This
simple expression gives the same prediction as XG (with 50 trees)
to over 80% of cases while being straightforward to understand.
models like logistic regression, decision trees, random for-
est, and XGBoost have been widely utilized for predictive
tasks, including those involving microbiome data (Gordon-
Rodriguez et al., 2022; Hernández Medina et al., 2022).
There are tools such as TAMPA (Sarwal et al., 2022) that
provide visualization of metagenomics-based taxon abun-
dance profiles. However, these models often fall short in
providing clear, interpretable insights crucial for clinical
and biological applications. Explainability techniques, such
as LIME (Ribeiro et al., 2016) and SHAP (Lundberg &
Lee, 2017), have been employed to enhance interpretability,
though they still rely on post-hoc explanations.
Symbolic regression (SR) offers an alternative by generating
explicit expressions that describe the relationships within the
data. Previous studies have demonstrated SR’s potential for
high interpretability (Cranmer et al., 2020; Kamienny et al.,
2022). In microbiome data, SR provides direct insights into
associations between microbial species and health outcomes.
Additionally, the endoR framework (Ruaud et al., 2022) in-
terprets tree-based models by converting them into simpler,
rule-based representations. Integrating SR and knowledge
distillation presents a promising direction for enhancing the
interpretability of machine learning models in microbiome
research, facilitating a nuanced understanding of microbial
interactions and their implications for health and disease.
6. Conclusion and Future Work
In this paper, we presented the application of the Symbolic
Regression (SR) model for interpreting microbiome rela-
tive abundance data by comparing it to common machine
learning models, evaluating the expressions given by SR,
4
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
and showing how one can improve the compactness of the
SR model by utilizing domain specific functions. In future
work, we will focus on improving the robustness of these
findings through larger datasets and enhanced validation
methods. We also leave methods to take advantage of the
sparsity present in the dataset to future work.
Overall, our study demonstrates the potential of Symbolic
Regression in microbiome research, balancing predictive
performance and interpretability. By offering explicit math-
ematical expressions, SR enables deeper understanding of
biological relationships within the microbiome, crucial for
clinical and biological interpretation. Additionally, knowl-
edge distillation shows promise in simplifying complex
models like XGBoost, making them more accessible for
scientific inquiry and practical applications.
References
Structure, function and diversity of the healthy human mi-
crobiome. nature, 486(7402):207–214, 2012.
Amitay, E. L., Werner, S., Vital, M., Pieper, D. H., Höfler,
D., Gierse, I.-J., Butt, J., Balavarca, Y., Cuk, K., and
Brenner, H. Fusobacterium and colorectal cancer: causal
factor or passenger? results from a large colorectal cancer
screening study. Carcinogenesis, 38(8):781–788, 2017.
Asnicar, F., Manara, S., Zolfo, M., Truong, D. T., Scholz,
M., Armanini, F., Ferretti, P., Gorfer, V., Pedrotti, A., Tett,
A., et al. Studying vertical microbiome transmission from
mothers to infants by strain-level metagenomic profiling.
MSystems, 2(1):e00164–16, 2017.
Asnicar, F., Berry, S. E., Valdes, A. M., Nguyen, L. H., Pic-
cinno, G., Drew, D. A., Leeming, E., Gibson, R., Le Roy,
C., Khatib, H. A., et al. Microbiome connections with
host metabolism and habitual diet from 1,098 deeply phe-
notyped individuals. Nature medicine, 27(2):321–332,
2021.
Bedarf, J. R., Hildebrand, F., Coelho, L. P., Sunagawa, S.,
Bahram, M., Goeser, F., Bork, P., and Wüllner, U. Func-
tional implications of microbial and viral gut metagenome
changes in early stage l-dopa-naïve parkinson’s disease
patients. Genome medicine, 9:1–13, 2017.
Bengtsson-Palme, J., Hartmann, M., Eriksson, K. M., Pal,
C., Thorell, K., Larsson, D. G. J., and Nilsson, R. H.
Metaxa2: improved identification and taxonomic classi-
fication of small and large subunit rrna in metagenomic
data. Molecular ecology resources, 15(6):1403–1414,
2015.
Bongard, J. and Lipson, H. Automated reverse engineering
of nonlinear dynamical systems. Proceedings of the Na-
tional Academy of Sciences, 104(24):9943–9948, 2007.
Borisov, V., Leemann, T., Seßler, K., Haug, J., Pawelczyk,
M., and Kasneci, G. Deep neural networks and tabular
data: A survey. IEEE Transactions on Neural Networks
and Learning Systems, 2022.
Breiman, L. Random forests. Machine learning, 45:5–32,
2001.
Brito, I. L., Yilmaz, S., Huang, K., Xu, L., Jupiter, S. D.,
Jenkins, A. P., Naisilisili, W., Tamminen, M., Smillie,
C. S., Wortman, J. R., et al. Mobile genes in the hu-
man microbiome are structured from global to individual
scales. Nature, 535(7612):435–439, 2016.
Chang, H., Mishra, R., Cen, C., Tang, Y., Ma, C., Wasti,
S., Wang, Y., Ou, Q., Chen, K., and Zhang, J. Metage-
nomic analyses expand bacterial and functional profiling
biomarkers for colorectal cancer in a hainan cohort, china.
Current Microbiology, 78:705–712, 2021.
Chen, Q., Huang, X., Zhang, H., Jiang, X., Zeng, X., Li, W.,
Su, H., Chen, Y., Lin, F., Li, M., et al. Characterization of
tongue coating microbiome from patients with colorectal
cancer. Journal of Oral Microbiology, 16(1):2344278,
2024.
Chen, T. and Guestrin, C. Xgboost: A scalable tree boosting
system. In Proceedings of the 22nd acm sigkdd inter-
national conference on knowledge discovery and data
mining, pp. 785–794, 2016.
Chu, D. M., Ma, J., Prince, A. L., Antony, K. M., Seferovic,
M. D., and Aagaard, K. M. Maturation of the infant
microbiome community structure and function across
multiple body sites and in relation to mode of delivery.
Nature medicine, 23(3):314–326, 2017.
Conde-Pérez, K., Buetas, E., Aja-Macaya, P., Martin-De Ar-
ribas, E., Iglesias-Corrás, I., Trigo-Tasende, N., Nasser-
Ali, M., Estévez, L. S., Rumbo-Feal, S., Otero-Alén, B.,
et al. Parvimonas micra can translocate from the sub-
gingival sulcus of the human oral cavity to colorectal
adenocarcinoma. Molecular Oncology, 18(5):1143–1173,
2024.
Costea, P. I., Zeller, G., Sunagawa, S., Pelletier, E., Alberti,
A., Levenez, F., Tramontano, M., Driessen, M., Hercog,
R., Jung, F.-E., et al. Towards standards for human fe-
cal sample processing in metagenomic studies. Nature
biotechnology, 35(11):1069–1076, 2017.
Cranmer, M. Pysr: Fast & parallelized symbolic regression
in python/julia. Zenodo, September, 2020.
Cranmer, M., Sanchez Gonzalez, A., Battaglia, P., Xu, R.,
Cranmer, K., Spergel, D., and Ho, S. Discovering sym-
bolic models from deep learning with inductive biases.
Advances in neural information processing systems, 33:
17429–17442, 2020.
5
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Cullin, N., Antunes, C. A., Straussman, R., Stein-
Thoeringer, C. K., and Elinav, E. Microbiome and cancer.
Cancer Cell, 39(10):1317–1341, 2021.
Curry, K. D., Nute, M. G., and Treangen, T. J. It takes
guts to learn: machine learning techniques for disease
detection from the gut microbiome. Emerging Topics in
Life Sciences, 5(6):815–827, 2021.
David, L. A., Weil, A., Ryan, E. T., Calderwood, S. B., Har-
ris, J. B., Chowdhury, F., Begum, Y., Qadri, F., LaRocque,
R. C., and Turnbaugh, P. J. Gut microbial succession
follows acute secretory diarrhea in humans. MBio, 6(3):
10–1128, 2015.
De Filippis, F., Pasolli, E., Tett, A., Tarallo, S., Naccarati,
A., De Angelis, M., Neviani, E., Cocolin, L., Gobbetti,
M., Segata, N., et al. Distinct genetic and functional traits
of human intestinal prevotella copri strains are associated
with different habitual diets. Cell host & microbe, 25(3):
444–453, 2019.
Dhakan, D., Maji, A., Sharma, A., Saxena, R., Pulikkan, J.,
Grace, T., Gomez, A., Scaria, J., Amato, K., and Sharma,
V. The unique composition of indian gut microbiome,
gene catalogue, and associated fecal metabolome deci-
phered using multi-omics approaches. Gigascience, 8(3):
giz004, 2019.
Durack, J. and Lynch, S. V. The gut microbiome: Relation-
ships with disease and opportunities for therapy. Journal
of experimental medicine, 216(1):20–40, 2019.
Feng, Q., Liang, S., Jia, H., Stadlmayr, A., Tang, L., Lan, Z.,
Zhang, D., Xia, H., Xu, X., Jie, Z., et al. Gut microbiome
development along the colorectal adenoma–carcinoma
sequence. Nature communications, 6(1):6528, 2015.
Ferretti, P., Pasolli, E., Tett, A., Asnicar, F., Gorfer, V.,
Fedi, S., Armanini, F., Truong, D. T., Manara, S., Zolfo,
M., et al. Mother-to-infant microbial transmission from
different body sites shapes the developing infant gut mi-
crobiome. Cell host & microbe, 24(1):133–145, 2018.
Fong, K. S. and Motani, M.
Symbolic regression en-
hanced decision trees for classification tasks.
Pro-
ceedings of the AAAI Conference on Artificial Intelli-
gence, 38(11):12033–12042, Mar. 2024. doi: 10.1609/
aaai.v38i11.29091. URL https://ojs.aaai.org/
index.php/AAAI/article/view/29091.
Gomaa, E. Z. Human gut microbiota/microbiome in health
and diseases: a review. Antonie Van Leeuwenhoek, 113
(12):2019–2040, 2020.
Gordon-Rodriguez, E., Quinn, T., and Cunningham, J. P.
Data augmentation for compositional data: Advancing
predictive models of the microbiome. Advances in Neural
Information Processing Systems, 35:20551–20565, 2022.
Gupta, H., Youn, G. S., Shin, M. J., and Suk, K. T. Role of
gut microbiota in hepatocarcinogenesis. Microorganisms,
7(5):121, 2019.
Hall, A. B., Yassour, M., Sauk, J., Garner, A., Jiang, X.,
Arthur, T., Lagoudas, G. K., Vatanen, T., Fornelos, N.,
Wilson, R., et al. A novel ruminococcus gnavus clade
enriched in inflammatory bowel disease patients. Genome
medicine, 9:1–12, 2017.
Hannigan, G. D., Duhaime, M. B., Ruffin IV, M. T.,
Koumpouras, C. C., and Schloss, P. D. Viral and bacterial
communities of colorectal cancer. BioRxiv, pp. 152868,
2017.
Hansen, L. B., Roager, H. M., Søndertoft, N. B., Gøbel,
R. J., Kristensen, M., Vallès-Colomer, M., Vieira-Silva,
S., Ibrügger, S., Lind, M. V., Mærkedahl, R. B., et al. A
low-gluten diet induces changes in the intestinal micro-
biome of healthy danish adults. Nature communications,
9(1):4630, 2018.
Heintz-Buschart, A., May, P., Laczny, C. C., Lebrun, L. A.,
Bellora, C., Krishna, A., Wampach, L., Schneider, J. G.,
Hogan, A., De Beaufort, C., et al. Integrated multi-omics
of the human gut microbiome in a case study of familial
type 1 diabetes. Nature microbiology, 2(1):1–13, 2016.
Hernández Medina, R., Kutuzova, S., Nielsen, K. N., Jo-
hansen, J., Hansen, L. H., Nielsen, M., and Rasmussen,
S. Machine learning and deep learning applications in
microbiome research. ISME communications, 2(1):98,
2022.
Ianiro, G., Iorio, A., Porcari, S., Masucci, L., Sanguinetti,
M., Perno, C. F., Gasbarrini, A., Putignani, L., and
Cammarota, G. How the gut parasitome affects human
health. Therapeutic advances in gastroenterology, 15:
17562848221091524, 2022.
Ijaz, U. Z., Quince, C., Hanske, L., Loman, N., Calus, S. T.,
Bertz, M., Edwards, C. A., Gaya, D. R., Hansen, R.,
McGrogan, P., et al. The distinct features of microbial
‘dysbiosis’ of crohn’s disease do not occur to the same ex-
tent in their unaffected, genetically-linked kindred. PloS
one, 12(2):e0172605, 2017.
Jie, Z., Xia, H., Zhong, S.-L., Feng, Q., Li, S., Liang, S.,
Zhong, H., Liu, Z., Gao, Y., Zhao, H., et al. The gut micro-
biome in atherosclerotic cardiovascular disease. Nature
communications, 8(1):845, 2017.
Kamienny, P.-A., d’Ascoli, S., Lample, G., and Charton,
F. End-to-end symbolic regression with transformers.
Advances in Neural Information Processing Systems, 35:
10269–10281, 2022.
6
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Karlsson, F. H., Tremaroli, V., Nookaew, I., Bergström, G.,
Behre, C. J., Fagerberg, B., Nielsen, J., and Bäckhed,
F. Gut metagenome in european women with normal,
impaired and diabetic glucose control. Nature, 498(7452):
99–103, 2013.
Kaur, K., Khatri, I., Akhtar, A., Subramanian, S., and
Ramya, T. Metagenomics analysis reveals features unique
to indian distal gut microbiota. PloS one, 15(4):e0231197,
2020.
Keohane, D. M., Ghosh, T. S., Jeffery, I. B., Molloy, M. G.,
O’Toole, P. W., and Shanahan, F. Microbiome and health
implications for ethnic minorities after enforced lifestyle
changes. Nature Medicine, 26(7):1089–1095, 2020.
Kieser, S., Sarker, S. A., Sakwinska, O., Foata, F., Sultana,
S., Khan, Z., Islam, S., Porta, N., Combremont, S., Be-
trisey, B., et al. Bangladeshi children with acute diarrhoea
show faecal microbiomes with increased streptococcus
abundance, irrespective of diarrhoea aetiology. Environ-
mental microbiology, 20(6):2256–2269, 2018.
Korns, M. F. An evolutionary algorithm for big data multi-
class classification problems. Genetic Programming The-
ory and Practice XIV, pp. 165–178, 2018.
Kostic, A. D., Gevers, D., Siljander, H., Vatanen, T.,
Hyötyläinen, T., Hämäläinen, A.-M., Peet, A., Tillmann,
V., Pöhö, P., Mattila, I., et al. The dynamics of the human
infant gut microbiome in development and in progres-
sion toward type 1 diabetes. Cell host & microbe, 17(2):
260–273, 2015.
Koza, J. R. Genetic programming as a means for program-
ming computers by natural selection. Statistics and com-
puting, 4:87–112, 1994.
Kurilshikov, A., van den Munckhof, I. C., Chen, L., Bonder,
M. J., Schraa, K., Rutten, J. H., Riksen, N. P., de Graaf,
J., Oosting, M., Sanna, S., et al. Gut microbial asso-
ciations to plasma metabolites linked to cardiovascular
phenotypes and risk: a cross-sectional study. Circulation
research, 124(12):1808–1820, 2019.
Le Chatelier, E., Nielsen, T., Qin, J., Prifti, E., Hildebrand,
F., Falony, G., Almeida, M., Arumugam, M., Batto, J.-M.,
Kennedy, S., et al. Richness of human gut microbiome
correlates with metabolic markers. Nature, 500(7464):
541–546, 2013.
Li, J., Jia, H., Cai, X., Zhong, H., Feng, Q., Sunagawa, S.,
Arumugam, M., Kultima, J. R., Prifti, E., Nielsen, T., et al.
An integrated catalog of reference genes in the human
gut microbiome. Nature biotechnology, 32(8):834–841,
2014.
Li, J., Zhao, F., Wang, Y., Chen, J., Tao, J., Tian, G., Wu,
S., Liu, W., Cui, Q., Geng, B., et al. Gut microbiota
dysbiosis contributes to the development of hypertension.
Microbiome, 5:1–19, 2017.
Li, S. S., Zhu, A., Benes, V., Costea, P. I., Hercog, R., Hilde-
brand, F., Huerta-Cepas, J., Nieuwdorp, M., Salojärvi,
J., Voigt, A. Y., et al. Durable coexistence of donor and
recipient strains after fecal microbiota transplantation.
Science, 352(6285):586–589, 2016.
Liu, W., Zhang, J., Wu, C., Cai, S., Huang, W., Chen, J.,
Xi, X., Liang, Z., Hou, Q., Zhou, B., et al.
Unique
features of ethnic mongolian gut microbiome revealed
by metagenomic analysis. Scientific reports, 6(1):34826,
2016.
Lloyd-Price, J., Arze, C., Ananthakrishnan, A. N., Schirmer,
M., Avila-Pacheco, J., Poon, T. W., Andrews, E., Ajami,
N. J., Bonham, K. S., Brislawn, C. J., et al. Multi-omics
of the gut microbial ecosystem in inflammatory bowel
diseases. Nature, 569(7758):655–662, 2019.
Lokmer, A., Cian, A., Froment, A., Gantois, N., Viscogliosi,
E., Chabé, M., and Segurel, L. Use of shotgun metage-
nomics for the identification of protozoa in the gut micro-
biota of healthy individuals from worldwide populations
with various industrialization levels. PloS one, 14(2):
e0211139, 2019.
Louis, S., Tappu, R.-M., Damms-Machado, A., Huson,
D. H., and Bischoff, S. C. Characterization of the gut mi-
crobial community of obese patients following a weight-
loss intervention using whole metagenome shotgun se-
quencing. PLoS One, 11(2):e0149564, 2016.
Löwenmark, T., Löfgren-Burström, A., Zingmark, C., Eklöf,
V., Dahlberg, M., Wai, S. N., Larsson, P., Ljuslinder,
I., Edin, S., and Palmqvist, R. Parvimonas micra as
a putative non-invasive faecal biomarker for colorectal
cancer. Scientific reports, 10(1):15250, 2020.
Lundberg, S. M. and Lee, S.-I. A unified approach to inter-
preting model predictions. Advances in neural informa-
tion processing systems, 30, 2017.
Mehta, R. S., Abu-Ali, G. S., Drew, D. A., Lloyd-Price, J.,
Subramanian, A., Lochhead, P., Joshi, A. D., Ivey, K. L.,
Khalili, H., Brown, G. T., et al. Stability of the human
faecal microbiome in a cohort of adult men.
Nature
microbiology, 3(3):347–355, 2018.
Nagy-Szakal, D., Williams, B. L., Mishra, N., Che, X., Lee,
B., Bateman, L., Klimas, N. G., Komaroff, A. L., Levine,
S., Montoya, J. G., et al. Fecal metagenomic profiles
in subgroups of patients with myalgic encephalomyeli-
tis/chronic fatigue syndrome. Microbiome, 5:1–17, 2017.
7
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Neu, A. T., Allen, E. E., and Roy, K. Defining and quan-
tifying the core microbiome: challenges and prospects.
Proceedings of the National Academy of Sciences, 118
(51):e2104429118, 2021.
Nielsen, H. B. Systematic review of near-infrared spec-
troscopy determined cerebral oxygenation during non-
cardiac surgery. Frontiers in physiology, 5:70501, 2014.
Obregon-Tito, A. J., Tito, R. Y., Metcalf, J., Sankara-
narayanan, K., Clemente, J. C., Ursell, L. K., Zech Xu,
Z., Van Treuren, W., Knight, R., Gaffney, P. M., et al.
Subsistence strategies in traditional societies distinguish
gut microbiomes. Nature communications, 6(1):6505,
2015.
Osman, M. A., Neoh, H.-m., Ab Mutalib, N.-S., Chin, S.-
F., Mazlan, L., Raja Ali, R. A., Zakaria, A. D., Ngiu,
C. S., Ang, M. Y., and Jamal, R. Parvimonas micra,
peptostreptococcus stomatis, fusobacterium nucleatum
and akkermansia muciniphila as a four-bacteria biomarker
panel of colorectal cancer. Scientific reports, 11(1):2925,
2021.
Pasolli, E., Schiffer, L., Manghi, P., Renson, A., Obenchain,
V., Truong, D. T., Beghini, F., Malik, F., Ramos, M.,
Dowd, J. B., Huttenhower, C., Morgan, M., Segata, N.,
and Waldron, L. Accessible, curated metagenomic data
through ExperimentHub. Nat. Methods, 14(11):1023–
1024, oct 2017. ISSN 1548-7091, 1548-7105. doi: 10.
1038/nmeth.4468.
Pasolli, E., Asnicar, F., Manara, S., Zolfo, M., Karcher, N.,
Armanini, F., Beghini, F., Manghi, P., Tett, A., Ghensi, P.,
et al. Extensive unexplored human microbiome diversity
revealed by over 150,000 genomes from metagenomes
spanning age, geography, and lifestyle. Cell, 176(3):
649–662, 2019.
Pedregosa, F., Varoquaux, G., Gramfort, A., Michel, V.,
Thirion, B., Grisel, O., Blondel, M., Prettenhofer, P.,
Weiss, R., Dubourg, V., et al. Scikit-learn: Machine
learning in python. the Journal of machine Learning
research, 12:2825–2830, 2011.
Pehrsson, E. C., Tsukayama, P., Patel, S., Mejía-Bautista,
M., Sosa-Soto, G., Navarrete, K. M., Calderon, M., Cabr-
era, L., Hoyos-Arango, W., Bertoli, M. T., et al. Inter-
connected microbiomes and resistomes in low-income
human habitats. Nature, 533(7602):212–216, 2016.
Petersen, B. K., Landajuela, M., Mundhenk, T. N., Santiago,
C. P., Kim, S. K., and Kim, J. T. Deep symbolic regres-
sion: Recovering mathematical expressions from data via
risk-seeking policy gradients, 2021.
Qin, J., Li, Y., Cai, Z., Li, S., Zhu, J., Zhang, F., Liang, S.,
Zhang, W., Guan, Y., Shen, D., et al. A metagenome-wide
association study of gut microbiota in type 2 diabetes.
nature, 490(7418):55–60, 2012.
Qin, N., Yang, F., Li, A., Prifti, E., Chen, Y., Shao, L., Guo,
J., Le Chatelier, E., Yao, J., Wu, L., et al. Alterations of
the human gut microbiome in liver cirrhosis. Nature, 513
(7516):59–64, 2014.
Rampelli, S., Schnorr, S. L., Consolandi, C., Turroni, S.,
Severgnini, M., Peano, C., Brigidi, P., Crittenden, A. N.,
Henry, A. G., and Candela, M. Metagenome sequencing
of the hadza hunter-gatherer gut microbiota. Current
Biology, 25(13):1682–1693, 2015.
Raymond, F., Ouameur, A. A., Déraspe, M., Iqbal, N., Gin-
gras, H., Dridi, B., Leprohon, P., Plante, P.-L., Giroux,
R., Bérubé, È., et al. The initial state of the human gut
microbiome determines its reshaping by antibiotics. The
ISME journal, 10(3):707–720, 2016.
Ribeiro, M. T., Singh, S., and Guestrin, C. " why should
i trust you?" explaining the predictions of any classifier.
In Proceedings of the 22nd ACM SIGKDD international
conference on knowledge discovery and data mining, pp.
1135–1144, 2016.
Rosa, B. A., Supali, T., Gankpala, L., Djuardi, Y., Sartono,
E., Zhou, Y., Fischer, K., Martin, J., Tyagi, R., Bolay,
F. K., et al. Differential human gut microbiome assem-
blages during soil-transmitted helminth infections in in-
donesia and liberia. Microbiome, 6:1–19, 2018.
Ruaud, A., Pfister, N., Ley, R. E., and Youngblut, N. D.
Interpreting tree ensemble machine learning models with
endor. PLOS Computational Biology, 18(12):e1010714,
2022.
Rubel, M. A., Abbas, A., Taylor, L. J., Connell, A., Tanes,
C., Bittinger, K., Ndze, V. N., Fonsah, J. Y., Ngwang,
E., Essiane, A., et al.
Lifestyle and the presence of
helminths is associated with gut microbiome composition
in cameroonians. Genome biology, 21:1–32, 2020.
Sankaranarayanan, K., Ozga, A. T., Warinner, C., Tito, R. Y.,
Obregon-Tito, A. J., Xu, J., Gaffney, P. M., Jervis, L. L.,
Cox, D., Stephens, L., et al. Gut microbiome diversity
among cheyenne and arapaho individuals from western
oklahoma. Current Biology, 25(24):3161–3169, 2015.
Sarwal, V., Brito, J., Mangul, S., and Koslicki, D.
Tampa:
interpretable
analysis
and
visualization
of
metagenomics-based
taxon
abundance
profiles.
bioRxiv, 2022.
doi:
10.1101/2022.04.28.489926.
URL
https://www.biorxiv.org/content/
early/2022/04/29/2022.04.28.489926.
8
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Schirmer, M., Smeekens, S. P., Vlamakis, H., Jaeger, M.,
Oosting, M., Franzosa, E. A., Ter Horst, R., Jansen, T.,
Jacobs, L., Bonder, M. J., et al. Linking the human gut mi-
crobiome to inflammatory cytokine production capacity.
Cell, 167(4):1125–1136, 2016.
Schirmer, M., Franzosa, E. A., Lloyd-Price, J., McIver,
L. J., Schwager, R., Poon, T. W., Ananthakrishnan, A. N.,
Andrews, E., Barron, G., Lake, K., et al. Dynamics of
metatranscription in the inflammatory bowel disease gut
microbiome. Nature microbiology, 3(3):337–346, 2018.
Schmidt, M. and Lipson, H. Distilling free-form natural
laws from experimental data. science, 324(5923):81–85,
2009.
Schmidt, M. and Lipson, H.
Symbolic Regression of
Implicit Equations, pp. 73–85. Springer US, Boston,
MA, 2010. ISBN 978-1-4419-1626-6. doi: 10.1007/
978-1-4419-1626-6_5. URL https://doi.org/10.
1007/978-1-4419-1626-6_5.
Shimomura, Y., Zha, L., Komukai, S., Narii, N., Sobue,
T., Kitamura, T., Shiba, S., Mizutani, S., Yamada, T.,
Sawada, N., et al. Mediation effect of intestinal micro-
biota on the relationship between fiber intake and col-
orectal cancer. International Journal of Cancer, 152(9):
1752–1762, 2023.
Smits, S. A., Leach, J., Sonnenburg, E. D., Gonzalez, C. G.,
Lichtman, J. S., Reid, G., Knight, R., Manjurano, A.,
Changalucha, J., Elias, J. E., et al. Seasonal cycling in the
gut microbiome of the hadza hunter-gatherers of tanzania.
Science, 357(6353):802–806, 2017.
Stephens, T.
Welcome to gplearn’s documentation!¶.
URL https://gplearn.readthedocs.io/en/
stable/.
Tett, A., Huang, K. D., Asnicar, F., Fehlner-Peach, H., Pa-
solli, E., Karcher, N., Armanini, F., Manghi, P., Bonham,
K., Zolfo, M., et al. The prevotella copri complex com-
prises four distinct clades underrepresented in western-
ized populations. Cell host & microbe, 26(5):666–679,
2019.
Thomas, A. M., Manghi, P., Asnicar, F., Pasolli, E., Ar-
manini, F., Zolfo, M., Beghini, F., Manara, S., Karcher,
N., Pozzi, C., et al. Metagenomic analysis of colorectal
cancer datasets identifies cross-cohort microbial diagnos-
tic signatures and a link with choline degradation. Nature
medicine, 25(4):667–678, 2019.
Vatanen, T., Kostic, A. D., d’Hennezel, E., Siljander, H.,
Franzosa, E. A., Yassour, M., Kolde, R., Vlamakis, H.,
Arthur, T. D., Hämäläinen, A.-M., et al. Variation in
microbiome lps immunogenicity contributes to autoim-
munity in humans. Cell, 165(4):842–853, 2016.
Vieira-Silva, S., Falony, G., Belda, E., Nielsen, T., Aron-
Wisnewsky, J., Chakaroun, R., Forslund, S. K., Assmann,
K., Valles-Colomer, M., Nguyen, T. T. D., et al. Statin
therapy is associated with lower prevalence of gut micro-
biota dysbiosis. Nature, 581(7808):310–315, 2020.
Vincent, C., Miller, M. A., Edens, T. J., Mehrotra, S., De-
war, K., and Manges, A. R. Bloom and bust: intestinal
microbiota dynamics in response to hospital exposures
and clostridium difficile colonization or infection. Micro-
biome, 4:1–11, 2016.
Vogtmann, E., Hua, X., Zeller, G., Sunagawa, S., Voigt,
A. Y., Hercog, R., Goedert, J. J., Shi, J., Bork, P., and
Sinha, R. Colorectal cancer and the human gut micro-
biome: reproducibility with whole-genome shotgun se-
quencing. PloS one, 11(5):e0155362, 2016.
Wampach, L., Heintz-Buschart, A., Fritz, J. V., Ramiro-
Garcia, J., Habier, J., Herold, M., Narayanasamy, S.,
Kaysen, A., Hogan, A. H., Bindl, L., et al. Birth mode is
associated with earliest strain-conferred gut microbiome
functions and immunostimulatory potential. Nature com-
munications, 9(1):5091, 2018.
Wirbel, J., Pyl, P. T., Kartal, E., Zych, K., Kashani, A.,
Milanese, A., Fleck, J. S., Voigt, A. Y., Palleja, A., Pon-
nudurai, R., et al. Meta-analysis of fecal metagenomes
reveals global microbial signatures that are specific for
colorectal cancer. Nature medicine, 25(4):679–689, 2019.
Xie, H., Guo, R., Zhong, H., Feng, Q., Lan, Z., Qin, B.,
Ward, K. J., Jackson, M. A., Xia, Y., Chen, X., et al.
Shotgun metagenomics of 250 adult twins reveals genetic
and environmental impacts on the gut microbiome. Cell
systems, 3(6):572–584, 2016.
Yachida, S., Mizutani, S., Shiroma, H., Shiba, S., Nakajima,
T., Sakamoto, T., Watanabe, H., Masuda, K., Nishimoto,
Y., Kubo, M., et al. Metagenomic and metabolomic anal-
yses reveal distinct stage-specific phenotypes of the gut
microbiota in colorectal cancer. Nature medicine, 25(6):
968–976, 2019.
Yassour, M., Lim, M. Y., Yun, H. S., Tickle, T. L., Sung,
J., Song, Y.-M., Lee, K., Franzosa, E. A., Morgan, X. C.,
Gevers, D., et al. Sub-clinical detection of gut micro-
bial biomarkers of obesity and type 2 diabetes. Genome
medicine, 8:1–14, 2016.
Yassour, M., Jason, E., Hogstrom, L. J., Arthur, T. D., Tri-
pathi, S., Siljander, H., Selvenius, J., Oikarinen, S., Hyöty,
H., Virtanen, S. M., et al. Strain-level analysis of mother-
to-child bacterial transmission during the first few months
of life. Cell host & microbe, 24(1):146–154, 2018.
9
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Ye, Z., Zhang, N., Wu, C., Zhang, X., Wang, Q., Huang,
X., Du, L., Cao, Q., Tang, J., Zhou, C., et al. A metage-
nomic study of the gut microbiome in behcet’s disease.
Microbiome, 6:1–13, 2018.
Yu, J., Feng, Q., Wong, S. H., Zhang, D., yi Liang, Q.,
Qin, Y., Tang, L., Zhao, H., Stenvang, J., Li, Y., et al.
Metagenomic analysis of faecal microbiome as a tool
towards targeted non-invasive biomarkers for colorectal
cancer. Gut, 66(1):70–78, 2017.
Zeevi, D., Korem, T., Zmora, N., Israeli, D., Rothschild, D.,
Weinberger, A., Ben-Yacov, O., Lador, D., Avnit-Sagi,
T., Lotan-Pompan, M., et al. Personalized nutrition by
prediction of glycemic responses. Cell, 163(5):1079–
1094, 2015.
Zeller, G., Tap, J., Voigt, A. Y., Sunagawa, S., Kultima,
J. R., Costea, P. I., Amiot, A., Böhm, J., Brunetti, F.,
Habermann, N., et al. Potential of fecal microbiota for
early-stage detection of colorectal cancer. Molecular
systems biology, 10(11):766, 2014.
Zhao, L., Zhang, X., Zhou, Y., Fu, K., Lau, H. C.-H., Chun,
T. W.-Y., Cheung, A. H.-K., Coker, O. O., Wei, H., Wu,
W. K.-K., et al. Parvimonas micra promotes colorectal
tumorigenesis and is associated with prognosis of col-
orectal cancer patients. Oncogene, 41(36):4200–4210,
2022.
Zhernakova, A., Kurilshikov, A., Bonder, M. J., Tigchelaar,
E. F., Schirmer, M., Vatanen, T., Mujagic, Z., Vila, A. V.,
Falony, G., Vieira-Silva, S., et al.
Population-based
metagenomics analysis reveals markers for gut micro-
biome composition and diversity. Science, 352(6285):
565–569, 2016.
Zhou, W., Sailani, M. R., Contrepois, K., Zhou, Y., Ahadi,
S., Leopold, S. R., Zhang, M. J., Rao, V., Avina, M.,
Mishra, T., et al.
Longitudinal multi-omics of host–
microbe dynamics in prediabetes. Nature, 569(7758):
663–671, 2019.
Zhu, F., Ju, Y., Wang, W., Wang, Q., Guo, R., Ma, Q., Sun,
Q., Fan, Y., Xie, Y., Yang, Z., et al. Metagenome-wide
association of gut microbiome features for schizophrenia.
Nature communications, 11(1):1612, 2020.
10
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
A. Datasets
Table 4 provides a general overview of the all 71 studies incorporated into our combined dataset. We specifically selected
samples classified as either healthy or colorectal cancer (CRC). The resulting dataset comprises 11, 137 samples, with
only 664 samples belonging to the positive CRC class. This class imbalance adds significant complexity to the problem,
underscoring the challenge of accurately predicting CRC presence. In our experiments, all models except XGBoost performed
poorly (F1 score in range 0.29-0.35) on the entire imbalanced dataset, hence we decided to randomly undersample the
healthy class. All baseline models received the same normalized data versions.
B. Reproducibility
We
utilized
open-source
Python
libraries
for
the
presented
analysis.
Our
code
and
additional
de-
tails
ro
reproduce
the
results
described
in
the
paper
can
be
found
in
this
github
repository:
https://github.com/swag2198/microbiome-symbolic-regression.
C. Details of the models used and hyperparameters
Table 3 provide details about the ML models used in our experiments, and also mention the hyperparameters used in fitting
the Symbolic Classifiers from gplearn library.
Table 3. Models used and their code instantiations.
Models
Parameters
LR
LogisticRegression(max_iter=500)
DT
DecisionTreeClassifier(max_depth=5)
RF
RandomForestClassifier(n_estimators=50)
XG
XGBClassifier(n_estimators=50, max_depth=5,
learning_rate=0.1, objective=’binary:logistic’)
SR
SymbolicClassifier(population_size=6000,generations=20,tournament_size=25,
init_depth=(2, 6), parsimony_coefficient=0.001)
D. Example of SR and SRf expression
Fig. 3 provides additional examples of obtained SR models.
11
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
max
Streptococcus
pasteurianus
add
Gemella
morbillorum
max
Parvimonas
micra
max
max
Dialister
pneumosintes
add
Parvimonas
micra
ifelse >
Fusobacterium
ulcerans
Mogibacterium
diversum
Catenibacterium
mitsuokai
max
Fusobacterium
nucleatum
max
Fusobacterium
necrophorum
add
sub
Fusobacterium
ulcerans
add
Lactobacillus
ruminis
max
Parvimonas
micra
Fusobacterium
necrophorum
add
sub
Fusobacterium
ulcerans
sub
Lactobacillus
ruminis
add
Aeriscardovia
aeriphila
max
Solobacterium
moorei
Mogibacterium
diversum
max
Parvimonas
micra
Gemella
morbillorum
Figure 3. (Left) We see an SRf expression learned using gplearn. The added custom function ifelse helps to reduce its size down
to 15 nodes while the SR expression for the same run had 25 nodes (Right).
12
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
Table 4. Overview of studies included in the analysis.
CuratedMetagenomicData ID
Number of Samples
Source
KarlssonFH_2013
145
Karlsson et al. (2013)
RubelMA_2020
175
Rubel et al. (2020)
AsnicarF_2017
24
Asnicar et al. (2017)
AsnicarF_2021
1098
Asnicar et al. (2021)
KaurK_2020
31
Kaur et al. (2020)
SankaranarayananK_2015
37
Sankaranarayanan et al. (2015)
KeohaneDM_2020
117
Keohane et al. (2020)
SchirmerM_2016
471
Schirmer et al. (2016)
KieserS_2018
27
Kieser et al. (2018)
BedarfJR_2017
59
Bedarf et al. (2017)
KosticAD_2015
120
Kostic et al. (2015)
SmitsSA_2017
40
Smits et al. (2017)
Bengtsson-PalmeJ_2015
70
Bengtsson-Palme et al. (2015)
LeChatelierE_2013
292
Le Chatelier et al. (2013)
TettAJ_2019_a
68
Tett et al. (2019)
BritoIL_2016
312
Brito et al. (2016)
LifeLinesDeep_2016
1135
Kurilshikov et al. (2019)
BrooksB_2017
408
Zhernakova et al. (2016)
LiJ_2014
260
Li et al. (2014)
LiJ_2017
196
Li et al. (2017)
ChuDM_2017
86
Chu et al. (2017)
ThomasAM_2018a
80
Thomas et al. (2019)
ThomasAM_2018b
60
Thomas et al. (2019)
ThomasAM_2019_c
80
Thomas et al. (2019)
CosteaPI_2017
279
Costea et al. (2017)
LiSS_2016
55
Li et al. (2016)
DavidLA_2015
47
David et al. (2015)
LiuW_2016
110
Liu et al. (2016)
DeFilippisF_2019
97
De Filippis et al. (2019)
LokmerA_2019
57
Lokmer et al. (2019)
VatanenT_2016
785
Vatanen et al. (2016)
DhakanDB_2019
110
Dhakan et al. (2019)
LouisS_2016
92
Louis et al. (2016)
VincentC_2016
229
Vincent et al. (2016)
FengQ_2015
154
Feng et al. (2015)
MehtaRS_2018
928
Mehta et al. (2018)
VogtmannE_2016
110
Vogtmann et al. (2016)
FerrettiP_2018
214
Ferretti et al. (2018)
MetaCardis_2020_a
1831
Vieira-Silva et al. (2020)
WampachL_2018
63
Wampach et al. (2018)
GuptaA_2019
60
Gupta et al. (2019)
NagySzakalD_2017
396
Nagy-Szakal et al. (2017)
WirbelJ_2018
125
Wirbel et al. (2019)
HallAB_2017
259
Hall et al. (2017)
NielsenHB_2014
396
Nielsen (2014)
XieH_2016
250
Xie et al. (2016)
HanniganGD_2017
81
Hannigan et al. (2017)
Obregon-TitoAJ_2015
58
Obregon-Tito et al. (2015)
YachidaS_2019
616
Yachida et al. (2019)
HansenLBS_2018
207
Hansen et al. (2018)
PasolliE_2019
112
Pasolli et al. (2019)
YassourM_2016
36
Yassour et al. (2016)
YassourM_2018
271
Yassour et al. (2018)
Heitz-BuschartA_2016
53
Heintz-Buschart et al. (2016)
PehrssonE_2016
191
Pehrsson et al. (2016)
QinJ_2012
363
Qin et al. (2012)
QinN_2014
237
Qin et al. (2014)
YuJ_2015
128
Yu et al. (2017)
YeZ_2018
65
Ye et al. (2018)
HMP_2012
748
hum (2012)
HMP_2019_ibdmdb
1627
Schirmer et al. (2018); Lloyd-Price et al. (2019)
HMP_2019_t2d
296
Zhou et al. (2019)
RampelliS_2015
38
Rampelli et al. (2015)
ZeeviD_2015
900
Zeevi et al. (2015)
IaniroG_2022
165
Ianiro et al. (2022)
RaymondF_2016
72
Raymond et al. (2016)
ZellerG_2014
156
Zeller et al. (2014)
IjazUZ_2017
94
Ijaz et al. (2017)
RosaBA_2018
24
Rosa et al. (2018)
ZhuF_2020
171
Zhu et al. (2020)
JieZ_2017
385
Jie et al. (2017)
13
Interpreting Microbiome Relative Abundance Data Using Symbolic Regression
healthy
CRC
disease
Gemella morbillorum
Mogibacterium diversum
Fusobacterium ulcerans
Parvimonas micra
Fusobacterium nucleatum
Dialister pneumosintes
Catenibacterium mitsuokai
Butyricicoccus pullicaecorum
Streptococcus cristatus
Fusobacterium nucleatum
Romboutsia ilealis
0.0 ± 0.01
0.037 ± 0.149
0.002 ± 0.016
0.014 ± 0.058
0.006 ± 0.24
0.024 ± 0.163
0.003 ± 0.078
0.154 ± 1.161
0.001 ± 0.017
0.022 ± 0.124
0.004 ± 0.078
0.038 ± 0.134
0.172 ± 0.94
0.1 ± 0.613
0.002 ± 0.045
0.015 ± 0.243
0.0 ± 0.003
0.004 ± 0.051
0.001 ± 0.017
0.022 ± 0.124
0.004 ± 0.019
0.001 ± 0.011
0.02
0.04
0.06
0.08
0.10
0.12
0.14
0.16
Figure 4. Mean and standard deviation values for selected species, derived from the feature importance analysis using the symbolic
regression model, indicate that for CRC, most identified bacteria exhibit higher relative abundance.
14
