Modeling the restricted mean survival time
using pseudo-value random forests
Alina Schenk1,∗, Vanessa Basten1,2, Matthias Schmid1
Abstract
The restricted mean survival time (RMST) has become a popular measure to
summarize event times in longitudinal studies. Defined as the area under the
survival function up to a time horizon τ > 0, the RMST can be interpreted as
the life expectancy within the time interval [0, τ]. In addition to its straightfor-
ward interpretation, the RMST also allows for the definition of valid estimands
for the causal analysis of treatment contrasts in medical studies. In this work,
we introduce a non-parametric approach to model the RMST conditional on a
set of baseline variables (including, e.g., treatment variables and confounders).
Our method is based on a direct modeling strategy for the RMST, using leave-
one-out jackknife pseudo-values within a random forest regression framework.
In this way, it can be employed to obtain precise estimates of both patient-
specific RMST values and confounder-adjusted treatment contrasts. Since our
method (termed “pseudo-value random forest”, PVRF) is model-free, RMST
estimates are not affected by restrictive assumptions like the proportional haz-
ards assumption. Particularly, PVRF offers a high flexibility in detecting rel-
evant covariate effects from higher-dimensional data, thereby expanding the
range of existing pseudo-value modeling techniques for RMST estimation. We
investigate the properties of our method using simulations and illustrate its
use by an application to data from the SUCCESS-A breast cancer trial. Our
numerical experiments demonstrate that PVRF yields accurate estimates of
both patient-specific RMST values and RMST-based treatment contrasts.
Keywords: Breast cancer survival; Pseudo-values; Random forest; Restricted
mean survival time; Survival analysis; Treatment contrast
1Institute for Medical Biometry, Informatics and Epidemiology, University of Bonn, Venusberg-
Campus 1, D-53127 Bonn, Germany 2Department of Mathematics, Informatics and Technology,
Koblenz University of Applied Sciences, Rhein-Ahr-Campus, Remagen, Germany ∗To whom corre-
spondence should be addressed, e-mail: alina.schenk@imbie.uni-bonn.de
1
arXiv:2411.01381v1  [stat.ME]  2 Nov 2024
1
Introduction
During the past years, an increasing number of statisticians and applied researchers
has advocated the use of the restricted mean survival time (RMST) to summarize
event times in longitudinal studies [1, 2]. Defined as the area under the survival
function within a time interval [0, τ], the RMST represents the expected event time
between zero and the “time horizon” τ > 0. In medical research, using the RMST
as a summary measure offers the following specific advantages: (i) its interpretation
as the life expectancy between 0 and τ is straightforward and easily understood by
both clinicians and patients [3], (ii) instead of a single time point (evaluated, e.g.,
by t-year survival probabilities in cancer research), the entire survival history up
to τ is reflected by the RMST, (iii) in contrast to the hazard ratio (HR) derived
from Cox regression, the RMST can be used for meaningful treatment comparisons
even when the proportional hazards (PH) assumption is violated [1, 4], and (iv) the
RMST can be used to define estimands for the causal interpretation of treatment
and interventional effects [5]. As a result, the reporting of the RMST in medical
studies has become increasingly prevalent [6, 7, 8].
In addition to the calculation of absolute RMST values, differences between group-
wise RMST values have been suggested as a measure of treatment contrasts in lon-
gitudinal studies [6]. In medical research, treatment contrasts are often expressed
and evaluated by the HR derived from a Cox proportional hazards model [1]. How-
ever, the interpretation of this type of HR is only valid if the PH assumption holds;
in particular, it assumes the HR to be constant over time.
Thus, Stensrud and
Hern´an [8] recommended to supplement the reporting of HRs by summary mea-
sures directly derived from the survival function S(t) = P(T > t) (with T denot-
ing the survival time).
The RMST belongs to this class of measures, as it can
be expressed as µ(τ) = E [min(T, τ)] =
R τ
0 S(t) dt and therefore directly summarizes
the survival function in [0, τ].
Similarly, the RMST difference for two treatment
groups A and B with survival functions SA(t) and SB(t), defined by µA(τ) −µB(τ)
=
R τ
0 (SA(t) −SB(t)) dt, can simply be interpreted as the difference in life expectancy
or as a gain (or loss) in event-free survival time before τ [3].
This paper is concerned with the estimation of individual RMSTs µ(τ|Xi) =
R τ
0 S(t|Xi) dt, i = 1, . . . , n, from a set of n independent individuals with possibly
right-censored event times and covariate values Xi = (X(1)
i , . . . , X(p)
i )⊤∈Rp. Note
that, for ease of notation and without loss of generality, we assume all treatment
and interventional variables to be included in Xi. Our method is characterized by a
non-parametric approach combining pseudo-value modeling [9] with random forest
2
regression [10, 11] (for details, see below). Using the estimated individual RMSTs,
we pursue two goals: (a) to incorporate the effects of a (possibly large and interact-
ing) set of covariates in the estimation of the RMST, and (b) to quantify and assess
accuracy of treatment effect estimation through RMST differences in observational
longitudinal trials.
Standard approaches to estimate individual RMSTs µ(τ|Xi) are the direct integra-
tion of (group-wise) Kaplan-Meier curves (leading to identical RMST estimates for
individuals belonging to the same treatment group) and the integration of survival
functions estimated through a parametric or semi-parametric time-to-event model
with covariates Xi (e.g., a Cox PH model or an accelerated failure time (AFT)
model [4, 12]). Using these standard approaches, the estimation of treatment effects
through RMST differences is straightforward. Previous research on RMST differ-
ences also includes the work by Royston & Parmar [1], Tian et al. [13] and Huang &
Kuan [14], who developed hypothesis tests for RMST differences derived by group-
wise integration of Kaplan-Meier curves. Clearly, the covariate-free Kaplan-Meier
approach is not recommended for use in non-randomized studies, as it ignores the
effects of potential confounders on RMST differences. While integrating estimated
survival functions derived from Cox or AFT models mitigates this problem, the va-
lidity of the resulting RMST estimates (as well as their differences) strongly depends
on the correctness of the underlying model and/or distributional assumptions [15].
Instead of estimating individual RMSTs by integrating survival functions derived
from time-to-event models, several authors have suggested to directly model the
RMST [16, 17, 18].
In general, the idea of direct modeling approaches is to es-
timate unconditional individual RMSTs (without using any covariate information)
and to subsequently fit a statistical model regressing these values to the covariates.
Key advantages of directly modeling the RMST are less restrictive distributional
assumptions as well as the straightforward interpretation of the model coefficients
[1, 3, 6, 19].
In this paper, we pursue a direct approach for modeling RMST values and their dif-
ferences. More specifically, the idea of our method is to derive unconditional RMST
values from jackknife pseudo-values and to regress these values to the covariates us-
ing random forests. Classical pseudo-value regression for the RMST difference [20]
is based on parametric models of the form
g[µ(τ|Xi)] = α + γTXi =: ηi ,
(1)
with a monotonic link function g, an intercept α and covariate effects γ. Note that
we suppress the dependency of α, γ and ηi on τ for ease of notation. Andersen et
3
al. [9] and Andersen & Pohar Perme [20] suggested to estimate unconditional RMST
values by leave-one-out jackknife pseudo-values ˆθi(τ) defined as
ˆθi(τ) = n ·
τ
Z
0
ˆSKM(t) dt −(n −1) ·
τ
Z
0
ˆS−i
KM(t) dt ,
i = 1, . . . , n,
(2)
where ˆSKM(t) denotes the Kaplan-Meier estimate evaluated at t calculated on the
complete data set and ˆS−i
KM(t) denotes the respective Kaplan-Meier estimate calcu-
lated on the data set without individual i.
The coefficients in (1) can be estimated by a generalized estimation equation (GEE)
approach, with g being the identity or the log link [9]. However, while the GEE
approach yields consistent estimates (n →∞) under the assumption of random
censoring [21, 22], its flexibility is limited by the restrictive specification of the pre-
dictor ηi in (2). More specifically, ηi = α + γTXi is defined by a linear combina-
tion of main effects terms, which might be too simplistic to describe the underlying
data-generating process. Although more flexible effect terms (representing e.g. in-
teraction terms or non-linear main effects) could be included in (1), this approach
is not commonly used in practice. Often, this is due to the fact that pre-specifying
an extended version of ηi requires detailed knowledge on the, usually unknown, de-
pendency structure between the pseudo-value outcome and the covariates. Further,
the GEE approach does, in its basic form, neither incorporate any mechanism for
data-driven variable selection nor perform any other sort of regularization to reduce
redundant or irrelevant information.
To address these issues, and to achieve the goals stated in (a) and (b), we propose
to replace the established GEE approach by a random forest regression [10]. This
regression model, which uses the pseudo-values ˆθi(τ) in (2) as continuous outcome
and which will be termed “pseudo-value random forest” (PVRF) in the following,
allows for an efficient data-driven selection of covariates and their interaction effects.
In this way, the need to pre-specify ηi is eliminated, making PVRF a particularly
convenient method for applications involving a large number of covariates compared
to the number of individuals (for instance, in medium-sized observational studies
containing many potential confounders). By applying a g-computation formula [23,
24] to the estimated RMST values, PVRF further allows for the direct estimation and
causal interpretation of RMST differences. To additionally facilitate interpretability
of the covariate effects, we propose to use state-of-the art methods for interpretable
machine learning, as described in Molnar [25].
The remainder of this paper is organized as follows: In Section 2.1, we start with the
4
definition and the properties of pseudo-values for RMST estimation, along with a
brief description of the standard GEE modeling approach. Section 2.2 provides a de-
tailed description of the PVRF method, showing, in particular, how to derive individ-
ual estimates of the RMST. In Section 2.3, we describe how to apply g-computation
for evaluating treatment contrasts by confounder-adjusted RMST differences. Sec-
tions 3 and 4 contain the results of a simulation study investigating the properties of
the PVRF method and comparing the proposed approach to established methods for
RMST estimation. Section 5 presents an application of the PVRF method to data
from the SUCCESS-A trial, a randomized phase III trial investigating the effects
of two treatment regimens on the disease-free survival of patients with early breast
cancer [26]. The main findings of the paper are summarized in Section 6, along with
a brief overview and discussion of related approaches.
2
Methods
As stated above, we consider a set of n independent individuals that are subject
to right-censoring. For each individual i = 1, . . . , n, we consider covariate values
Xi = (X(1)
i , . . . , X(p)
i ) measured at baseline. The individual survival time and cen-
soring time are denoted by Ti and Ci, respectively. The observed survival time is de-
noted by ˜Ti = min(Ti, Ci), and the status variable δi = 1{Ci>Ti} indicates whether the
i-th individual is censored (δi = 0) or whether the event of interest has been observed
(δi = 1). Following Graw et al. [21], we assume that the censoring times are inde-
pendent of both the covariates and the event times.
2.1
Estimation and modeling of the RMST via pseudo-values
When using the RMST, defined as µ(τ) = E [min(T, τ)] =
R τ
0 S(t) dt, as dependent
variable in a regression model, the outcome values are given by µi(τ) = min(Ti, τ),
i = 1, ..., n. By definition, these values depend on the survival times Ti, and, due to
censoring, cannot be observed for all individuals. Pseudo-value regression overcomes
this problem by replacing the partly incompletely observed outcome values with con-
tinuous (real-valued) pseudo-values ˆθi(τ) that can be computed for both censored and
uncensored individuals in the data set. For the RMST, the i-th pseudo-value at a
time horizon τ is given by the right-hand side of Equation (2). The pseudo-values
can subsequently be used as a (completely observed) imputation for the outcome
variable µi(τ) in the RMST regression model, facilitating the application of conven-
tional modeling techniques like linear regression or decision trees [27]. Overgaard et
al. [22] showed that the replacement of µi(τ) with the pseudo-values ˆθi(τ) enables
5
the consistent estimation of covariate effects on the RMST (see Overgaard et al. [22]
for details and regularity assumptions).
As seen from Figure 1, the characteristics of pseudo-values for the RMST depend
on the observed time ˜Ti, the censoring proportion in the data set and the time
horizon τ. If there is no censoring in the data (left panels in Figure 1), it holds
that ˆθi(τ) = ˜Ti = Ti if ˜Ti < τ and ˆθi(τ) = τ if ˜Ti ≥τ. For censored individuals
(middle and right panels in Figure 1), pseudo-values for the RMST are always larger
than the observed survival time ˜Ti (given that ˜Ti < τ). On the other hand, pseudo-
values of individuals with an observed event are mostly smaller than ˜Ti and might
even become negative when ˜Ti < τ. For ˜Ti ≥τ, it holds that ˆθi(τ) > τ for both
censored and uncensored individuals. Consequently, there is no difference between
individuals who were censored after time τ and those who were observed to experience
an event after τ [20].
In general, it appears hard to approximate the empirical
distribution of the pseudo-values by a parametric distribution, as the former strongly
depends on the time horizon τ, the distribution of the observed times, and the
censoring pattern in the data.
As outlined in Section 1, the standard approach to pseudo-value regression for the
RMST is to use the unconditional pseudo-values ˆθi(τ) as outcome variable in a GEE
model. For estimating the covariate effects using the GEE approach, it is convenient
to re-write Equation (1) as
g [µ(τ|Xi)] = α + γTXi = βTXi,. = ηi ,
(3)
where the augmented covariate vector Xi,. = (1, X⊤
i )⊤∈Rp+1 contains a dummy
variable for the intercept α. When modeling the RMST, g is typically set to the
identity link or the log link. The GEE estimate of β ∈Rp+1 is given by the solution
to
X
i
n ∂
∂β g−1(βTXi,.)
oT
V −1
i
n
ˆθi(τ) −g−1(βTXi,.)
o
= 0 ,
(4)
where Vi ∈R+ defines a working variance.
In practice, Vi is often set to 1, as
Klein & Andersen [28] found no advantage of using more complex variance terms.
The estimated coefficients ˆβ derived by solving (4) can be interpreted as direct effects
on the RMST if g is the identity link, or on the logarithm of the RMST if g is the
log link. A sandwich estimator can be used to estimate the variance of ˆβ [21].
Despite the popularity of the GEE approach, it is easily seen from (3) that the esti-
mated values of the RMST are constrained to a rather restrictive linear combination
6
Figure 1: Illustration of pseudo-values for the RMST, as derived from a data set
with n = 1000. The time horizons were set to τ = 6 (A) and τ = 8 (B). Censored
individuals are marked blue, individuals with an event are colored red. The dashed
vertical lines indicate the time horizon τ. In the data set with no censoring (left
panels), the pseudo-values are identical to the observed event times for ˜Ti < τ and
equal to τ for ˜Ti ≥τ. For censored individuals in data sets with censoring (blue
dots in the middle and right panels), it is observed that ˆθi(τ) > ˜Ti for ˜Ti < τ,
irrespective of the choice of τ and the censoring proportion. For individuals with an
observed event (red dots), there is no consistent pattern regarding the dependency of
pseudo-values on ˜Ti: In the middle panel of (A), referring to a smaller value of τ and
a lower censoring proportion, pseudo-values of individuals with an observed event
closely resemble the observed times. In contrast, in the right panel of (B), referring
to a larger value of τ and a higher censoring proportion, pseudo-values of individuals
with an observed event are mostly lower than the observed event time and can even
become negative. For ˜Ti ≥τ, it holds that ˆθi(τ) > τ for all censored and uncensored
individuals. The Figure has been adapted from Andersen & Pohar Perme [20].
7
of the covariate effects. Particularly, as stated in Section 1, ηi does not include any
interaction terms. While these terms can be incorporated by pre-specifying them
in ηi, it is well known that the number of interactions grows exponentially with the
number of covariates. This implies numerous coefficients to be estimated and makes
the GEE approach numerically unstable even in cases with a moderate number of
covariates. In particular, it results in a high variance of the GEE estimator. If there
is no expert knowledge available to pre-select a suitable (small) number of interaction
terms, data-driven variable selection techniques could be applied. However, classical
variable selection algorithms (such as forward, backward, or stepwise selection) also
show a high variability when including a larger number of interaction terms. As a
solution to the issues described above, we propose to apply random forest techniques
for modeling the RMST.
2.2
Random forest regression
To address the issues described in Section 2.1, we propose to model individual RMSTs
by using the pseudo-values ˆθi(τ) as continuous outcome variable in a random for-
est regression model [10, 11]. Random forest regression is characterized by aver-
aging estimates of multiple regression trees trained on different random subsets of
the data (“ensemble” of regression trees). In this way, overfitting is avoided, and
both interactions and non-linear covariate effects can be captured by the model [10].
The general idea of building a regression tree is to derive local estimates of the
outcome variable by partitioning the covariate space into a set of mutually exclu-
sive subspaces [29, 30, 31]. Beginning with the root node containing all individuals
i = 1, . . . , n, the idea is to successively evaluate a split criterion and to split in-
dividuals into two mutually exclusive sets termed daughter nodes. Each daughter
node Rm ⊆{1, . . . , n} is further split into two daughter nodes Rm1 ⊂Rm and
Rm2 ⊂Rm with Rm1 ∩Rm2 = ∅, and splitting is continued until some stopping
criterion applies (see Appendix B). In each node Rm, splitting is done by selecting
a split variable X(j) and a corresponding split rule Rmj that optimize a pre-defined
split criterion (e.g. the mean squared error).
The split criterion is evaluated on
the data of the individuals in the respective node.
In case of a continuous split
variable X(j), the split rule Rmj is given as “X(j)
i
≤ξmj vs. X(j)
i
> ξmj” defin-
ing two mutually exclusive subsets A(Rmj) = {X(j)
i | i ∈Rm and X(j)
i
≤ξmj} and
A∗(Rmj) = {X(j)
i | i ∈Rm and X(j)
i
> ξmj}, where ξmj ∈R is the threshold of the
split rule Rmj selected in node Rm. In case of a categorical split variable X(j), the
split rule Rmj defines two mutually exclusive subsets A(Rmj) and A∗(Rmj) of the
8
categories of X(j). In either case, the daughter nodes Rm1 and Rm2 are given as
Rm1 = {i | X(j)
i
∈A(Rmj)} ,
Rm2 = {i | X(j)
i
∈A∗(Rmj)} .
(5)
Nodes that are not further split into two daughter nodes because the stopping crite-
rion applies are referred to as leaf nodes. The route from the root node to a leaf node
is termed path. For calculating the estimated RMST value of a single individual, the
associated leaf node is determined by successively applying the split rules from the
root node to the leaf node. Afterwards, the RMST value is estimated by averaging
the observed pseudo-values ˆθi(τ) in the leaf node.
Random forest regression is usually characterized by growing large ensembles of
regression trees. In this paper, we will use 500 trees unless stated otherwise. Fur-
thermore, we follow the strategy recommended by de Bin et al.[32] and grow our
tree ensemble on subsamples of the complete data without replacement. Thus, each
tree in the forest is grown on a different subset of the data, leading to different split
rules and different RMST estimates in the leaf nodes. Additionally, only a random
subset of the covariates is considered for splitting the nodes of the regression trees. In
practice, the size of this subset (termed “mtry”) is either set to √p [33] or optimized
using cross-validation. In this paper, we applied five-fold cross-validation to deter-
mine the value of mtry, see Appendix B. The final RMST estimate for individual i
was obtained by dropping the covariate values Xi down to the leaf nodes of the 500
trees and by averaging the 500 tree estimates.
In the literature, there exist multiple tree building algorithms that vary in the pro-
cedure to select the split variables and the corresponding split rules. In this work,
we consider two different tree building algorithms that will be described briefly in
Sections 2.2.1 and 2.2.2: (i) classification and regression trees (CART) [29] and (ii)
conditional inference trees [30]. Correspondingly, the resulting forests will be referred
to as CART random forest and conditional random forest.
2.2.1
CART Random Forest
In each node Rm, the CART algorithm selects the split variable X(j) and the corre-
sponding split rule Rmj by minimizing the criterion
MSERmj =
X
i∈Rm1

ˆθi(τ) −c1
2
+
X
i∈Rm2

ˆθi(τ) −c2
2
(6)
9
over Rmj, where c1 and c2 are the averaged pseudo-values in the daughter nodes Rm1
and Rm2, respectively. Consequently, the split variable and the split rule minimizing
the mean squared errors of the pseudo-values ˆθi(τ) in the daughter nodes are selected
jointly by one minimization step. In practice, this leads the CART algorithm to
favor split variables with many possible splits, implying that the algorithm is usually
biased towards the selection of covariates with many possible splits (e.g. continuous
covariates) [30].
2.2.2
Conditional Random Forest
Unlike the CART algorithm, conditional inference trees [30] follow a two-step pro-
cess, selecting the optimal split variable by a set of statistical hypothesis tests before
determining the corresponding split rule. In this way, a selection bias towards co-
variates with many possible splits is avoided. More specifically, in the first step,
given a node Rm with data Lm = {(ˆθi(τ), X(1)
i , . . . , X(p)
i ) | i ∈Rm}, the split vari-
able is selected as the covariate showing the strongest association with the outcome
variable ˆθi(τ). Associations are measured by the generalized correlation coefficient
ρj(Lm) = vec
 X
i∈Rm
˜gj(X(j)
i ) · ˆθi(τ)
!
∈R˜pj ,
j = 1, . . . , p ,
(7)
where ˜gj(·) ∈R˜pj, j = 1, . . . , p, is a set of transformation functions depending on the
measurement scales of the covariates. For our purposes, we set ˜gj(X(j)
i ) = X(j)
i
if the
j-th covariate is measured on a continuous scale. For unordered and ordered factors,
the functions ˜gj(X(j)
i ) are given by a set of dummy variables with ˜pj equal to the
number of categories of X(j). For the hypothesis tests, the elements of ρj(Lm) are
first standardized (assuming independence between the covariates and the pseudo-
values in node m) and then transformed using the absolute value function [30]. The
so-obtained values can be interpreted as the absolute correlations between the co-
variates X(j), j = 1, . . . , p, and the pseudo-values ˆθi(τ) in node Rm. Afterwards, the
maximum values of the resulting standardized vectors are used to test the null hy-
potheses of independence between the covariates and the outcome. Altogether, there
are p maximum values, resulting in p hypothesis tests. Using random permutations
of the pseudo-values, the conditional distributions of the maximum values under the
null (i.e., independence between the covariates and the pseudo-values) are derived.
Finally, the covariate with minimum p-value in the permutation tests is selected as
split variable. Importantly, since the p-values do not depend on the scales of covari-
ates, the selection procedure does not show any systematic preference of covariates
with many possible splits.
10
The second step is to derive the split rule associated with the selected split variable.
Analogous to the CART algorithm, each possible split rule leads to two mutually
exclusive sets of individuals Rm1 and Rm2. To determine the optimal split rule, the
idea is to maximize the criterion
MAERm =

P
i∈Rm 1{i∈Rm1} · ˆθi(τ) −µm1
σm1

(8)
over all split rules, where µm1 and σm1 denote the conditional means and standard
deviations, respectively, of P
i∈Rm 1{i∈Rm1} · ˆθi(τ) (calculated in the same way as in
the standardization of ρj(Lm) above, cf. Hothorn et al. [30]). By definition, MAERm
measures the association between node membership and the pseudo-values, ensur-
ing that the outcome values of the individuals in the two daughter nodes become
maximally dissimilar.
2.3
Evaluating RMST differences
In medical research, a common aim is to compare subgroups of the population with
regard to their survival behavior. Usually, these subgroups are defined by an inter-
vention (e.g. treatment vs. control, see Section 5) or by the presence of a risk factor.
Following Royston & Parmar [4], Uno et al. [6] and Dehbi et al. [7], we quantify
differences in the survival behavior of population subgroups (in the following termed
“treatment contrasts”) using differences in RMST values. In randomized controlled
trials (RCTs), which usually allow for ignoring all covariates except the intervention
due to the randomization procedure, treatment contrasts can simply be estimated
by the differences of the average RMST values in the relevant groups. Clearly, the
calculation of treatment contrasts is less trivial when additional covariates have to be
taken into account, particularly in non-randomized studies where the covariates usu-
ally take the roles of confounders. In these cases, we propose to apply g-computation
to estimate treatment contrasts [23, 24]. More specifically, denoting the treatment
variable of individual i by X(trt)
i
and the respective confounders by X(−trt)
i
, we pro-
pose to calculate individual RMST differences (i = 1, . . . , n) as
ˆ∆i(τ) = ˆµ(τ|X(−trt)
i
, X(trt)
i
= A) −ˆµ(τ|X(−trt)
i
, X(trt)
i
= B) ,
(9)
where ˆµ denotes the RMST estimate obtained from the random forest model (see
Hu et al. [34] for alternative ways to define and estimate survival treatment effects).
Based on the individual RMST differences, the average treatment effect (= treatment
11
contrast) is estimated by
ˆ∆(τ) = 1
n
n
X
i=1
ˆ∆i(τ) = 1
n
n
X
i=1
ˆµ(τ|X(−trt)
i
, X(trt)
i
= A) −ˆµ(τ|X(−trt)
i
, X(trt)
i
= B) .
(10)
2.4
Pseudo-value random forest
Summarizing Sections 2.1 to 2.3, we define our proposed method (termed “pseudo-
value random forest”, PVRF) by the following steps:
1. Calculate pseudo-values ˆθi(τ), i = 1, . . . , n, for the RMST (Equation (2)).
2. Grow a random forest using either the CART algorithm (Section 2.2.1) or
conditional inference trees (Section 2.2.2).
3. Estimate individual RMST values ˆµ(τ|Xi), i = 1, . . . , n, from the fitted random
forest.
4. Depending on the research question,
(a) proceed analyzing estimated individual RMST values using interpretable
machine learning techniques (for details, see Section 5).
(b) estimate treatment contrasts ˆ∆(τ) from individual RMST differences ˆ∆i(τ),
i = 1, . . . , n (Equation (10)).
3
Experiments
To investigate the performance of PVRF, we carried out a comprehensive simulation
study in R (version 4.1.2 [35]). The data-generating process was based on a time-
to-event model with an additive combination of main and interaction effects. We
analyzed the ability of the PVRF approach to estimate RMSTs and RSMT differences
between treatment groups in the absence and presence of two-way interactions. To
this end, we considered scenarios with time-constant and time-varying treatment
effects. The simulation study was based on 100 Monte Carlo replications. In each
replication, we generated a training data set for model building and a test data set
for model evaluation, each of size n = 1000.
Survival times Ti, i = 1, . . . , n, were generated from a Weibull model with scale
12
parameter λ > 0, shape parameter ν > 0 and hazard function
h(t|Xi) = λ · exp (ηi(t)) · ν · tν−1 ,
(11)
where ηi(t) is the (possibly time-dependent) linear predictor of individual i (depend-
ing on Xi, see Equation (13)). The cumulative hazard function was given by
H(t|Xi) = λ · exp (ηi(t)) · tν.
(12)
The censoring times were generated independently of the survival times, using the
same Weibull model with ηi(t) = 0. The parameters λ and ν were adjusted such
that the data-generating process yielded the desired censoring proportions.
Overall, we examined four scenarios, each differing in the calculation of ηi(t). Each
scenario was characterized by five continuous covariates (denoted by X(j)
i , j =
1, . . . , 5) and five dichotomous covariates (denoted by X(j)
i , j = 6, . . . , 10). The con-
tinuous covariates followed a multivariate normal distribution with zero mean and
a covariance matrix as given in Table A1 in Appendix A. Dichotomous covariates
were independent and followed a Bernoulli distribution with probability 0.5 each.
In addition, we considered a dichotomous treatment variable X(trt)
i
(treatment A vs.
treatment B, Bernoulli distributed with probability 0.5). Depending on the scenario,
X(trt)
i
was either time-constant or time-varying (see Table 1). The scenarios further
differed in the structure of the interactions between the covariates and the strength
of the treatment effects. In general, we considered predictors of the form
ηi(t) =
10
X
j=1
δjX(j)
i
+
X
l∈{1,...,5}
m∈{1,...,5}
ψlmX(l)
i X(m)
i
+
X
r∈{1,...,5}
s∈{6,...,10}
φrsX(r)
i X(s)
i
+ ϑtrt(t)1{X(trt)
i
=B} ,
(13)
where δj, j = 1, . . . , 10, denote main effects of the continuous and the dichotomous
covariates, ψlm, l, m ∈{1, . . . , 5}, represent the interaction effects between the con-
tinuous covariates, φrs, r ∈{1, . . . , 5}, s ∈{6, . . . , 10}, represent the interaction
effects between the continuous and the dichotomous covariates, and ϑtrt(t) denotes
the (possibly time-varying) dichotomous treatment effect. All main and interaction
effects were sampled from a continuous uniform distribution on [−1, 1]; they were
generated independently of each other and were the same in all Monte Carlo replica-
tions. Furthermore, we added five independent standard normally distributed noise
variables to the covariate set. These were independent of the other covariates and
did not affect the predictor ηi(t). In Scenarios 1 and 2, the treatment effect was
13
Scenario
Effects of
continuous
covariates
Effects of
dichotomous
covariates
Interaction effects
Treatment effect
1
δj ∼U(−1, 1)
δj ∼U(−1, 1)
ψlm = 0 ∀l, m
ϑtrt(t) = −2
j = 1, . . . , 5
j = 6, . . . , 10
φrs = 0 ∀r, s
2
δj ∼U(−1, 1)
δj ∼U(−1, 1)
ψ13, ψ14, ψ23, ψ25, ψ45 ∼U(−1, 1)
ϑtrt(t) = −2
j = 1, . . . , 5
j = 6, . . . , 10
φ17, φ28, φ39 ∼U(−1, 1)
3
δj ∼U(−1, 1)
δj ∼U(−1, 1)
ψlm = 0 ∀l, m
ϑtrt(t) =
(
−2,
t ≤t0
2,
t > t0
j = 1, . . . , 5
j = 6, . . . , 10
φrs = 0 ∀r, s
4
δj ∼U(−1, 1)
δj ∼U(−1, 1)
ψ13, ψ14, ψ23, ψ25, ψ45 ∼U(−1, 1)
ϑtrt(t) =
(
−2,
t ≤t0
2,
t > t0
j = 1, . . . , 5
j = 6, . . . , 10
φ17, φ28, φ39 ∼U(−1, 1)
Table 1: Overview of the four scenarios used in the simulation study, each charac-
terized by five continuous covariates, five dichotomous covariates, eight interaction
effects (Scenarios 2 and 4), and a time-constant (Scenarios 1 and 2) or time-varying
(Scenarios 3 and 4) treatment effect. All interaction effects not contained in the
fourth column were set to zero.
time-constant, whereas in Scenarios 3 and 4, the treatment effect changed at the
transition time t0, resulting in crossing survival curves (Figure 3). Scenarios 1 and 3
included only main effects, whereas Scenarios 2 and 4 additionally included interac-
tion effects. Table 1 provides an overview of the four scenarios, and Figure 3 presents
the group-wise Kaplan-Meier curves for each scenario.
In each of the four scenarios, we considered three different censoring proportions
(25%, 50%, 75%) and five different values of the time horizon τ. The latter were
determined by the 50%, 60%, 70%, 80% and 90% quantiles of the observed times ˜Ti,
i = 1, . . . , n, denoted by q50%, q60%, q70%, q80% and q90%, respectively. The values
of τ, which were held fixed across the simulation runs, are given in Table A2 in
Appendix A. The transition time t0 in Scenarios 3 and 4 was set to q70%. In total,
each scenario examined 15 combinations of censoring proportions and time hori-
zons τ. For the values of the coefficients δj, ψlm and φrs, we refer to the R code at
https://www.imbie.uni-bonn.de/cloud/index.php/s/6gmJQmayFAMJZHk.
To evaluate performance of RMST estimates, we considered the mean squared error
defined by
MSE = 1
n
n
X
i=1
(ˆµ(τ|Xi) −µ(τ|Xi))2 ,
(14)
where ˆµ(τ|Xi) and µ(τ|Xi) denote the estimated and the theoretical RMSTs, respec-
14
tively, of individual i at time horizon τ. The root mean squared error (RMSE) is
defined as the square root of (14). The theoretical RMST in (14) is derived as
µ(τ|Xi) =
Z τ
0
S(t|Xi) dt =
Z τ
0
exp(−H(t|Xi)) dt
=







R τ
0 exp(−H1(t|Xi)) dt ,
τ ≤t0 ,
R t0
0 exp(−H1(t|Xi)) dt +
R τ
t0 exp(−H1(t0|Xi)
−H2(t|Xi) + H2(t0|Xi)) dt ,
τ > t0 ,
(15)
where H1(t|Xi) and H2(t|Xi) are the cumulative hazard functions before and af-
ter the transition point t0, respectively. Note that in Scenarios 1 and 2, the haz-
ards are constant over time and thus, H1(t|Xi) = H2(t|Xi), resulting in µ(τ|Xi) =
R τ
0 exp(−H1(t|Xi))dt for both τ ≤t0 and τ > t0. Analogously, evaluated the accu-
racy of treatment effect estimates by calculating the (root) mean squared error of
the treatment effect, defined as
MSE∆= 1
n
n
X
i=1

ˆ∆i(τ) −∆i(τ)
2
,
(16)
where ˆ∆i(τ) and ∆i(τ) denote the estimated and the theoretical individual treatment
effects, respectively, of individual i at time horizon τ (see Section 2.3). In addition to
evaluating the estimation accuracy of the CART random forest and the conditional
random forest approaches, we compared our proposed method to alternative model-
ing approaches. These were (i) a GEE pseudo-value model with identity link (GEE),
(ii) a GEE pseudo-value model with log link (GEE (log)), (iii) a Cox proportional
hazards model (Cox), (iv) a parametric AFT model (based on log-transformed sur-
vival times and assuming normally distributed errors [36], Lognormal), and (v) a cor-
rectly specified Cox proportional hazards model (Reference) serving as benchmark
for the performance measures. For the modeling approaches described in (i)-(iv),
we specified the main effects of all available continuous and dichotomous covariates
(including the noise variables) but did not consider any interaction terms. The Ref-
erence model was specified such that it corresponded to the true data-generating
process. More specifically, it incorporated the informative (= non-zero) main and
interaction effects only (see Table 1). In particular, the Reference model accounted
for the time-dependent treatment effect in Scenarios 3 and 4. This was accomplished
by specifying a time-varying stratification variable that enabled the Cox model to es-
timate a time-dependent treatment effect. Consequently, Reference served as a lower
benchmark in the RMSE and RMSE∆comparisons. For the Cox, Lognormal and
15
Reference models, which do not directly model the RMST, estimates of the RMST
were derived through the integration of the estimated survival function. Further de-
tails on the implementation of the methods are given in Appendix B. We anticipate
that the CART random forest and the conditional random forest approaches will out-
perform the Cox, Lognormal, GEE, and GEE (log) approaches in the scenarios with
non-zero interaction terms (Scenarios 2 and 4). Additionally, due to the time-varying
treatment effect, we expect the pseudo-value methods to outperform the Cox model
in Scenarios 3 and 4. Generally, we expect both the RMSE and RMSE∆values to
increase with τ, since the RMST also rises with τ.
4
Results
Figure 2 summarizes the simulation results of the four scenarios at a censoring pro-
portion of 50%. In the first scenario (main effects only, time-constant treatment
effect), both the average RMSE and the average RMSE∆increase with τ, as ex-
pected. This is true for all considered models. Notably, there is a clear difference
in terms of RMSE between the standard modeling techniques (Cox and Lognor-
mal) and the pseudo-value methods (GEE, GEE (log), CART random forest and
conditional random forest), with the best performing model being the Cox model
followed by the Lognormal model. This result can be explained by the fact that the
Cox model matches the data-generating mechanism (except for the noise variables).
Among the pseudo-value regression methods, the conditional random forest demon-
strates superior performance for τ ≤q60% followed by GEE, CART random forest
and GEE (log). However, this is no longer true when τ > q60%. In terms of the
RMSE for the treatment effect (RMSE∆), the Cox model demonstrates the best per-
formance, in line with our expectations, followed by the Lognormal model. Among
the pseudo-value methods, the conditional random forest performs best with regard
to treatment effect estimation, followed by the CART random forest. The application
of the log link in the GEE approach (GEE (log)) appears to have a negative effect on
both performance measures (first column of Figure 2). In Scenario 2 (non-zero inter-
action effects, time-constant treatment effect), the average RMSE∆increases with τ,
similar to Scenario 1. The tree-based pseudo-value methods, particularly the CART
random forest, performs best in terms of RMSE, having a slight advantage over the
conditional random forest. This result demonstrates the ability of tree-based meth-
ods to identify and model interactions between the covariates. All other methods
perform similar in this scenario. Regarding treatment effect estimation, the condi-
tional random forest performed best, having slight advantages over the standard Cox
and Lognormal modeling techniques, as well as over the CART random forest. Al-
16
Figure 2: Results of the simulation study (50% censoring). The upper panels present
the average RMSE (14), as obtained from the RMST estimates at different values
of τ. The lower panels present the average RMSE for the treatment effect (16). The
green colored dots refer to the PVRF method (CART random forest and conditional
random forest). The dashed black lines refer to the correctly specified Cox propor-
tional hazards model (Reference).
though the Cox and Lognormal models do not perform well in terms of RMSE, their
performance regarding treatment effect estimation is comparable to the respective
performance of the tree-based methods. On the other hand, the GEE with log link
shows a poor performance in the estimation of the treatment effect, with estimates
getting worse as τ increases (second column of Figure 2).
In Scenario 3 (main effects only, time-dependent treatment effect), the average RMSE
values of the standard modeling techniques Cox and Lognormal do not monotonically
increase with τ, as in Scenarios 1 and 2. Instead, there is a turning point in the RMSE
values at τ = t0 = q70%. This can be explained as follows: As seen from Figure 3,
the Cox model assumes a time-constant treatment effect, implying that the effect of
treatment B is underestimated when t ≤t0 = q70%. This in turn leads to strongly
biased RMST estimates. On the other hand, the Cox model overestimates the effect
of treatment B when t > t0 = q70%. Consequently, as RMST estimates are derived
by the area under the survival curve up to τ, the part of the area under the survival
17
curve that is not included in the RMST estimates for t ≤t0 = q70% is compensated
by the excess area under the estimated survival curve for t < t0 = q70%. As a result,
the Cox model yields decreasing RMSE values for τ > t0 = q70%. For the Lognormal
model, analogous observations can be made. In contrast, the pseudo-value methods
exhibit increasing RMSE values with rising τ, as expected. In general, the pseudo-
value methods (except for GEE (log)) outperform the Cox and Lognormal models
with respect to the RMSE for τ ≤t0. Specifically, the conditional random forest
demonstrates superior performance compared to the Cox and Lognormal models. On
the other hand, as the RMSE values obtained from the Cox and Lognormal models
decrease for τ > t0, these methods perform better than the pseudo-value methods at
τ = q90%. Regarding treatment effect estimation, the RMSE∆values obtained from
the pseudo-value methods increase with τ. In contrast, the RMSE∆values obtained
from the Cox model increase for τ ≤t0 = q70% but decrease for τ > t0 = q70%. Again,
this is due to the underestimation (overestimation) of the effect of treatment B for
t ≤t0 = q70% (t > t0 = q70%).
The tree-based methods (CART random forest
and conditional random forest) consistently perform best, regardless of the value
of τ, confirming their ability to capture the time-dependent treatment effect in this
scenario (third column of Figure 2).
In the presence of interaction effects, as in
Scenario 4 (non-zero interaction effects, time-dependent treatment effect), there is
a clear advantage of the tree-based methods (CART random forest and conditional
random forest) with respect to both, RMSE and RMSE∆(fourth column of Figure 2).
Again, these results highlight the ability of tree-based methods to model interaction
effects and to capture time-dependent treatment effects.
As seen from Figure 2,
the time-dependent treatment effect influences the trend of the RMSE∆values of
the Cox and Lognormal models, similar to Scenario 3, but not the trend of the
respective RMSE values. Of note, the CART random forest and conditional random
forest methods show the best performance across all time horizons τ.
In summary, when considering scenarios with interactions and/or time-varying treat-
ment effects, the proposed PVRF method (represented by the CART random forest
and the conditional random forest) performs better than standard modeling ap-
proaches in estimating the RMST. The CART random forest has a slight advan-
tage over the conditional random forest with respect to the RMSE in the presence
of interaction effects, as observed in Scenarios 2 and 4. Regarding the estimation
of treatment contrasts, the conditional random forest method performed best in
the scenarios with interactions and/or time-varying treatment effects.
The value
of τ relative to the transition time t0 significantly impacts the performance of the
standard modeling techniques Cox and Lognormal, especially in the scenarios with
time-varying treatment effects. The results obtained for 25% and 75% censoring are
18
Figure 3: Results of the simulation study (50% censoring). The dark lines depict
the Kaplan-Meier curves in the two treatment groups, as obtained from n = 1000
individuals with data generated according to Table 1 (including the true treatment
effects ϑtrt(t)). The bright lines depict the Kaplan-Meier curves derived from data
generated according to Table 1 but including the (time-constant) average treatment
effect estimated by the Cox method instead of the true treatment effect (Scenario 1:
ˆϑCox
trt (t) = −2.10, Scenario 2: ˆϑCox
trt (t) = −1.26, Scenario 3: ˆϑCox
trt (t) = −0.38, Sce-
nario 4: ˆϑCox
trt (t) = −0.33).
similar to the results shown in Figures 2 and 3. They are presented in Figures C1
and C2 in Appendix C.
5
Application
To illustrate the use of the PVRF approach, we applied the CART random forest
and the conditional random forest methods to data from the multicenter random-
ized phase III SUCCESS-A trial (NCT02181101). SUCCESS-A enrolled 3,754 pa-
tients with a primary invasive breast cancer between September 2005 and March
2007 [26]. Study participants were randomly assigned in a 1:1 ratio to one of two
treatment arms, which received either standard chemotherapy (control group) or
standard chemotherapy with the addition of gemcitabine (interventional group). For
details on the inclusion/exclusion criteria and the design of the study see de Gregorio
et al. [26]. The primary aim of the SUCCESS-A trial was to compare the two treat-
ment arms with respect to disease-free survival (DFS), defined as the period from the
date of randomization to the earliest date of disease progression (distant metastases,
local and contralocal recurrence, and secondary primary tumors) or death from any
19
cause [26, 37]. Here, we present the results of a secondary analysis that considered
DFS as the outcome of interest. Note that the definition of DFS includes death from
any cause. Accordingly, we did not consider death as a competing event. Patients
were censored at the last date at which they were known to be disease-free, result-
ing in an event proportion of 12.2% (458 events in 3,754 patients). The maximum
observation time was 5.5 years (6 months of chemotherapy followed by 5 years of
follow-up; median 5.2 years, first quartile 3.7 years, third quartile 5.5 years). Pa-
tient characteristics included age at randomization (age, measured in years), body
mass index (BMI, measured in kg/m2) and menopausal status (meno, two categories,
pre-/post-menopausal) as well as information on the tumor, including stage (stage,
four categories, pT1/pT2/pT3/pT4), grade (grade, three categories, G1/G2/G3),
lymph node status (nodal status, two categories, pN0/pN+), type (type, three cat-
egories, ductal/lobular/other) and receptor status of estrogen (ER), progesterone
(PR), and HER2 (two categories each, negative/positive). A descriptive summary
of the variables is given in Table D1 in Appendix D. Patients with missing values in
any of the considered covariates were excluded from our anaylsis. The analyzed data
comprised 3,652 patients. The main aim of our analysis was to model the RMST
for DFS at τ = 5 years, corresponding to the length of the follow-up period. To
this end, we applied the CART random forest, the conditional random forest, the
Cox model and the GEE model to the SUCCESS-A study data. The covariates
were defined by the treatment (control/intervention) and the ten patient & tumor
characteristics described above. Predictive accuracy of the models was measured by
the weighted residual sum of squares (WRSS), an inverse-probability-of-censoring
(IPC) weighted error measure introduced by Cwiling et al. [38], using five-fold cross
validation. Denoting the data in the five test folds by Dk ⊂{1, . . . , n}, k = 1, . . . , 5,
the cross-validated WRSS is defined by
WRSS = 1
5
5
X
k=1
WRSSk = 1
5
5
X
k=1
X
i∈Dk
1
|Dk|

min( ˜Ti, τ) −ˆµ(τ|Xi)
2
· ˆwi ,
(17)
with ˆµ(τ|Xi) denoting the estimated RMST for individual i derived on the data in
the training folds {1, . . . , n} \ Dk. The IPC weights ˆwi are defined by
ˆwi = 1{ ˜Ti ≤τ} · δi
ˆG( ˜Ti−|Xi)
+ 1{ ˜Ti > τ}
ˆG(τ|Xi)
,
(18)
where ˆG is a consistent estimator of the censoring survival function. In this work, we
use the Kaplan-Meier method to calculate ˆG. The cross-validated treatment effect
20
(measured in days, control vs. interventional group) was calculated as
ˆ∆(τ)
=
1
5
5
X
k=1
X
i∈Dk
1
|Dk| · ˆ∆i(τ)
=
1
5
5
X
k=1
X
i∈Dk
1
|Dk| ·
h
ˆµ(τ|X(−trt)
i
, X(trt)
i
= control)
−ˆµ(τ|X(−trt)
i
, X(trt)
i
= interventional)
i
.
(19)
To enhance the interpretability of the random forest methods, we computed the
permutation feature importance (PFIj) and Shapley values for each covariate (j =
1, . . . , 11) [25]. PFIj was determined on each test fold: Given the fitted model (here,
either the CART random forest or the conditional random forest), PFIj is defined as
the ratio of WRSSk with ˆµ(τ | Xi) derived by the fitted model but with permuted
values of the j-th covariate (numerator) and WRSSk with ˆµ(τ | Xi) calculated as
usual (denominator, see Equation (20)). Thus, higher PFIj values indicate a higher
importance of the j-th covariate for estimating the RMST. Local Shapley values
were derived for 1000 randomly selected patients. A high absolute local Shapley
value indicates a high importance of the respective covariate in the estimation of the
RMST.
The results of our analysis are presented in Figure 4. They show that the two random
forest methods detected several established prognostic factors and subgroups, which
have been consistently reported in the literature and have also entered treatment
guidelines for primary breast cancer [39, 40]. Regarding the WRSS (Figure 4 (A)),
the conditional random forest with a cross-validated
√
WRSS of (mean [min, max])
0.95 [0.91, 0.98] years and the Cox model (cross-validated
√
WRSS = 0.95 [0.90,
0.98] years) perform almost equally well. The CART random forest shows the worst
performance (cross-validated
√
WRSS = 1.00 [0.93, 1.03] years). The average treat-
ment effects ˆ∆(τ) estimated by the two random forest approaches are close to zero
(CART random forest: −0.14 [−2.88, 2.71] days, conditional random forest: 0.38
[−0.56, 1.71] days), indicating no advantage of any of the two groups. This supports
the results found by de Gregorio et al. [26], who concluded that the interventional
treatment does not improve survival in patients with high-risk early breast cancer.
In contrast, the Cox model indicated a slight advantage of the control group (average
treatment effect = 4.35 [−0.45, 11.65] days) while the GEE model indicated a slight
advantage of the interventional group (average treatment effect = −3.19 [−10.30,
6.03] days). Note, however, that the treatment difference is measured in days, so
21
Figure 4: Analysis of DFS in the SUCCESS-A study. The four panels present the
results obtained from the Cox, GEE, CART random forest and conditional random
forest methods. Panel (A) shows the WRSS (measured in years) and the treatment
effect ˆ∆(τ) (measured in days). The dots represent the five-fold cross-validated values
of WRSS and ˆ∆(τ), while the bars refer to the respective ranges of WRSS and ˆ∆(τ)
in the five folds. Panel (B) shows the estimated RMST values in patient groups
defined by molecular tumor subtypes, as obtained from the conditional random forest
method (see Table D2). Panel (C) shows the permutation feature importance of each
covariate for the CART random forest and the conditional random forest methods.
The dots represent the five-fold cross-validated values of PFIj and the bars refer to
the respective ranges in the five folds. Panel (D) presents local Shapley values for
each covariate, as obtained by evaluating the conditional random forest estimates
in 1000 randomly selected patients.
Each dot corresponds to one patient.
The
color codings used in Panel (D) are presented in the bottom row of the figure. The
estimated RMST values and local Shapley values obtained from the CART random
forest are shown in Figure D1 in Appendix D.
22
none of the obtained differences can be considered clinically relevant.
Figure 4 (B) visualizes the RMST values at τ = 5 years (estimated by the condi-
tional random forest on the complete cohort) in patient groups defined by molecular
tumor subtypes [41].
More specifically, HER2 positive patients are characterized
by HER2 positive tumors (regardless of ER status, PR status and grade). HER2
negative tumors are further classified into luminal A-like tumors (HER2 negative,
ER and/or PR status positive, grade G1 or G2), luminal B-like tumors (HER2
negative, ER and/or PR status positive, grade G3), and triple-negative tumors
(HER2, ER and PR status negative and any grade, see Table D2). According to
Figure 4 (B), the high-risk triple-negative group has the lowest estimated RMST val-
ues (mean (standard deviation): 4.47 (0.28) years), which is consistent with findings
in the literature [42]. Additionally, when comparing the luminal A-like and luminal
B-like subgroups, there appears to be a slight advantage (corresponding to higher es-
timated RMST values) of patients with tumor grade G1 (luminal A-like, 4.78 (0.09)
years) compared to those with tumor grade G2 or G3 (luminal B-like, 4.68 (0.11)
years). Again, this result is in line with previous findings in the literature [42]. The
comparison of luminal A-like, luminal B-like and triple-negative confirms the ability
of the conditional random forest to identify interactions between hormone receptor
status and grade.
As illustrated in Figure 4 (C), the PFIj values obtained from the conditional random
forest method identify nodal status as the most influential covariate in the estimation
of the RMST. The strong influence of nodal status on DFS has previously been
reported by Senkus et al. [40]. Other important covariates (in terms of PFIj) were
ER, stage, PR, grade, HER2 and BMI. Notably, all other covariates appear to have
negligible importance in estimating RMST values by the conditional random forest
method, including treatment. Again, this result is in line with the findings of de
Gregorio et al. [26]. Similar trends in PFIj were observed for the CART random
forest method.
The local Shapley values in Figure 4 (D) are also in line with previous findings in
the literature [40, 42, 43] and with the PFIj values in Figure 4 (C). As seen from
Figure 4 (D) lymph node positive patients (nodal status = pN+) exhibit higher
risk of recurrence or death, reflected by negative local Shapley values for these pa-
tients. Furthermore, the high Shapley values for ER confirm the importance of this
covariate in adjuvant hormonal and chemotherapy. The survival advantage of ER
positive patients [43] is reflected by positive Shapley values for this group. Con-
versely, negative Shapley values are observed for ER negative, PR negative, and
HER2 negative patients, which is consistent with lower estimated RMST values for
23
the triple-negative group in Figure 4 (B) [42]. Likewise, the difference in estimated
RMST values between luminal A-like and luminal B-like patients is confirmed by
the respective local Shapley values: Patients with grade G1 and G2 have a positive
contribution to the estimated RMST values, while patients with grade G3 contribute
negatively. Furthermore, the local Shapley values accurately reflect the hierarchy of
tumor stages: Tumor stage pT1 (best prognosis for DFS) has a positive contribution
to the estimated RMST, whereas tumor stages pT2 to pT4 have increasingly neg-
ative contributions. Shapley values for treatment spread around 0 for both groups,
suggesting neither a positive nor a negative contribution of the treatment group to
the estimated RMST. Again, this result is consistent with the findings in de Gregorio
et al. [26].
6
Discussion
During the past years, the restricted mean survival time has become an increasingly
popular measure for summarizing individual event times in medical studies. Com-
pared to other established measures like the hazard ratio, the RMST is derived from
survival probabilities measured at the untransformed risk scale, thereby avoiding
interpretability and collapsibility issues in the comparison of interventional groups
[44, 45]. As a consequence, the RMST is considered a valid survival estimand for
the causal interpretation of treatment contrasts in clinical and observational trials
[5, 46].
In this work, we proposed the pseudo-value random forest (PVRF) method, which is a
non-parametric approach for the quantification of treatment effects by group-specific
RMST values. Instead of estimating RMST values from (semi-)parametric models
like Cox or AFT regression, the PVRF method combines unconditional pseudo-value
RMST estimation with the subsequent fitting of a random forest. Of note, both
components of our method (i.e., pseudo-values and random forests) require mini-
mal assumptions on the data-generating process. While unconditional pseudo-values
are based on non-parametric Kaplan-Meier estimates, random forest regression is
a model-free algorithm allowing for variable selection and requiring no prior as-
sumptions on the structure of the covariate effects. As a result, the PVRF method
is particularly suited for incorporating subgroup characteristics, non-linearities, and
higher-order interactions affecting individual RMST values. In non-randomized stud-
ies, this approach is particularly useful when treatment effects need to be corrected
for higher-dimensional sets of confounders, allowing for the estimation of causal con-
trasts via g-computation (see Section 2.3). Furthermore, our method enables model-
24
free comparisons of treatment and control group(s) in randomized trials. Regarding
the latter, we demonstrated that PVRF is able to capture time-dependent treatment
effects in a data-driven way (see Section 3, where PVRF performed better than
(semi-)parametric approaches in the scenarios with crossing survival curves). Meth-
ods to adjust RMST estimation for covariate-dependent censoring have been studied
in Rong et al. [15]. In our numerical studies, we observed that the conditional random
forest (correcting for a possible selection bias towards covariates with many possible
splits) showed a better performance in terms of RMSE than the traditional CART
random forest approach. This finding was particularly evident in the estimation of
treatment contrasts, where conditional random forests outperformed CART in all
scenarios. We therefore recommend to prefer conditional random forests over CART
random forests when the aim is to estimate treatment effects from data with het-
erogeneous covariate types. Apart from the estimation of treatment contrasts, the
PVRF method can also be used for the prediction of individual survival times from
patient characteristics. In this context, individual RMST differences (keeping all
patient characteristics except the treatment variable fixed) can be interpreted as the
predicted additional lifetime gained through a specific treatment. Due to the complex
structure of random forest predictions (being mainly responsible for the aforemen-
tioned flexibility of PVRF), it is usually difficult to quantify the exact strengths and
shapes of the covariate effects on the prediction. However, recent advances in in-
terpretable machine learning allow for addressing this issue, as demonstrated by the
use of local Shapley values in our application (Section 5). An important topic for
future research is the development of hypothesis tests and confidence intervals for
PVRF-based RMST differences. Previous research in this field [1, 13, 14] has mainly
focused on hypothesis tests for RMST differences derived by group-wise integration
of Kaplan-Meier curves (not incorporating additional covariates). Similarly, Tian et
al. [13] compared RMST-based tests to HR-based tests in the context of randomized
clinical trials, demonstrating that RMST-based tests outperformed their HR-based
counterparts in scenarios where the PH assumption is violated. It would be interest-
ing to conduct analogous studies for pseudo-value-based tests of RMST differences,
which, to the best of our knowledge, have not yet been explored thus far. Confidence
intervals for treatment contrasts could, e.g., be constructed using bootstrap methods,
along the lines of Hern´an & Robins [47], Chapter 13.
A general issue in the estimation of RMST values is the choice of a suitable time
horizon τ. While choosing a small value of τ may discard a large proportion of the
data and will therefore result in a potential loss of information, estimation of the
RMST may no longer be possible if τ becomes too large [48]. General recommenda-
tions on the choice of τ, have, for instance, been made by Tian et al. [48]: Before
25
data collection (for instance, in the course of planning a clinical trial), it is advisable
to pre-select τ based on clinical and feasibility considerations. If pre-selection of τ
is not possible (e.g. when the analysis is conceived after data collection), Tian et
al. suggest to explore a data-dependent time window for τ and to select the time
horizon based on the empirical behavior of the observed times in this window (e.g.
by computing quantiles of ˜T, as done in our simulations). Alternatively, the RMST
could be modeled as a function of τ, as suggested by Zhong & Schaubel [49]. We
finally note that pseudo-value-based RMST modeling is not restricted to the use
of random forest regression. In this work, we focused on random forests because
this method is considered to be “among the best ‘off-the-shelf’ supervised learning
methods that are available” [50]. In particular, random forests are known to perform
well on medium-sized data (as often encountered in medical applications), with sev-
eral efficient software implementations being available [33]. However, it is of course
possible to extend our approach to other statistical modeling or machine learning
techniques, e.g. to gradient boosting [27] or deep neural networks [34, 51].
Acknowledgments
We thank Dr. Lothar H¨aberle (Department of Gynecology, Obstetrics and Mammol-
ogy, University Hospital Erlangen, Germany) for supporting us with the analysis of
the SUCCESS-A study data.
References
[1] P. Royston and M. K. B. Parmar. Restricted mean survival time: An alternative
to the hazard ratio for the design and analysis of randomized trials with a time-
to-event outcome. BMC Medical Research Methodology, 13:152, 2013.
[2] F. Ambrogi, S. Iacobelli, and P. K. Andersen. Analyzing differences between re-
stricted mean survival time curves using pseudo-values. BMC Medical Research
Methodology, 22:71, 2022.
[3] Z. R. McCaw, A. R. Orkaby, L.-J. Wei, D. H. Kim, and M. W. Rich. Applying
evidence-based medicine to shared decision making: Value of restricted mean
survival time. The American Journal of Medicine, 132:13–15, 2019.
[4] P. Royston and M. K. B. Parmar. The use of restricted mean survival time to
estimate the treatment effect in randomized clinical trials when the proportional
hazards assumption is in doubt. Statistics in Medicine, 30:2409–2421, 2011.
26
[5] A. Ni, Z. Lin, and B. Lu. Stratified restricted mean survival time model for
marginal causal effect in observational survival data. Annals of Epidemiology,
64:149–154, 2021.
[6] H. Uno, B. Claggett, L. Tian, E. Inoue, P. Gallo, T. Miyata, D. Schrag,
M. Takeuchi, Y. Uyama, L. Zhao, H. Skali, S. Scott, S. Jacobus, M. Hughes,
M. Packer, and L.-J. Wei. Moving beyond the hazard ratio in quantifying the
between-group difference in survival analysis. Journal of Clinical Oncology, 32:
2380–2385, 2014.
[7] H.-M. Dehbi, P. Royston, and A. Hackshaw. Life expectancy difference and life
expectancy ratio: Two measures of treatment effects in randomised trials with
non-proportional hazards. British Medical Journal, 357:2250, 2017.
[8] M. J. Stensrud and M. A. Hern´an. Why test for proportional hazards? Journal
of the American Medical Association, 323:1401–1402, 2020.
[9] P. Andersen, M. Hansen, and J. Klein. Regression analysis of restricted mean
survival time based on pseudo-observations. Lifetime Data Analysis, 10:335–50,
2005.
[10] L. Breiman. Random forests. Machine Learning, 45:5–32, 2001.
[11] U. B. Mogensen and T. A. Gerds. A random forest approach for competing risks
based on pseudo-values. Statistics in Medicine, 32:3102–3114, 2013.
[12] S. E. Leurgans.
Linear models, random censoring and synthetic data.
Biometrika, 74:301–309, 1987.
[13] L. Tian, H. Fu, S. J. Ruberg, H. Uno, and L.-J. Wei. Efficiency of two sample
tests via the restricted mean survival time for analyzing event time observations.
Biometrics, 74:694–702, 2018.
[14] B. Huang and P.-F. Kuan. Comparison of the restricted mean survival time
with the hazard ratio in superiority trials with a time-to-event end point. Phar-
maceutical Statistics, 17:202–213, 2018.
[15] R. Rong, J. Ning, and H. Zhu. Regression modeling of restricted mean survival
time for left-truncated right-censored data. Statistics in Medicine, 41:3003–3021,
2022.
[16] L. Tian, L. Zhao, and L. J. Wei. Predicting the restricted mean event time with
the subject’s baseline covariates in survival analysis. Biostatistics, 15:222–233,
2014.
27
[17] X. Wang and D. Schaubel. Modeling restricted mean survival time under general
censoring mechanisms. Lifetime Data Analysis, 24:176–199, 2018.
[18] T. Hasegawa, S. Misawa, S. Nakagawa, S. Tanaka, T. Tanase, H. Ugai,
A. Wakana, Y. Yodo, S. Tsuchiya, H. Suganami, and for the JPMA Task
Force Members. Restricted mean survival time as a summary measure of time-
to-event outcome. Pharmaceutical Statistics, 19:436–453, 2020.
[19] D. H. Kim, H. Uno, and L.-J. Wei. Restricted mean survival time as a measure
to interpret clinical trial results. JAMA Cardiology, 2:1179–1180, 2017.
[20] P. K. Andersen and M. Pohar Perme. Pseudo-observations in survival analysis.
Statistical Methods in Medical Research, 19:71–99, 2010.
[21] F. Graw, T. A. Gerds, and M. Schumacher. On pseudo-values for regression
analysis in competing risks models. Lifetime Data Analysis, 15:241–255, 2009.
[22] M. Overgaard, E. Thorlund Parner, and J. Pedersen. Asymptotic theory of
generalized estimating equations based on jack-knife pseudo-observations. The
Annals of Statistics, 45:1988–2015, 2017.
[23] J. Robins.
A new approach to causal inference in mortality studies with a
sustained exposure period - application to control of the healthy worker survivor
effect. Mathematical Modelling, 7:1393–1512, 1986.
[24] J. M. Snowden, S. Rose, and K. M. Mortimer. Implementation of g-computation
on a simulated data set: Demonstration of a causal inference technique. Amer-
ican Journal of Epidemiology, 173:731–738, 2011.
[25] C. Molnar. Interpretable Machine Learning - A Guide for Making Black Box
Models Explainable. Independently published, 2 edition, 2022.
[26] A. de Gregorio, L. H¨aberle, P. A. Fasching, V. M¨uller, I. Schrader, R. Lorenz,
H. Forstbauer, T. W. P. Friedl, E. Bauer, N. de Gregorio, M. Deniz, V. Fink,
I. Bekes, U. Andergassen, A. Schneeweiss, H. Tesch, S. Mahner, S. Y. Brucker,
J. U. Blohmer, T. N. Fehm, G. Heinrich, K. Lato, M. W. Beckmann, B. Rack,
and W. Janni. Gemcitabine as adjuvant chemotherapy in patients with high-risk
early breast cancer – results from the randomized phase III SUCCESS-A trial.
Breast Cancer Research, 22:111, 2020.
[27] A. Schenk, M. Berger, and M. Schmid. Pseudo-value regression trees. Lifetime
Data Analysis, 30:439–471, 2024.
28
[28] J. P. Klein and P. K. Andersen. Regression modeling of competing risks data
based on pseudovalues of the cumulative incidence function. Biometrics, 61:
223–229, 2005.
[29] L. Breiman, J. Friedman, C. J. Stone, and R. A. Olshen. Classification and
Regression Trees. Taylor & Francis, New York, 1984.
[30] T. Hothorn, K. Hornik, and A. Zeileis. Unbiased recursive partitioning: A condi-
tional inference framework. Journal of Computational and Graphical Statistics,
15:651–674, 2006.
[31] B. M. Greenwell. Tree-based Methods for Statistical Learning in R. Chapman
& Hall/CRC, Boca Raton, 2022.
[32] R. de Bin, S. Janitza, W. Sauerbrei, and A.-L. Boulesteix. Subsampling versus
bootstrapping in resampling-based model selection for multivariable regression.
Biometrics, 72:272–280, 2016.
[33] M. N. Wright and A. Ziegler. ranger: A fast implementation of random forests
for high dimensional data in C++ and R. Journal of Statistical Software, 77:
1–17, 2017.
[34] L. Hu, J. Ji, and F. Li. Estimating heterogeneous survival treatment effect in
observational data using machine learning. Statistics in Medicine, 40:4691–4713,
2021.
[35] R Core Team. R: A language and environment for statistical computing. R
Foundation for Statistical Computing, Vienna, Austria, 2021.
URL https:
//www.R-project.org/. version 4.1.2.
[36] T. M. Therneau and P. M. Grambsch. Modeling Survival Data: Extending the
Cox Model. Springer, New York, 2000.
[37] C. A. Hudis, W. E. Barlow, J. P. Costantino, R. J. Gray, K. I. Pritchard, J.-
A. W. Chapman, J. A. Sparano, S. Hunsberger, R. A. Enos, R. D. Gelber, and
J. A. Zujewski. Proposal for standardized definitions for efficacy end points in
adjuvant breast cancer trials: The STEEP system. Journal of Clinical Oncology,
25:2127–2132, 2007.
[38] A. Cwiling, V. Perduca, and O. Bouaziz. A comprehensive framework for evalu-
ating time to event predictions using the restricted mean survival time. Technical
report, arXiv Technical Report 2306.16075 [math.ST], 2023.
29
[39] A. S. Coates, E. P. Winer, A. Goldhirsch, R. D. Gelber, M. Gnant, M. J.
Piccart-Gebhart, B. Th¨urlimann, and H. Senn. Tailoring therapies – improving
the management of early breast cancer: St.Gallen international expert consensus
on the primary therapy of early breast cancer 2015. Annals of Oncology, 26:
1533–1546, 2015.
[40] E. Senkus, S. Kyriakides, S. Ohno, F. Penault-Llorca, P. Poortmans, E. Rutgers,
S. Zackrisson, F. Cardoso, and ESMO Guidelines Committee. Primary breast
cancer: ESMO clinical practice guidelines for diagnosis, treatment and follow-
up. Annals of Oncology, 26:Suppl. 5, v8–v30, 2015.
[41] C. M. Perou, T. Sørlie, M. B. Eisen, M. van de Rijn, S. S. Jeffrey, C. A. Rees,
J. R. Pollack, D. T. Ross, H. Johnsen, L. A. Akslen, O. Fluge, A. Pergamen-
schikov, C. Williams, S. X. Zhu, P. E. Lønning, A. L. Børresen-Dale, P. O.
Brown, and D. Botstein. Molecular portraits of human breast tumours. Nature,
406:747–752, 2000.
[42] G. von Minckwitz, M. Untch, J.-U. Blohmer, S. D. Costa, H. Eidtmann, P. A.
Fasching, B. Gerber, W. Eiermann, J. Hilfrich, J. Huober, C. Jackisch, M. Kauf-
mann, G. E. Konecny, C. Denkert, V. Nekljudova, K. Mehta, and S. Loibl. Def-
inition and impact of pathologic complete response on prognosis after neoad-
juvant chemotherapy in various intrinsic breast cancer subtypes.
Journal of
Clinical Oncology, 30:1796–1804, 2012.
[43] A. Goldhirsch, W. C. Wood, R. D. Gelber, A. S. Coates, B. Th¨urlimann, and
H.-J. Senn.
Meeting highlights: Updated international expert consensus on
the primary therapy of early breast cancer. Journal of Clinical Oncology, 21:
3357–3365, 2003.
[44] M. A. Hern´an. The hazards of hazard ratios. Epidemiology, 21:13–5, 2010.
[45] V. Didelez and M. J. Stensrud. On the logic of collapsibility for causal effect
measures. Biometrical Journal, 64:235–242, 2022.
[46] P.-Y. Chen and A. A. Tsiatis. Causal inference on the difference of the restricted
mean lifetime between two groups. Biometrics, 57:1030–1038, 2001.
[47] M. A. Hern´an and J. M. Robins. Causal Inference: What if. CRC Press, Boca
Raton, 2024.
[48] L. Tian, H. Jin, H. Uno, Y. Lu, B. Huang, K. M. Anderson, and L.J. Wei.
On the empirical choice of the time window for restricted mean survival time.
Biometrics, 76:1157–1166, 2020.
30
[49] Y. Zhong and D. E. Schaubel. Restricted mean survival time as a function of
restriction time. Biometrics, 78:192–201, 2022.
[50] T. Coleman, L. Mentch, F. A. La Sorte D. Fink, D. W. Winkler, G. Hooker,
and W. M. Hochachka. Statistical inference on tree swallow migrations with
random forests. Journal of the Royal Statistical Society, Series C, 69:973–989,
2020.
[51] L. Zhao. Deep neural networks for predicting restricted mean survival times.
Bioinformatics, 36:5672–5677, 2021.
[52] K. Goldfeld and J. Wujciak-Jens.
simstudy: Illuminating research methods
through data generation, 2020. URL https://doi.org/10.21105/joss.02763.
R package version 0.7.1, 2023.
[53] M. Pohar Perme and M. Gerster. pseudo: Computes pseudo-observations for
modeling, 2017. URL https://cran.r-project.org/web/packages/pseudo.
R package version 1.4.3.
[54] T. Hothorn, H. Seibold, and A. Zeileis. partykit: A toolkit for recursive party-
tioning, 2023. URL https://cran.r-project.org/web/packages/partykit.
R package version 1.2.20.
[55] T. M. Therneau. survival: A package for survival analysis in R, 2023. URL
https://CRAN.R-project.org/package=survival. R package version 3.5.7.
[56] S. Højsgaard, U. Halekoh, and J. Yan. The R package geepack for generalized
estimating equations. Journal of Statistical Software, 15:1–11, 2006.
[57] C. Molnar, B. Bischl, and G. Casalicchio. iml: An R package for interpretable
machine learning. Journal of Open Source Software, 3:786, 2018.
31
Appendix
A
Simulation Study
A.1
Covariance matrix of the continuous covariates
X(1)
X(2)
X(3)
X(4)
X(5)
X(1)
1.00
-0.08
-0.47
0.73
-0.44
X(2)
-0.08
1.00
0.85
-0.05
-0.31
X(3)
-0.47
0.85
1.00
-0.38
-0.33
X(4)
0.73
-0.05
-0.38
1.00
-0.37
X(5)
-0.44
-0.31
-0.33
-0.37
1.00
Table A1: Covariance matrix of the continuous covariates X(j), j = 1, . . . , 5.
32
A.2
Values of the time horizon τ
Scenario Censoring
q50%
q60%
q70%
q80%
q90%
proportion
1
25%
1.72
2.81
4.64
8.08
16.95
50%
1.09
1.56
2.23
3.28
5.24
75%
0.40
0.55
0.74
1.02
1.52
2
25%
1.37
2.38
4.26
8.19
19.64
50%
0.78
1.15
1.68
2.51
4.07
75%
0.23
0.32
0.44
0.62
0.92
3
25%
1.41
1.83
2.05
2.23
2.74
50%
0.64
0.88
1.07
1.22
1.65
75%
0.31
0.42
0.55
0.64
0.86
4
25%
1.22
1.67
2.03
2.19
2.77
50%
0.52
0.74
1.01
1.14
1.57
75%
0.20
0.27
0.36
0.43
0.60
Table A2: Time horizons τ used in the simulation study. Note that q70% is approxi-
mately equal to the transition time t0 in Scenarios 3 and 4.
33
B
Specification and implementation of the
methods
The simulation study and the application were carried out in R, version 4.1.2 [35].
Data for the simulation study were generated using the R package simstudy, ver-
sion 0.7.1 [52]. Pseudo values for the RMST, as defined in Equation (2), were calcu-
lated using the pseudomean function of the R package pseudo, version 1.4.3 [53].
The CART random forest was implemented using the R package ranger,
version 0.15.1 [33].
The number of trees was set to 500.
Data for tree building
was sampled without replacement from the complete data using a sampling fraction
of 0.632. The number of candidate split variables in each node (“mtry”) was tuned
using five-fold cross validation. In each tree, the minimum number of observations
required to perform an additional split was set to 5. There were no restrictions on
the tree depth and the minimum number of observations in the leaf nodes.
The conditional random forest was implemented using cforest function of the R
package partykit, version 1.2.20 [54]. The number of trees was set to 500. By
default, cforest implements sampling without replacement from the complete data,
using a sampling fraction of 0.632. The number of candidate split variables in each
node was tuned using five-fold cross validation.
In each tree, a minimum of 20
observations was required to perform a split, and each leaf node was required to
contain a minimum of 7 observations. There was no restriction on the depth of the
trees.
The Lognormal, Cox, and Reference methods were implemented using the R package
survival, version 3.5.7 [55]. GEE and GEE (log) were implemented using the R
package geepack, version 1.3.9 [56].
Permutation feature importance values were calculated as
PFIk
j = WRSSj∗
k
WRSSK
,
(20)
where WRSSk denotes the WRSS calculated from the unpermuted data in the k-th
test fold (k = 1, . . . , 5) and WRSSj∗
k denotes the respective WRSS calculated from
data with randomly permuted values of the j-th covariate. Local Shapley values
were calculated using the R package iml, version 0.11.2 [57].
The R-code for the simulation study is available at
https://www.imbie.uni-bonn.de/cloud/index.php/s/6gmJQmayFAMJZHk.
34
C
Simulation results for censoring proportions
25% and 75%
Figure C1: Results of the simulation study (25% censoring).
The upper panels
present the average RMSE (14), as obtained from the RMST estimates at different
values of τ. The lower panels present the average RMSE for the treatment effect (16).
The green colored dots refer to the PVRF method (CART random forest and con-
ditional random forest). The dashed black lines refer to the correctly specified Cox
proportional hazards model (Reference).
35
Figure C2: Results of the simulation study (75% censoring).
The upper panels
present the average RMSE (14), as obtained from the RMST estimates at different
values of τ. The lower panels present the average RMSE for the treatment effect (16).
The green colored dots refer to the PVRF method (CART random forest and con-
ditional random forest). The dashed black lines refer to the correctly specified Cox
proportional hazards model (Reference).
36
D
Application
D.1
Patient characteristics of the SUCCESS-A study data
Characteristic
Patients (N = 3,754)
age (years)
Mean (SD)
53.5 (10.5)
Median [Min, Max]
53.0 [21.0, 86.0]
BMI (kg/m2)
Mean (SD)
26.3 (5.03)
Median [Min, Max]
25.4 [15.4, 53.4]
tumor stage
pT1
1552 (41.3%)
pT2
1929 (51.4%)
pT3
198 (5.3%)
pT4
52 (1.4%)
Missing
23 (0.6%)
tumor grade
G1
176 (4.7%)
G2
1783 (47.5%)
G3
1773 (47.2%)
Missing
22 (0.6%)
lymph node status
pN+
2452 (65.3%)
pN0
1273 (33.9%)
Missing
29 (0.8%)
tumor type
ductal
3060 (81.5%)
lobular
419 (11.2%)
other
253 (6.7%)
Missing
22 (0.6%)
estrogen receptor status
ER-
1252 (33.4%)
ER+
2481 (66.1%)
Missing
21 (0.6%)
progesterone receptor status
PR-
1525 (40.6%)
PR+
2205 (58.7%)
Missing
24 (0.6%)
HER2
HER2-
2787 (74.2%)
HER2+
883 (23.5%)
Missing
84 (2.2%)
menopausal status
pre
1565 (41.7%)
post
2189 (58.3%)
treatment group
control
1898 (50.6%)
interventional
1856 (49.4%)
Table D1: Descriptive summary of the variables in the SUCCESS-A study data.
37
D.2
Definition of molecular tumor subtypes
Subgroup
HER2
ER/PR
grade
HER2 positive
HER2+
any
any
luminal A-like
HER2−
ER+ and/or PR+
G1 or G2
luminal B-like
HER2−
ER+ and/or PR+
G3
triple-negative
HER2−
ER−and PR−
any
Table D2: Definition of molecular tumor subtypes.
38
D.3
Supplementary results
Figure D1: Analysis of DFS in the SUCCESS-A study. Panel (A) shows the es-
timated RMST values in patient groups defined by molecular tumor subtypes, as
obtained from the CART random forest (see Table D2).
Panel (B) presents lo-
cal Shapley values for each covariate, as obtained by evaluating the CART random
forest estimates in 1000 randomly selected patients. Each dot corresponds to one
patient. The color codings used in Panel (B) are presented in the bottom row of the
figure.
39
