Population dynamics of multiple ecDNA types
Elisa Scanu2, Benjamin Werner3, Weini Huang1,2,∗
1 Group of Theoretical Biology, School of Life Science, Sun Yat-sen University,
Guangzhou, China
2 School of Mathematical Sciences, Queen Mary University of London,
United Kingdom
3 Centre for Cancer Genomics and Computational Biology, Barts Cancer Centre,
Queen Mary University of London, United Kingdom
∗Corresponding author: weini.huang@qmul.ac.uk
October 2024
Abstract
Extrachromosomal DNA (ecDNA) can drive oncogene amplification, gene
expression and intratumor heterogeneity, representing a major force in cancer
initiation and progression. The phenomenon becomes even more intricate as
distinct types of ecDNA present within a single cancer cell. While exciting as
a new and significant observation across various cancer types, there is a lack of
a general framework capturing the dynamics of multiple ecDNA types theoret-
ically. Here, we present novel mathematical models investigating the prolifera-
tion and expansion of multiple ecDNA types in a growing cell population. By
switching on and off a single parameter, we model different scenarios including
ecDNA species with different oncogenes, genotypes with same oncogenes but
different point mutations and phenotypes with identical genetic compositions
but different functions. We analyse the fraction of ecDNA-positive and free
cells as well as how the mean and variance of the copy number of cells carrying
one or more ecDNA types change over time. Our results showed that switch-
ing does not play a role in the fraction and copy number distribution of total
ecDNA-positive cells, if selection is identical among different ecDNA types. In
addition, while cells with multiple ecDNA cannot be maintained in the scenario
of ecDNA species without extra fitness advantages, they can persist and even
dominate the ecDNA-positive population if switching is possible.
Introduction
Cancer is the uncontrolled growth of abnormal cells, and it develops from a single
cell to bigger masses which take control of portions of healthy tissues [26, 31]. Fol-
lowing the Darwinian evolution theory, in order to successfully invade, tumour cells
1
arXiv:2411.14588v1  [q-bio.PE]  21 Nov 2024
obtaining simple or complex variations can survive and escape the normal control
mechanism of tissues [2,3,25]. One efficient way is through copy number alteration,
including amplification of functional genomics sequences such as oncogenes [4, 31].
The amplification of specific oncogenes can happen through extra chromosomal DNA
(ecDNA) and homogeneously staining regions (HSRs), which are thought to be the
cytogenetic hallmarks of gene amplification in cancers [16]. There is much research
related to HSRs [1,16], but the role of ecDNA in driving tumor expansion and treat-
ment resistance has been largely underestimated for many years. Recently, many
studies suggested that patients with tumours containing ecDNA have worse clinical
outcomes [11,14]. "Hiding" oncogenes within ecDNA fragments is a strategic mech-
anism for the evolution of cancer cells, as this relocation effectively liberates these
elements from the normal chromosomal constraints like centromeres, consequently
giving tumors the ability to undergo accelerated evolution compared to chromosomal
genomes.
The observed ecDNAs are relatively large (1.3 Mb on average) and highly ampli-
fied circular structures containing genes and regulatory regions [31], and they make
unique contributions to oncogenic transcription and tumour progression through
their promotion of oncogene amplification and treatment resistance [6, 11, 20, 24,
27,30]. The origin of ecDNA has been long studied, and several possible mechanisms
have been proposed, including the breakage-fusion-bridge (BFB) cycle, translocation-
deletion-amplification model, “episome” model and chromothripsis [28,32]. The seg-
regation patterns of ecDNA elements in cell divisions have been investigated through-
fully, with the common conclusion that unlike DNA, ecDNA copies are randomly
partitioned to the daughter cells from the mother [10, 11, 15, 23], and this fuels a
fast accumulation of intercellular copy number heterogeneity. A basic mathematical
model of tumour dynamics with a single ecDNA type has already been developed
[15], where the random segregation and driver role of ecDNA elements in tumour
expansion has been validated through an integration of theory and experimental and
clinical data [15]. Here, we move beyond the single ecDNA type hypothesis and
investigate the population dynamics of multiple ecDNA types.
There are multiple reasons and evidence why we need a general mathematical
framework to model multiple ecDNA types, which can refer to ecDNA species car-
rying distinct oncogenes, genotypes with the same oncogenes but different point
mutations, and phenotypes with identical genetic compositions but different func-
tions generated by phenotypical switching. First, multiple ecDNAs species originally
derived from different chromosomal loci have been observed in the same cancer cell
[17, 21]. These ecDNAs can congregate in micron-sized hubs in the nucleus [20, 22]
and enable intermolecular gene activation, where enhancer elements on one ecDNA
molecule can activate coding sequences on another ecDNA [21]. Second, ecDNAs
own clustered somatic mutations [5, 12] which change the genotype of ecDNA and
may alter the function of ecDNA sequences with potential phenotypic evolution like
2
in resistance. Third, ecDNA is particularly sensitive to different epigenetic states,
which have been associated with responses to site of growth [13,18] and to stress, in-
cluding hypoxia and high acidity encountered in tumour microenvironments [15,17],
and activation or deactivation of different oncogenes. This means even without any
genetic alternations, ecDNA might switch between different phenotypical states in-
trinsically.
Considering that experimental evidence shows the most prevalent presence of two
ecDNA species in human cancer cells [21], we focus on our analysis of an evolutionary
process with two ecDNA types. However, we can extend our general framework to
model any number of ecDNA types. Specifically, we model the segregation, possible
switching and selection of two ecDNA types in a growing population. Our investiga-
tion demonstrates that the stochastic segregation of extrachromosomal DNA yields
diverse outcomes under selection and different switching scenarios. While selection
significantly impacts the population composition of ecDNA-positive and ecDNA-free
cells, as well as the mean, variance, and distribution of ecDNA copy numbers in the
total population, switching only plays a role in these quantities when selection differs
between the cells carrying different ecDNA types. However, if we classify the cell
population into different subgroups based on composition of ecDNA types within
a cell, we observe distinct dynamics of cells carrying different types of ecDNA by
varying switching strengths. This holds even when selection is identical for different
ecDNA types. More specifically, we examined genotypes with extremely low switch-
ing rates or phenotypes with relatively higher switching rates, the mean copy number
and proportion of cells in subgroups are significantly influenced by the switching rate.
Methods
A general framework of two ecDNA types
We consider two types of ecDNA, denoted as yellow and red respectively in Figure
1. The reproduction rates (fitness in our model) of the two ecDNA types are sy and
sr, which are equal to 1 if the selection between ecDNA-positive or ecDNA-free
cells is neutral. This means that cells carrying ecDNA have the same fitness as cells
without ecDNA under neutral selection, which is normalised to 1. Alternatively, cells
carrying ecDNA types can have fitness advantages compared to ecDNA-free cells,
including two scenarios depending on whether the reproduction rates of carrying
different ecDNA types equal (sy = sr > 1) or not (sy ̸= sr > 1). For the sake of
simplicity, we assume a cell carrying a mix of yellow and red ecDNA elements has a
reproduction rate as the maximum value between sy and sr (Figure 1d). This refers
to an assumption that having both ecDNA types does not lead to an extra fitness
advantage, which does not change our general framework and equations and can be
easily released for an extension of analysis [21].
During each cell division, the ecDNA copies are duplicated similar to the chro-
3
mosomal genetic materials, but due to lack of centromeres the two types of ecDNA
copies are randomly partitioned into the two daughter cells independently following
a separate binomial distribution with the probability of a single copy segregated to
any daughter cell as 1/2. Note we can also release the assumption of the independent
segregation between the two ecDNA species with evidence-based motivations [21].
For our general framework, we focus on the analysis with independent segregation.
We introduce two probabilities py and pr in the range [0, 1], representing switching
between ecDNA types coupled with cell divisions. If py = pr = 0, switching is off
and the two ecDNA types refer to different ecDNA species (Figure 1b), where e.g.
distinct oncogenes or enhancers are carried in the ecDNA elements and thus there
is no one-step transition between the two ecDNA types. If at least one of py and
pr is greater than 0, then we consider the propagation of two ecDNA genotypes or
phenotypes (Figure 1a). Small values of py and pr can refer to a genotypic change
through e.g. point genetic mutations. With an ecDNA sequence size of 1 Mb and a
mutation rate of 10−9 to 10−8 per base pair, py or pr could be in the order of 10−3
to 10−2. Larger values of py and pr (but still far less than 1) can be interpreted
as intrinsic phenotype switching, where epigenetic changes such as through DNA
methylation [11,19] or other molecular events alter the ecDNA phenotypes.
In a growing population, the random segregation and/or possible switching be-
tween the two ecDNA types promote a high heterogeneity among cells, which can
be classified into four different subpopulations, i.e. pure yellow, pure red, mix and
ecDNA-free cells (Figure 1c&d). We are interested in how the interplay between all
evolutionary parameters py, pr, sy, sr will impact the dynamics of different subpopu-
lations.
4
a
b
d
c
Switching from red to yellow
Switching from yellow to red
Figure 1: A general framework for modeling two ecDNA types. a. Two
ecDNA genotypes or phenotypes through genetic mutations (small py, pr) or
phenotypical switching (large py, pr). At each cell division, each type evolves under-
going independent binomial segregation and it can switch between the two ecDNA
types with probabilities py and pr. b. Two ecDNA species without switching
(py = pr = 0). When the p switching rates are zero, we just consider a random
segregation of yellow and red ecDNA species in the daughter cells following two in-
dependent binomial distributions.
c.
Cells subpopulations. With or without
switching, we can classify four subpopulations based on ecDNA types carried by
cells, i.e. cells without ecDNA (ecDNA-free), cells with only one type of ecDNA
(pure yellow and pure red) and cells carrying both ecDNA types (mix). d Selection
strengths.
We summarise the selection coefficients for different subpopulations.
For the sake of simplification, we assume the mix cells have the same fitness as the
maximum values of fitness of the pure yellow and pure red cells, which can be easily
relaxed for an extension.
5
py
probability of switching from yellow to red ecDNA
pr
probability of switching from red to yellow ecDNA
sy
reproduction rate for cells carrying only yellow ecDNA
sr
reproduction rate for cells carrying only red ecDNA
n+(t)
proportion of cells carrying at least one ecDNA copy
n−(t)
proportion of cells carrying no ecDNA copies
γ(t)
loss rate of ecDNA due to a completely asymmetric segregation
Ci,k(t)
number of cells carrying i yellow and k red ecDNA copies at time t
ρi,k(t)
frequency of cells carrying i yellow and k red ecDNA copies at time t
g1,2(t), h1,2(t), k1,2(t)
loss/gaining rates for ecDNA evolutionary process
M(t)
population growth factor at time t
Nk(t)
number of cells carrying k ecDNA copies at time t
δ(s)
zeroing function for ecDNA-free cells trend
∆(s)
normalising function for ecDNA-free cells trend
M(l)(t)
l-order moment for the whole population at time t
M(l)
y (t)
l-order moment for pure yellow ecDNA cells at time t
M(l)
r (t)
l-order moment for pure red ecDNA cells at time t
M(l)
m (t)
l-order moment for mix ecDNA cells at time t
Table 1: Notations for the mathematical description of multiple ecDNA types
Deterministic dynamics
These interactions can be expressed by two different mathematical approaches,
which are a deterministic one comprising a system of ordinary differential equations
(ODEs) and a demographic one comprising a system of stochastic equations. Starting
from the system of ODEs, we analyse the densities of cells with and without ecDNA
copies denoted by n+(t) and n−(t) respectively with,



d n+(t)
dt
= n+(t) −γ(t)n+(t)
d n−(t)
dt
= n−(t) + γ(t)n+(t).
(1)
The above system is justified by observing that cells carrying ecDNA can lose all
ecDNA copies, but the reverse is not possible.
Because the origin of ecDNA is
often considered a random event due to genomics instability, and generally a specific
ecDNA can not be gained back once lost in a population. Moreover, the function γ(t)
corresponds to the at the moment undetermined loss rate of ecDNA due to complete
asymmetric segregation, i.e. a daughter cell inherited all copies and the other one
none by chance. In the case of two ecDNA types, we can split the density function
n+(t) into the sum of three subfunctions: ρi,0

i>0(t), ρ0,k

k>0(t) and ρi,k

i,k>0(t),
6
respectively for pure yellow, pure red and mix cells:















d ρi,0(t)
dt
= ρi,0(t) −γ(t)ρi,0(t) + g1(t)prρi,k

i,k>0(t) + k1(t)prρ0,k(t) −h2(t)pyρi,0(t)
d ρ0,k(t)
dt
= ρ0,k(t) −γ(t)ρ0,k(t) + g2(t)pyρi,k

i,k>0(t) + h1(t)pyρi,0(t) −k2(t)pyρ0,k(t)
d ρi,k(t)
dt

i,k>0 = ρi,k

i,k>0(t) −γ(t)ρi,k

i,k>0(t) −(g1(t)pr + g2(t)py)ρi,k

i,k>0(t)
+(h2(t) −h1(t))pyρi,0(t) + (k2(t) −k1(t))prρ0,k(t)
(2)
We can recover Eqs. (1) by summing the three equations in Eqs. (2) and generalise
Eqs. (2) to positive selection cases by multiplying each subpopulation by its own
selection coefficient, sy, sr or max(sy, sr).
Master equation
The ecDNA content of daughter cells at each division depends on the outcome of
the random segregation and the switching probability. We can write the probability
for a daughter to carry n yellow ecDNA copies, given a mother with k yellow copies
and h red copies as
P(daughter = n yellow copies) = (1 −py)
2k
n
1
2
2k
+ pr
2h
n
1
2
2h
,
and the one for a daughter to carry n red copies, given the same mother as
P(daughter = n red copies) = py
2k
n
1
2
2k
+ (1 −pr)
2h
n
1
2
2h
.
7
Based on these preliminary observations, we can then write down the demographic
equations as below:
dCk,0(t)
dt

k>0
= −syCk,0 + 2sy
∞
X
j=

k
2
(1 −py)jCj,0
2j
k
 1
22j
+ 2sy
∞
X
j+h=

k
2

j>0
ph
r(1 −py)jCj,h
2(j + h)
k

1
22(j+h) ,
dC0,k(t)
dt

k>0
= −srC0,k + 2sr
∞
X
h=

k
2
(1 −pr)hC0,h
2h
k
 1
22h
+ 2sy
∞
X
j+h=

k
2

j>0
pj
y(1 −pr)hCj,h
2(j + h)
k

1
22(j+h) ,
dCi,k(t)
dt

i,k>0
= −syCi,k(t) + 2sy

∞
X
j=

i
2

, h=

k
2
 Cj,h
2(j + h)
(i + k)

1
22(j+h)
+
∞
X
j=

i
2
 pj
yCj,0
2j
i
 1
22j −
∞
X
j+h=

k
2
(ph
r(1 −py)j + pj
y(1 −pr)h)Cj,h
2(j + h)
k

1
22(j+h)

+ 2sr
∞
X
i=

k
2
 pj
rC0,j
2j
k
 1
22j ,
dC0,0
dt
= −C0,0 + 2C0,0 + 2sy
∞
X
j+h=1
j>0
Cj,h
2(j + h)
0

1
22(j+h) + 2sr
∞
X
h=0
C0,h
2h
0
 1
22h ,
(3)
where Ci,k(t) indicates the number of cells with i yellow and k red copies at time t.
Without loss of generality, we can set sy ≥sr, then the fitness advantage for mix
cells is the maximum between sy and sr, thus sy (Figure 1d).
Results
We are interested in the dynamics of pure, mix and ecDNA-free cells. Thus,
we investigate how selection strength and switching parameters lead to different
patterns.
Again in the results, py = pr = 0 refers to multiple ecDNA species,
otherwise it refers to multiple ecDNA genotypes or phenotypes. sy = sr = 1 indicates
neutral selection, sy = sr > 1 indicates identical positive selection, and sy ̸= sr ≥1
is for non-identical positive selection.
8
Copy number distribution of all ecDNA-positive cells and fraction
of ecDNA-free cells over time
Let us first look at the scenarios where both yellow and red ecDNAs have the
same reproduction rate, i.e.
sy = sr = s, where s ≥1.
From Eqs.
3, setting
sy = sr = s as stated, we can recover the dynamics of the number of cells with k
ecDNA copies at time t, Nk(t) as
dNk(t)
dt
=
d
 Ck,0(t) + C0,k(t) + Ci,k−i

i,k>0(t)

dt
= −sNk(t) + 2s
∞
X
i=

k
2
 Ni(t)
2i
k
 1
22i ,
(4)
and we can write
dNk(t)
dt

k>0
= s
dNk(t)
dt

s=1

,
dN0(t)
dt
= s
dN0(t)
dt

s=1

−(s −1)N0.
(5)
Using the definition of cell frequency (see Table 1):
ρi,k(t) = Ci,k(t)
M(t)
(6)
together with Eqs. (4) and (5), we can find that the total population size, M(t)
under different selection scenarios as
M(t) = et,
for s = 1,
M(t) = est−(s−1)
R t
0 ρ0(τ) dτ,
for s > 1.
(7)
Eqs. (5) and (7) show that, when the selection strength is identical for cells carrying
any of the two ecDNA types, the distribution of total ecDNA copies remains to be
independent of the switching rates over time (Figure 2c).
This independence from switching probabilities holds for the fraction of ecDNA-
free cells over time as well (Figure 2a). Indeed, using Eqs. (1) based on our methods
of modeling single ecDNA types in [15], we can obtain solutions for n−(t) and get
the frequency of ecDNA-free cells as
ρ0,0(t) =
t
2 + t,
if sy = sr = 1,
and
ρ0,0(t) =
t
2 + teδ(s)t ,
if sy = sr > 1.
(8)
Whilst the fraction of ecDNA-free cells, ρ0,0, is approaching 1 as t →∞for neutral
selection (sy = sr = 1), we expect the progressive decrease of the fraction of cells
carrying ecDNA. On the contrary, ρ0,0 shrinks to zero under identical positive se-
lection (sy = sr > 1). We can measure how fast this trend is approaching ρ0,0 = 0
9
by approximating the function δ(s) at the denominator of the second equation in
Eqs. (8), which is modulated by s. Using Monte Carlo simulations and studying the
shape of the fitting curve, we approximate
δ(s) ≃1
4 ·
c −ce−4(s−1)
1 + c + e−4(s−2) ,
where
c ≃5.23 .
(9)
As δ(s) is almost stable for s > 4, solution in (9) suggests the existence of a fitness
threshold, after which the zeroing of ρ0,0(t) is not affected by further increasing s
(Figure S1).
Now we look at the scenario where fitness for cells carrying different ecDNAs is
not identical (sy ̸= sr). The copy number distribution of total ecDNA-positive cells
and the fraction of ecDNA-free cells are highly sensitive to selection coefficients (
Figure 2b&d). The independence of those quantities on the switching rates, py and
pr , is lost.
10
100
101
102
103
104
Number of cells
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Fraction ecDNA-free cells
100
101
102
103
104
Number of cells
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Fraction ecDNA-free cells
data1
data2
data3
data4
! = #
! = $
!! = $. &, !" = # 
a
) = 0 
 ) = 0.2 
) = 0.5 
) = 0.7 
100
101
102
103
104
Number of cells
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Fraction ecDNA-free cells
data1
data2
data3
) = 0 
) = 0.2 
) = 0.5 
100
101
102
103
104
Number of cells
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
data1
data2
data3
b
Identical selection
Non-identical selection
0
10
20
30
40
Number of copies
0
0.05
0.1
0.15
0.2
0.25
Pdf of copies
) = 0 
) = 0.2
) = 0.5
!! = $. &, !" = # 
! = # 
c
d
) = 0 
) = 0.2
) = 0.5
100
101
102
103
104
Number of cells
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Fraction ecDNA-free cells
data1
data2
data3
100
101
102
103
104
Number of cells
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Fraction ecDNA-free cells
data1
data2
data3
data4
Figure 2: ecDNA copy distribution among either identical or non-identical
selection. Under identical (neural and positive) selection for both ecDNA types
(a), the fraction of ecDNA-free cells over time does not change with switching prob-
abilities. Whilst if non-identical fitness is considered (b), the fraction of ecDNA-free
cells will depend on the probabilites of type switching. Similarly, the copy number
distribution of all cells carrying ecDNA is independent on p when identical fitness
scenario is considered (c), whilst it changes with the rate of type switching if yellow
and red ecDNA carry different reproduction rates (d). For the copy number distri-
butions (c and d), we showed outcomes from two different initial conditions, for the
highest curves we started with a single cell with 1 yellow and 1 red ecDNA copy, and
for the lowest curves we had a starting single cell with 10 yellow and 10 red ecDNA
copies (py = pr = p).
To understand the cell dynamics and population composition of different ecDNA
types, we look at subgroups of ecDNA-positive cells instead of the total number,
and separate our moment analysis when type switching is off (ecDNA species) or on
(ecDNA genotypes or phenotypes).
11
Moment analysis for multiple ecDNA species when switching is off
We can study the dynamics of two ecDNA species by plugging py = pr = 0 in
Eqs. (3), obtaining the following demographic system as
dCk,0(t)
dt

k>0
= −syCk,0 + 2sy
∞
X
i=

k
2
 Ci,0
2i
k
 1
22i + sy
∞
X
j=[ k
2 ],h=1
Cj,h
2(j + h)
k

1
22(j+h) ,
dC0,k(t)
dt

k>0
= −srC0,k + 2sr
∞
X
i=

k
2
 C0,i
2i
k
 1
22i + sy
∞
X
j=1,h=[ k
2 ]
Cj,h
2(j + h)
k

1
22(j+h) ,
dCi,k(t)
dt

i,k>0
= −syCi,k(t) + 2sy
∞
X
j=

i
2

, h=

k
2
 Ci,h
2(j + h)
(i + k)

1
22(j+h)
−sy
∞
X
j=[ k
2 ],h=1
Cj,h
2(j + h)
k

1
22(j+h) −sy
∞
X
j=1,h=[ k
2 ]
Cj,h
2(j + h)
k

1
22(j+h) ,
dC0,0
dt
= −C0,0 + 2C0,0 + 2sy
∞
X
i+k=1
i>0
Ci,k
2(i + k)
0

1
22(i+k) + 2sr
∞
X
k=0
C0,k
2k
0
 1
22k .
(10)
Using Eqs. (7) and (3), we calculate the l-order moment for each subpopulation by
the formula
M(l)
j (t) =
X
i,k
(i + k)lρi,k,
(11)
where j = y, r, m is respectively for pure yellow, pure red and mix subpopulations.
We focus on the case of identical fitness, i.e. sy = sr = s including scenarios under
neutral selection s = 1 and positive selection s > 1. Starting with s = 1, we write
exact equations for probability densities of pure and mix cells over time using Eqs.
(6). For example, for pure yellow cells, we have
dρi,0(t)
dt
= −2ρi,0(t)+2
∞
X
j=1
ρj,0(t)
2j
i
 1
22j +
∞
X
j=[ k
2 ],h=1
ρj,h(t)
2(j + h)
k

1
22(j+h) (12)
Then, Eq. (12) can be substituted in Eq. (11) to get every l-order moment. The first
moment dynamic, which describes the average copy number of pure cells carrying
12
only yellow ecDNA copies, is given by
dMy(1)(t)
dt
=
∞
X
i=0
i dρi,0(t)
= −2My(1)(t) + 2
∞
X
i=0
∞
X
j=

i
2
 i(1 −p)jρj,0(t)
2j
i
 1
22j
+
∞
X
i=0
∞
X
j=

i
2

,h=1
iρj,h(t)
2(j + h)
i

1
22(j+h)
= −2My(1)(t) + 2
∞
X
j=0
ρj,0(t) 1
22j
2j
X
i=0
i
2j
i

+ 1
2
∞
X
j,h=0
ρj,h(t)
1
22(j+h)
2(j+h)
X
i=0
i
2(j + h)
i

= −2My(1)(t) + 2
∞
X
j,h=0
ρj,0(t) 1
22j 22jj + 1
2
∞
X
j=0
ρj,h(t)
1
22(j+h) 22(j+h)(j + h)
≈−2My(1)(t) + 2My(1)(t) + Mm(1)(t) = Mm(1)(t).
(13)
Similarly. we can obtain the first moment dynamics for pure red and mix subpopu-
lations (see Table 2).
Now we move to the scenario of identical positive fitness, i.e sy = sr = s > 1,
combining Eqs. (5) and (7), we obtain the frequencies of pure yellow ecDNA cells as
dρi,0(t)
dt
= s
dρi,0(t)
dt

s=1

−(s −1)ρ0,0ρi,0.
(14)
Using the moment calculation formula in (11) we get
dMy(1)(t)
dt
= s
2Mm(1)(t) + (s −1)ρ0,0My(1)(t).
(15)
The same steps in (12) and (15), together with standard solution techniques for
ODEs, are used for filling Table 2. The total moment M(1) has been already given
[15]:
M(1)(t) = 1,
if s = 1,
and
M(1)(t) = e(s−1)
R t
0 ρ0,0(τ) dτ,
if s > 1.
(16)
13
Weighted first moment dynamics equations for ecDNA species
Neutral case sy = sr = s = 1
Subpopulation
Equation
Solution
Total
dM(1)(t)
dt
=
0
M(1)(0)
Pure yellow
dMy(1)(t)
dt
=
1
2Mm(1)(t)
−Mm(1)(0)
2
e−t + 2My(1)(0)+Mm(1)(0)
2
Pure red
dMr(1)(t)
dt
=
1
2Mm(1)(t)
−Mm(1)(0)
2
e−t + 2Mr(1)(0)+Mm(1)(0)
2
Mix
dMm(1)(t)
dt
=
−Mm(1)(t)
Mm(1)(0)e−t
Identical positive selection case sy = sr = s > 1
Subpopulation
Equation
Solution
Total
dM(1)(t)
dt
=
(s −1)ρ0,0M(1)(t)
M(1)(0)e(s−1)
R t
0 ρ0,0(τ) dτ
Pure yellow
dMy(1)(t)
dt
=
s
2Mm(1)(t)
 My(1)(0)+Mr(1)(0)

e(s−1)
R t
0 ρ0,0(τ) dτ
2
+(s −1)ρ0,0My(1)(t)
+
Mm(1)(0)e(s−1)
R t
0 ρ0,0(τ) dτ 1−e−st
2
Pure red
dMr(1)(t)
dt
=
s
2Mm(1)(t))
 My(1)(0)+Mr(1)(0)

e(s−1)
R t
0 ρ0,0(τ) dτ
2
+(s −1)ρ0,0Mr(1)(t
+
Mm(1)(0)e(s−1)
R t
0 ρ0,0(τ) dτ 1−e−st
2
Mix
dMm(1)(t)
dt
=
−sMm(1)(t)
Mm(1)(0)e−st+(s−1)
R t
0 ρ0,0(τ) dτ
+(s −1)ρ0,0Mm(1)(t)
Table 2: Summary of equations for weighted first moment dynamics for ecDNA
species in the identical fitness coefficients cases.
Our analytical results, where the integral on the ecDNA-free cells density has
been calculated numerically and the constant of integration has been inferred by
using Monte Carlo methods, match well with stochastic simulations implemented by
Gillespie Algorithm [7–9,29] (Figure 3).
Our moment analysis of each sub-populations refers to weighted moments, which
consider the variability in copy numbers across different subpopulations together
with their respective fractions relative to the total population size. Specifically, the
weighted mean copy number shown are normalised based on the mean copy number
for the total population. For example, the mean copy number for the total population
used for the normalisation is constant under neutral selection, which is 2 as the copy
number of the initial cell in Figure 3a. Under identical positive selection, it is 2t in
Figure 3b.
The dynamics of weighted moments align with the trends observed in the un-
weighted mean copy number dynamics of each subpopulation, as illustrated in Fig-
ure S3. In the Supplementary section, we examine every sub-populations separately
and track their absolute mean copy numbers over time. As expected, the absolute
average copy numbers increase over time for ecDNA-positive cells no matter whether
they are pure or mix cells. However, the changes in curve slopes portrayed by the
weighted moments in Figure 3 suggest that, despite the steady increase in the ab-
solute number of ecDNA copies in both pure and mix cells, the proportion of pure
cells contributes more substantially than mix ones to the mean copy number of the
14
total population if selection is identical (neutral and positive).
0
2
4
6
8
10
12
Time in generations
0
0.5
1
1.5
2
2.5
3
First moment
0
2
4
6
8
10
12
Time in generations
0
0.5
1
1.5
2
2.5
3
First moment
+" = +# = &
+" = +# = )
a
b
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
First moment
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
First moment (weighted)
Figure 3: Weighted first moment dynamics for ecDNA species (py = pr =
p = 0). This refers to the contribution of pure and mix cells to the mean copy number
of the total population. We compare simulation data with analytical solutions for
first moment dynamics of ecDNA species.
a shows the neutral selection case,
whilst b refers to identical positive selection. Solid lines represent analytical
solutions, whilst scatter dots refer to simulations. Time is expressed in generations,
i.e. each index represents a population size of 2time in generations. The initial condition
is a single cell with 1 yellow and 1 red ecDNA copy, and this is why the trends for
first pure yellow and pure red ecDNA moments are coinciding.
While it is difficult to obtain analytical solutions for the non-identical selection
case, we simulate the weighted first moment (Figure S6a) and absolute mean copy
number (Figure S6b) for the case of two ecDNA species, where the cells carrying
yellow ecDNA are assumed to proliferate faster than the cells carrying red ecDNA.
Conversely to the dynamics under identical positive selection (Figure 3b and Figure
S3b&d), pure yellow ecDNA cells dominate the populations over time as expected
(Figure S6a). However, since we assume that mix cells have the same fitness as the
fitter pure cells, the contribution of mix cells to the whole population is much less
than the one of pure cells, no matter if under identical positive selection or non-
identical selection. In the infinite time limit, the mix cells cannot be maintained.
Moment analysis of multiple ecDNA genotypes or phenotypes when
switching is on
Under identical fitness and one-way switching
Now we analyse the dynamics of two ecDNA genotypes or phenotypes, where
different types of ecDNA elements can switch to each other.
We first look at a
simpler case of one-way switching. Without the loss of generality, we can set pr = 0
15
and py = p.
We consider values for which p ≪1, whose are more biologically
relevant. Using the Taylor approximation, we can write
1 −ip < (1 −p)i < 1 −p,
0 < pi < p,
p ≃0.
(17)
We use the notation L-B and U-B to indicate the lower-bound and upper-bound
approximations in (17).
In the simplest case of neutral selection, i.e. sy = sr = s = 1, we write exact
equations for frequencies of pure, mix and ecDNA-free cells over time using Eqs. (6).
For the pure yellow subpopulation, we have
dρi,0(t)
dt
= −2ρi,0(t) + 2
∞
X
j=1
(1 −p)jρj,0(t)
2j
i
 1
22j .
(18)
Then, we can substitute Eq. (18) in (11) to get every l-order moment. The first
moment dynamics, i.e. the average copy number of cells carrying only yellow ecDNA
elements, using the L-B approximation, i.e. (1 −p)i ≈(1 −ip), pi ≈0, is
dMy(1)(t)
dt
=
∞
X
i=0
i dρi,0(t)
= −2My(1)(t) + 2
∞
X
i=0
∞
X
j=

i
2
 i(1 −p)jρj,0(t)
2j
i
 1
22j
= −2My(1)(t) + 2
∞
X
j=0
(1 −p)jρj,0(t) 1
22j
2j
X
i=0
i
2j
i

= −2My(1)(t) + 2
∞
X
j=0
(1 −p)jρj,0(t) 1
22j 22jj
≈−2My(1)(t) + 2My(1)(t) + 2pMy(2)(t) = −2pMy(2).
(19)
Instead, using the U-B approximation, i.e. (1 −p)i ≈(1 −p), pi ≈p, we have
dMy(1)(t)
dt
≈−2pMy(1)(t).
(20)
The second moment dynamics measures the variance in copy number, which is ob-
tained under the L-B approximation as
dMy(2)
dt
=
∞
X
i=0
i2 dρi,0(t)
= −2My(2)(t) + 2
∞
X
i=0
∞
X
j=

i
2
 i2(1 −p)jρj,0(t)
2j
i
 1
22j
= −2My(2)(t) + 2
∞
X
j=0
(1 −p)jρj,0(t) 1
22j
2j
X
i=1
i2
2j
i

= −2My(2)(t) + 2
∞
X
j=0
(1 −p)jρj,0(t) 1
22j (2j + (2j)2)22j−2
≈My(1)(t) −pMy(2)(t) −2pMy(3)(t),
16
and under the U-B approximation as
dMy(2)(t)
dt
≈−2pMy(2)(t) + My(1)(t)(1 −p).
The same steps are used for filling Table 3, together with the results for the total
moments in Eqs. (16).
Weighted moment dynamics equations for sy = sr = s = 1 and py = p > 0, pr = 0
First moment dynamics
Subpopulation
Equation L-B
Equation U-B
Total
dM(1)(t)
dt
=
0
0
Pure yellow
dMy(1)(t)
dt
=
−2pMy(2)(t)
−2pMy(1)(t)
Pure red
dMr(1)(t)
dt
=
0
2pMm(1)(t)
Mix
dMm(1)(t)
dt
=
2pMy(2)(t)
−2pMm(1)(t) + 2pMy(1)(t))
Second moment dynamics
Subpopulation
Equation L-B
Equation U-B
Total
dM(2)(t)
dt
=
1
1
Pure yellow
dMy(2)(t)
dt
=
My(1)(t) −pMy(2)(t)
−2pMy(2)(t) + My(1)(t)(1 −p)
−2pMy(3)(t)
Pure red
dMr(2)(t)
dt
=
t
Mr(1)(t) + p(1 + 2t)
Table 3: Summary of equations for weighted first and second moment dynamics in
the neutral case for py = p, pr = 0. L-B means lower bound approximation, whilst
U-B means upper bound ones, referring to (17). Second moment dynamics for mix
cells can be calculated by subtraction.
However, the lower-bound equations in Table 3 for neutral selection (and also
the ones in Supplementary Table S1 for identical positive selection) do not account
for the contribution of pure red cells in the first moment dynamics.
When pi is
approximated by zero for small p values, it effectively nullifies the contribution of
the pure red ecDNA subpopulation in the system, resulting in dMr(1)(t)
dt
= 0 in this
case. This limitation is not present in the upper-bound approximation, where pi
approximates p when p is sufficiently small, ensuring that the velocity function in the
ordinary differential equation for Mr(1)(t) remains positive. Consequently, we focus
our analysis on the upper-bound approximation throughout the following sections.
Our analytical approximations match well with stochastic simulations (Figure 4 and
Figure S2), where it is further noticeable how the upper-bound approximation fits
better the stochastic simulations.
Starting from a single cell with one yellow ecDNA copy and one-way switching
from yellow to red (py), we examine the impact of switching on the weighted mean
and variance of the copy number. When the switching rate increases, we observe a
decrease of the contribution of pure yellow cells and an increase of the contribution of
pure red cells to the ecDNA-positive population, no matter if under neutral selection
17
(Figure 4a-c) or identical positive selection (Figure S2a-c). With increasing switch-
ing rates, mix cells can be maintained in the population even without fitness ad-
vantages compared to pure cells. However, under neutral selection, ecDNA-positive
cells will slowly decrease over time due to random segregation and the accumulation
of ecDNA-free cells, thus the impact of switching is stronger in this case compared
to the identical positive selection scenario. When analysing small switching rates,
we can appreciate indeed a difference between the two selection scenarios. Under
neutral selection, the contribution of pure yellow cells decreases over time for small
switching values (Figure 4a&b). On the contrary, under positive and identical se-
lection, the ecDNA-positive cells will expand, thus, starting from a pure yellow cell,
the contribution of the pure yellow subpopulation still dominates and increases when
small p values are considered (Figure S2a&b).
The mean copy number aligns well with the weighted first moment dynamics.
When selection is neutral, the absolute mean copy number sharply increases for
mix cells (Figure S4), and we also observe a rising trend for this subpopulation
in the weighted first moment (Figure 4 a-c), measuring the contribution of each
subpopulation to the absolute mean copy number of the population. This indicates
an increase in the number of mix cells over time among the total population. On the
contrary, while pure yellow ecDNA cells exhibit a constant increase in their absolute
mean copy number, their decreasing trend in the weighted first moment, inversely
proportional to p values, suggests a decline in the number of individuals in this
subpopulation over time, attributable to the one-way switching discussed above.
Examining the variance (Figure 4 d-f and Figure S2 d-f), we observe similar
dynamics to those seen in the first moment, indicating that the weighted variance
in mean copy number is higher when the subpopulation is larger. This might be
explained by the broad range of copy number configurations expected in a large
population due to the nature of cell division.
18
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
First moment
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
First moment
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
First moment
, = &*$%
, = &*$&
, = &*$'
0
2
4
6
8
10
12
Time in generations
0
2
4
6
8
10
Second moment
0
2
4
6
8
10
12
Time in generations
0
2
4
6
8
10
Second moment
0
2
4
6
8
10
12
Time in generations
0
2
4
6
8
10
Second moment
, = &*$%
, = &*$&
, = &*$'
d
e
f
a
b
c
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
First moment
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
First moment (weighted)
Second moment (weighted)
Figure 4: Weighted moment dynamics in the neutral case for one-way
switching (py = p, pr = 0, sy = sr = s = 1). simulation data in comparison with
upper-bound analytical approximations for weighted first moment dynamics (a-
c), referring to the contribution of pure and mix cells to the mean copy number of
the total population, and weighted second moment dynamics (d-f), referring
to the contribution to the total variance for sy = sr = s = 1 and pr = 0. Three
different values for py = p are considered; plain lines represent analytical upper-
bound approximations, whilst scatter plots are data from simulations. The initial
condition is a single cell with 1 yellow ecDNA copy.
While obtaining solutions for non-identical selection is difficult, we examine the
moment dynamics for this case through stochastic simulations. Again, pure yellow
cells are assumed to be fitter than the pure red cells and the switching is one-
way, from yellow to red (py). Starting from a single pure yellow cell, the dynamics
under small switching rates (Figure S7a&b) are very similar to those under identical
positive selection (Figure S2a&b), where the contribution of pure yellow cells to
the ecDNA-positive population dominates and increases over long time. However,
the contribution of the pure red cells remains trivial under non-identical selection
scenario (Figure S7b), as they reproduce slower than pure yellow and mix cells. This
differs from the identical positive selection case (Figure S2 b). When the switching
rate increases, the contribution of the pure yellow cells again decreases (Figure S7c),
which holds for all selection scenarios including neutral, identical positive and non-
identical selection. However, under higher switching rates, not only the mix cells can
be maintained but also dominate the ecDNA-positive population. This phenomenon
has been observed only under non-identical selection.
19
Under identical fitness and two-way switching
Now we investigate the case when both ecDNA types can switch into each other,
i.e. py, pr ̸= 0. Considering the approximations in (17) and the method in (13), we
fill the Table 4.
Weighted first moment dynamics equations for sy = sr = s = 1 and py ̸= pr
First moment dynamics
Subpopulation
Equation U-B
Total
dM(1)(t)
dt
=
0
Pure yellow
dMy(1)(t)
dt
=
−2pyMy(1)(t) + 2pr(1 −py)Mm(1)(t)
Pure red
dMr(1)(t)
dt
=
−2prMr(1)(t) + 2py(1 −pr)Mm(1)(t)
Mix
dMm(1)(t)
dt
=
−4Mm(1)(t) + 2pyMy(1)(t) + 2prMr(1)(t)
Table 4: Summary of equations for weighted first moment dynamics in the neutral
case for py ̸= pr. U-B means upper bound approximations, referring to (17).
We observe an inner symmetry in the equations in Table (4) in terms of the
parameters py and pr. This, we consider an identical switching probabilities scenario
for the ecDNA types, i.e. py = pr = p > 0. Focusing on U-B approximation results
from Table 4, we aim to solve the following system in matrix form:
X′ = AX,
A =



−2p
0
2p −2p2
0
−2p
2p −2p2
2p
2p
−4p2 −4p



(21)
The eigenvalues of A are λ1 = 0, λ2 = −2p and λ3 = 4p2 −6p, with eigenvectors
v1 = (1 −p, 1 −p, 1), v2 = (1, −1, 0) and v3 = (−1, −1, 2). The solutions of (21) are
given by
M = PeBtP −1C
where B is the diagonal similar matrix to A, P is given by A = PBP −1 and C is
the vector of initial values C = (My(1)(0), Mr(1)(0), Mm(1)(0)), hence:
P =



1 −p
1
−1
1 −p
−1
−1
1
0
2


,
eBt =



1
0
0
0
e−2pt
0
0
0
e4p2t−6pt


,
P −1 =



−1
2p−3
−1
2p−3
−1
2p−3
1
2
−1
2
−1
1
4p−6
1
4p−6
p−1
2p−3



and by matrix multiplication we get the solutions in Table 5 in case of neutral
selection for the whole population.
20
Wighted first moment dynamics’ U-B approximation for s = sy = sr = 1 and p = py = pr
Subpopulation
First moment
Total
M(1)(0)
Pure yellow
−(2(p−1)Mm(1)(0)+My(1)(0)+Mr(1)(0))e4p2t−6pt
4p−6
−Mr(1)(0)−My(1)(0)
2
e−2pt + M(1)(0) p−1
2p−3
Pure red
−(2(p−1)Mm(1)(0)+My(1)(0)+Mr(1)(0))e4p2t−6pt
4p−6
+ Mr(1)(0)−My(1)(0)
2
e−2pt + M(1)(0) p−1
2p−3
Mix
by subtraction
Table 5: Summary of weighted first and second moment dynamics for s = sr = sy ≥1
and p = py = pr, using the U-B approximation.
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
First Moment
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
First Moment
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
First Moment
, = &*$%
, = &*$&
, = &*$'
a
b
c
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
First moment (weighted)
Figure 5: Weighted first moment dynamics in the neutral selection case
for two-way switching (py = pr = p, sy = sr = s = 1).
This refers to the
contribution of pure and mix cells to the mean copy number of the total population.
simulation data in comparison with upper-bound analytical approximations of first
moment dynamics of ecDNA types. Three different values for p are considered; plain
lines represent analytical upper-bound approximations, whilst scatter plots are data
from simulations. The initial condition is a single cell with 1 yellow ecDNA copy.
In Figure 5, starting from a single cell with one yellow ecDNA copy and a two-
way switching from yellow to red copies and back, we observe a consistent alignment
between our analytical approximations and stochastic simulations under neutral se-
lection. Comparing the weighted first moment dynamics with the mean copy number
in Figure S4, we observe a more pronounced increase in mix cell trends for both ab-
solute and relative counts when p is relatively higher. Conversely, the absolute mean
copy number appears to reach a sort of steady state after several generations for pure
subpopulations, suggesting that mix cells rapidly become the ones with the highest
number of copies in the two-way switching scenario.
Furthermore, by examining the weighted mean copy number in Figure 5, we can
draw additional conclusions about the proportion of subpopulations over time. Pure
yellow cells decrease in number over time, while mix cells significantly increase. Sum-
marising the results from both absolute and weighted first moments, it appears that
mix cells are increasingly dominating the ecDNA-positive cells, carrying also the
21
configurations with the highest copy numbers.
Comparing these observations with the ones under one-way switching, it seems that
two-way switching leads to a sharper increase in weighted mean copy number of
mix. This suggests the two-way switching promotes the expansion and mantenance
of multiple ecDNA types presenting in the same cells.
Discussion
We present a framework to model two ecDNA types, which can be adapted to ei-
ther species, genotypes or phenotypes, by easily changing the switching probabilities
between the two types. If the type switching probability is set to zero for both yellow
and red ecDNA, we consider two distinct species; conversely, two genotypes distinct
by point mutations with relatively low switching probabilities or phenotypes by phe-
notypical switching. Similar to previous models on a single ecDNA type [15,21], our
investigation demonstrates that random segregation of ecDNA in cell divisions, sig-
nificantly impacts the system’s heterogeneity, discernible through the identification
of multiple subpopulations of cells carrying or lacking specific ecDNA types. Two
evolutionary parameters, namely the fitness coefficient and type switching probabil-
ity, are central to our analytical exploration.
The distribution of ecDNA copies within the population and the densities of
subpopulations over time are influenced by those parameters. While the mean copy
of the population will increase with more cell divisions if fitness is positive, it takes
some time for the ecDNA to spread in a growing population. Thus, in simulations
the initial configuration of cells also largely determines the copy number distribution
in observation. A lower initial ecDNA copy number results in a distribution with a
sharper peak and a lower mean copy number across the population (Figure 2c&d,
curve representing 1 yellow and 1 red ecDNA copies as the initial configuration).
A higher initial copy number yields a distribution with a more bell-shaped curve,
indicative of an overall higher mean copy number (Figure 2c&d, curve representing
10 yellow and 10 red ecDNA copies as the initial configuration). In reality, while
ecDNA is most likely to arise with a single copy, the expansion of ecDNA-positive
cells might only start with a cell carrying multiple copies. These initial copies can
vary due to different oncogenes present in the ecDNA elements. In addition, given
sufficient long enough time, the ecDNA copy number distributions will evolve to a
more bell-shaped curve as observed more often in cell lines.
As expected when both yellow and red ecDNA have identical fitness either neu-
tral or positive, the whole population has the same behaviour as it has a single type
of ecDNA [21]. Variations in type switching probability (p) do not impact the distri-
bution of copies in ecDNA-positive cells or the density of ecDNA-free cells over time.
However, once one of the ecDNA types carries a different reproduction rate, the
22
independence of these quantities from the type switching probability disappeared.
Moreover, if the switching is identical and two-way, intermediate values of p lead to
higher mean copy numbers and a greater proportion of cells carrying ecDNA (Figure
2b&d). Notably, the distribution in Figure 2d exhibits increased width, while the
fraction of ecDNA-free cells in Figure 2b diminishes for values of p approaching 0.5.
Overall, this observation suggests a potential advantage in maintaining co-occurrence
over time, facilitated by intermediate values of p. The presence of type switching
enables pure mother cells to produce mix daughters, and the efficacy of this process
seems most pronounced when p assumes intermediate values. This hypothesis looks
intriguing and promising for validation in future investigations.
We analysed the mean and variance of distinct subpopulations through the first
and second moment dynamics for both ecDNA species and geno-/pheno-types. In
the context of ecDNA species, selection affects the mean ecDNA copy number for
cells carrying either just yellow or just red copies, resulting in a substantial increase
over time. Considering then ecDNA geno-/pheno-types, we categorised our analysis
on various parameter choices using Taylor approximation for small values of type
switching probability. The solutions to the moment dynamics provided align well
with simulations for small probability values but may exhibit significant discrep-
ancies for larger values. Nevertheless, small switching probabilities are biologically
more relevant to our model. If type changes are between different ecDNA genotypes
through point mutations, the switching probabilities per ecDNA copy per division
will be very small in the order of 10−2 depending on the size of the ecDNA element.
Alternatively, it can be small but comparably larger for phenotype switching between
different ecDNA phenotypes with the same genetic components.
If identical fitness and one-way switching e.g. from yellow to red is considered,
the mean and variation for the pure yellow population exhibit a progressive decrease
with an increase in the switching probability.
Conversely, the opposite trend is
observed for the pure red population. This is observable in different ways. First by
looking at the analytical approximations in Table S1, the normalised average copy
number for pure red cells, i.e. their first moment, is of order ≈−te−t, compared
to ones for pure yellow, that decreases proportionally to ≈e−t, and mix cells; the
variance is accordingly monotonically increasing for pure red. Secondly, we present
how first and second moments changes over time in simulations in Figure 4, which
agrees to our analytical results above. These observations suggest that in the case
of one-way switching (e.g. towards red ecDNA type), under conditions of identical
positive fitness for cells carrying ecDNA, pure red cells are going to be the majority
on the long run.
However, if the switching is two-way between the two ecDNA types, the mix pop-
ulation shows an increase in the average copy number proportionate to the switching
probability. This suggests that intermediate levels of switching may create advanta-
geous conditions for the proliferation of mix cells, paving the way for further inves-
23
tigations into the optimal switching dynamics.
In summary, we constructed a general theoretical model of multiple ecDNA types,
which match the recent experimental and clinical observations and provide a general
framework to investigate the complex dynamics of extra-chromosomal DNA interac-
tions in cancers.
Acknowledgements
E.S. is supported by the Engineering and Physical Sciences Research Council
(EPSRC) PhD fellowship that is part of the United Kingdom Research and Innova-
tion association (UKRI). B.W. is supported by a Barts Charity Lectureship (grant
no. MGU045) and a UKRI Future Leaders Fellowship (grant no. MR/V02342X/1).
W.H. is funded by NNSF General Program (grant no. 3217024). E.S. and W.H.
are funded by Cancer Grand Challenges CGCSDF-2021\100007 with support from
Cancer Research UK and the National Cancer Institute.
References
[1] L’Abbate A, Macchia G, D’Addabbo P, Lonoce A, Tolomeo D, et al.
Ge-
nomic organization and evolution of double minutes/homogeneously staining
regions with MYC amplification in human cancer.
Nucleic Acids Research,
42:9131–9145, 2014.
[2] Bailey C, Shoura MJ, Mischel PS, and Swanton C. Extrachromosomal DNA-
relieving heredity constraints, accelerating tumour evolution. Annals of Oncol-
ogy, 31:884–893, 2020.
[3] Bailey C, Shoura MJ, Mischel PS, and Swanton C.
Extrachromosomal
DNA—relieving heredity constraints, accelerating tumour evolution.
Annals
of Oncology, 31(7):884–893, 2020.
[4] Aktipis CA, Boddy AM, Gatenby RA, Brown JS, and Maley CC. Life history
trade-offs in cancer evolution. Nature Reviews Cancer, 13:883–892, 2013.
[5] Mas-Ponte D and Supek F.
DNA mismatch repair promotes APOBEC3-
mediated diffuse hypermutation in human cancers. Nature Genetics, 52:958–968,
2020.
[6] Nathanson DA et al. Targeted therapy resistance mediated by dynamic regula-
tion of extrachromosomal mutant EGFR DNA. Science, 343:72–76, 2014.
[7] Gillespie DT. A general method for numerically simulating the stochastic time
evolution of coupled chemical reactions.
Journal of Computational Physics,
22(4):403–434, 1976.
24
[8] Gillespie DT. Exact stochastic simulation of coupled chemical reactions. The
Journal of Physical Chemistry, 81(25):2340–2361, 1977.
[9] Gillespie DT.
Stochastic simulation of chemical kinetics.
Annual Review of
Physical Chemistry, 58:35–55, 2007.
[10] Yi E et al. Live-cell imaging shows uneven segregation of extrachromosomal
DNA elements and transcriptionally active extrachromosomal DNA hubs in can-
cer. Cancer Discovery, 12:468–483, 2022.
[11] Yi E, Chamorro González R, Henssen AG, et al. Extrachromosomal DNA am-
plifications in cancer. Nature Reviews Genetics, 23:760–771, 2022.
[12] Bergstrom EN et al. Mapping clustered mutations in cancer reveals APOBEC3
mutagenesis of ecDNA. Nature, 602:510–517, 2022.
[13] Stark GR, Debatisse M, Giulotto E, and Wahl GM. Recent progress in un-
derstanding mechanisms of mammalian DNA amplification. Cell, 57:901–908,
1989.
[14] Kim H et al. Extrachromosomal DNA is associated with oncogene amplification
and poor outcome across multiple cancers. Nature Genetics, 52:891–897, 2020.
[15] Lange JT, Rose JC, Chen CY, et al. The evolutionary dynamics of extrachro-
mosomal DNA in human cancers. Nature Genetics, 54:1527–1533, 2022.
[16] Sanborn JZ, Salama SR, Grifford M, Brennan CW, Mikkelsen T, et al. Double
minute chromosomes in glioblastoma multiforme are revealed by precise recon-
struction of oncogenic amplicons. Cancer Research, 73:6036–6045, 2013.
[17] Song K et al. Plasticity of extrachromosomal and intrachromosomal BRAF am-
plifications in overcoming targeted therapy dosage challenges. Cancer Discovery,
12:1046–1069, 2022.
[18] Johnson KC et al. Single-cell multimodal glioma analyses identify epigenetic
regulators of cellular plasticity and environmental stress response. Nature Ge-
netics, 53:1456–1468, 2021.
[19] Hung KL, Luebeck J, Dehkordi SR, et al. Targeted profiling of human extra-
chromosomal DNA by CRISPR-CATCH. Nature Genetics, 54:1746–1754, 2022.
[20] Hung KL, Yost KE, Xie L, et al. ecDNA hubs drive cooperative intermolecular
oncogene expression. Nature, 600:731–736, 2021.
[21] Hung KL, Jones MG, Wong IT, et al. Coordinated inheritance of extrachromo-
somal DNA species in human cancer cells. Nature, 635:201–209, 2024.
25
[22] Hung KL, Mischel PS, and Chang HY. Gene regulation on extrachromosomal
DNA. Nature Structural and Molecular Biology, 29:736–744, 2022.
[23] Turner KM et al.
Extrachromosomal oncogene amplification drives tumour
evolution and genetic heterogeneity. Nature, 543:122–125, 2017.
[24] Turner KM, Deshpande V, Beyter D, Koga T, Rusert J, Lee C, Li B, Arden K,
Ren B, Nathanson DA, et al. Extrachromosomal oncogene amplification drives
tumour evolution and genetic heterogeneity. Nature, 543:122–125, 2017.
[25] Pecorino LT, Verhaak RGW, Henssen A, and Mischel PS. Extrachromosomal
DNA (ecDNA): an origin of tumor heterogeneity, genomic remodeling, and drug
resistance. Biochemical Society Transactions, 50(6):1911–1920, 2022.
[26] McGranahan N and Swanton C.
Clonal heterogeneity and tumor evolution:
Past, present, and the future. Cell, 168(4):613–628, 2017.
[27] Verhaak RG, Bafna V, and Mischel PS. Extrachromosomal oncogene amplifica-
tion in tumour pathogenesis and evolution. Nature Reviews Cancer, 19:283–288,
2019.
[28] John C. Rose, Ivy Tsz-Lo Wong, Bence Daniel, Matthew G. Jones, Kathryn E.
Yost, King L. Hung, Ellis J. Curtis, Paul S. Mischel, and Howard Y. Chang.
Disparate pathways for extrachromosomal DNA biogenesis and genomic DNA
repair. bioRxiv, 2023.
[29] Nakaoka S and Aihara K. Stochastic simulation of structured skin cell popula-
tion dynamics. Journal of Mathematical Biology, 66:807–835, 2013.
[30] Wu S et al. Circular ecDNA promotes accessible chromatin and high oncogene
expression. Nature, 575:699–703, 2019.
[31] Wu S, Bafna V, and Mischel PS. Extrachromosomal DNA (ecDNA) in cancer
pathogenesis. Current Opinion in Genetics and Development, 66:78–82, 2021.
[32] Liao Z, Jiang W, Ye L, Li T, Yu X, and Liu L. Classification of extrachromosomal
circular DNA with a focus on the role of extrachromosomal DNA (ecDNA) in
tumor heterogeneity and progression. Biochimica et Biophysica Acta Reviews
on Cancer, 1874(1), 2020.
26
Supplementary
Moment analysis of multiple ecDNA geno-/pheno-types under positive
identical fitness and one-way switching
Weighted moment dynamics’ U-B approximation for sy = sr = s and py = p > 0, pr = 0
Subpopulation
First moment
Second moment
Total
M(1)(t)
tM(1)(t)
Pure yellow
 M(1)
y (1)e−2spt
M(1)(t)
 M(2)
y (1) + s((1 −p)t

e−2sptM(1)(t)
Pure red
  −2sptM(1)
y (1) −M(1)
y (1) −M(1)
m (1)

e−2spt
 M(2)
r (1) + 2spt2 + spt

M(1)(t)
+M(1)
y (1) + M(1)
m (1) + M(1)
r (1)

M(1)(t)
Mix
by subtraction
by subtraction
Table S1: Summary of weighted first and second moment dynamics for sr = sy =
s ≥1 and pr = 0, py = p, using the U-B approximation.
Moment analysis of multiple ecDNA geno-/pheno-types under non-identical
fitness and one-way switching
In this section, we aim to provide a more general investigation of our model by
considering a non-identical fitness scenario for the two ecDNA types, specifically
where yellow ecDNA carries positive fitness, i.e. sy > 1, whilst red does not, i.e.
sr = 1. Using the same methods as for the case sy = sr = s, we first get for the
population growth factor:
dM(t)
dt
= M
 s −(s −1)(ρ0,0 + ρ0,k)

(S1)
where ρ0,0(t) + ρ0,k(t) is the fraction of cells carrying neutral fitness at time t. The
solution for Eq. (S1) is:
M(t) = est−(s−1)
R τ
0 (ρ0,0(τ)+ρ0,k(τ)) dτ
(S2)
It can be seen from Eq. (S2) that the growth is taking advantage from positive
selection (the exponential increasing is faster than in the neutral case), and the
above expression is in line with results for s = 1 already obtained in Eqs. (7).
Analysing the simplified one-way switching case pr = 0, py = p > 0. we write for
the U-B approximation of M(1)
y (t) in case of U-B approximation the following:
dρk,0
dt
= −sρk,0 + 2s
∞
X
i=

k
2
(1 −p)iρi,0
2i
k
 1
22i −ρk,0(s −(s −1)(ρ0,0 + ρ0,k))
= s
dρk,0
dt

s=1

+ ρk,0(s −1)(ρ0,0 + ρ0,k)
(S3)
where ρk,0dt

s=1
is the corresponding density in case of neutral selection, and by
substituting Eq. (S3) into (11), we get:
dMy(1)(t)
dt
= s
dMy(1)
dt

s=1

+ My(1)(s −1)(ρ0,0 + ρ0,k)
(S4)
27
We use Eq. (20) in (S4) to get
dMy(1)(t)
dt
≈My(1)
−2sp + (s −1)(ρ0,0 + ρ0,k)

The same argument is used to fill Table S2.
Weighted first moment dynamics: U-B equations for s = sy > 1, sr = 1 and p = py > 0, pr = 0
Subpopulation
Equation
Total
dM(1)(t)
dt
=
(s −1)
 ρ0,0(t) + ρ0,k(t)

M(1)(t) −M(1)
r (t)

Pure yellow
dMy(1)(t)
dt
=

−2sp + (s −1)
 ρ0,0(t) + ρ0,k(t)

My(1)(t)
Pure red
dMr(1)(t)
dt
=
2spMm(1)(t) −(s −1)
 1 −
 ρ0,0(t) + ρ0,k(t)

Mr(1)(t)
Mix
dMm(1)(t)
dt
=
−2spMm(1)(t) + (s −1)
 ρ0,0(t) + ρ0,k(t)
 M(1)(t) + Mr(1)(t)
−My(1)(t)

+ 2spMy(1)(t)
Table S2: Summary of equations for weighted first moment dynamics for s = sy >
1, sr = 0 and pr = 0, p = py, using the U-B approximation.
Supplementary Figures
1
2
3
4
5
Selection coefficient
0
0.05
0.1
0.15
0.2
0.25
0.3
Delta(s)
Figure S1: Best fitting for the function δ(s) in Eq. 9. Comparison between
simulation results (dots) and approximation of best fit function (dashed line). (py =
pr = p = 0, starting from a single cell with 1 ecDNA copy)
28
0
2
4
6
8
10
12
Time in generations
0
0.5
1
1.5
2
2.5
3
First moment
0
2
4
6
8
10
12
Time in generations
0
0.5
1
1.5
2
2.5
3
First moment
0
2
4
6
8
10
12
Time in generations
0
0.5
1
1.5
2
2.5
3
First moment
, = &*$%
, = &*$&
, = &*$'
a
b
c
0
2
4
6
8
10
12
Time in generations
0
5
10
15
20
25
30
Second moment
0
2
4
6
8
10
12
Time in generations
0
5
10
15
20
25
30
Second moment
0
2
4
6
8
10
12
Time in generations
0
5
10
15
20
25
30
Second moment
, = &*$%
, = &*$&
, = &*$'
d
e
f
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
First moment
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
First moment (weighted)
Second moment (weighted)
Figure S2: Weighted moment dynamics in the positive selection case for
one-way switching (py = p > 0, pr = 0, sy = sr = s = 2. simulation data
in comparison with upper-bound analytical approximations for weighted first mo-
ment dynamics (a-c) and weighted second moment dynamics (d-f) of ecDNA
types. Three different values for py = p are considered; plain lines represent ana-
lytical upper-bound approximations, whilst scatter plots are data from simulations.
The initial condition is a single cell with 1 yellow ecDNA copy. Notice how the sim-
ulations work slightly worse in case of higher value of p, due to the consideration of
approximated analytical solutions.
29
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
9
10
Mean copy number
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
9
10
Mean copy number
%! = %" = "
c
d
%! = %" = #
!! = #, # , %, & , (&, %)
!! = #, # , %, & , (&, %)
Pure yellow 
Pure red 
Mix 
2
4
6
8
10
12
Time in generations
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
9
10
Mean copy number
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
9
10
Mean copy number
%! = %" = "
a
b
%! = %" = #
Pure yellow 
Pure red 
Mix 
2
4
6
8
10
12
Time in generations
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
!! = (#, #)
!! = (#, #)
Figure S3: Mean copy number for ecDNA species (py = pr = p = 0). We show
simulation data for mean copy number for ecDNA species under different selection
scenarios and initial conditions. a-b shows the neutral selection and identical positive
selection case respectively for a population starting with a single mix cell with 1
yellow and 1 red copy.
c-d refers to the neutral selection and identical positive
selection case respectively for a population starting with three cells: a mix cell with
1 yellow and 1 red copy, a pure yellow cell with 2 copies and a pure red cell with 2
copies. Notice that, due to the balanced number of copies among species, the trends
for first pure yellow and pure red ecDNA moments are coinciding.
30
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
Mean copy number
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
Mean copy number
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
Mean copy number
! = #$!"
! = #$!#
a
b
c
! = #$!$
Pure yellow 
Pure red 
Mix 
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
First moment
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
Figure S4: Mean copy number under neutral selection for one-way switch-
ing (py = p, pr = 0, sy = sr = s = 1). We show simulation data for mean copy
number for ecDNA phenotypes under neutral selection and one-way switching from
yellow to red. Three different values for py = p are considered. The initial condition
is a single cell with 1 yellow ecDNA copy.
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
9
Mean copy number
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
9
Mean copy number
0
2
4
6
8
10
12
Time in generations
0
1
2
3
4
5
6
7
8
9
Mean copy number
! = #$!"
! = #$!#
a
b
c
! = #$!$
Pure yellow 
Pure red 
Mix 
0
2
4
6
8
10
12
Time in generations
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
First moment
Pure yellow sim
Pure yellow exp
Pure red sim
Pure red exp
Mix sim
Mix exp
Figure S5: Mean copy number under neutral selection for two-way switch-
ing (py = pr = p, sy = sr = s = 1). We show simulation data for mean copy
number for ecDNA types under neutral selection and identical two-way switching.
Three different values for py = p are considered. The initial condition is a single cell
with 1 yellow ecDNA copy.
31
0
2
4
6
8
10
12
14
Time in generations
0
2
4
6
8
10
Mean copy number
0
2
4
6
8
10
12
Time in generations
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
First moment (weighted)
!. = #. %, !/ = '
!. = #. %, !/ = '
a
b
Figure S6: Dynamics for ecDNA species under non-identical fitness sce-
nario (py = pr = p = 0, sy = 2.5, sr = 1). a. Weighted first moment. This
refers to the contribution of pure and mix cells to the mean copy number of the
total population. b. Mean copy number. This refers to the absolute mean copy
number of the subpopulations. The initial condition is a single cell with 1 yellow and
1 red ecDNA copy.
0
2
4
6
8
10
12
14
Time in generations
0
1
2
3
4
5
6
7
8
9
Mean copy number
0
2
4
6
8
10
12
14
Time in generations
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
First moment (weighted)
0
2
4
6
8
10
12
14
Time in generations
0
0.5
1
1.5
2
2.5
3
First moment (weighted)
0
2
4
6
8
10
12
14
Time in generations
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
First moment (weighted)
, = &*$%
, = &*$&
, = &*$'
0
2
4
6
8
10
12
14
Time in generations
0
2
4
6
8
10
Mean copy number
0
2
4
6
8
10
12
14
Time in generations
0
2
4
6
8
10
Mean copy number
a
d
b
c
e
f
, = &*$%
, = &*$&
, = &*$'
Figure S7: Dynamics for ecDNA geno-/pheno-types under non-identical
fitness scenario (sy = 2.5, sr = 1). Three different values for py = p are considered.
a-c. Weighted first moment. This refers to the contribution of pure and mix
cells to the mean copy number of the total population. d-f. Mean copy number.
This refers to the absolute mean copy number of the subpopulations. The initial
condition is a single cell with 1 yellow.
32
