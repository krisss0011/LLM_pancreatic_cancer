OCEAN: Flexible Feature Set Aggregation for
Analysis of Multi-omics Data
Mitra Ebarahimpoor ∗1, Ren´ee Menezes2, Ningning Xu1, and Jelle J. Goeman1
1Department of Biomedical Data Sciences, Leiden University Medical Center,
Leiden, The Netherlands
2Biostatistics Centre, Department of Psychosocial Research and Epidemiology,
Netherlands Cancer Institute, Amsterdam, The Netherlands
Abstract
Integrated analysis of multi-omics datasets holds great promise for
uncovering complex biological processes. However, the large dimension
of omics data poses significant interpretability and multiple testing chal-
lenges. Simultaneous Enrichment Analysis (SEA) was introduced to ad-
dress these issues in single-omics analysis, providing an in-built multiple
testing correction and enabling simultaneous feature set testing. In this
paper, we introduce OCEAN, an extension of SEA to multi-omics data.
OCEAN is a flexible approach to analyze potentially all possible two-way
feature sets from any pair of genomics datasets. We also propose two new
error rates which are in line with the two-way structure of the data and
facilitate interpretation of the results. The power and utility of OCEAN
is demonstrated by analyzing copy number and gene expression data for
breast and colon cancer.
1
Introduction
Joint analysis of multiple genomics datasets has the potential to offer a deeper
understanding of complex biological phenomena and disease processes (Zhang
et al., 2017; Huang et al., 2011). By combining information from multiple ge-
nomic levels such as gene expression, copy number variation and DNA methy-
lation, say, such analyses can unveil the interaction between various molecular
layers and identify synergistic relationships (Stranger et al., 2005; Bhattacharya
et al., 2020; Behring et al., 2018; Menezes et al., 2016; Huang et al., 2011).
There are several methods for joint analysis of omics data, such as regression,
correlation, co-expression, Bayesian networks, and machine learning algorithms
such as random forest or support vector machines (see Subramanian et al., 2020,
∗Corresponding Author: m.ebrahimpoor@lumc.nl
1
arXiv:2410.19523v1  [stat.ME]  25 Oct 2024
for an overview). Studying pairwise associations between omics features remains
one of the most commonly adopted methods (Gu et al., 2008; Kotliarov et al.,
2009; Huang et al., 2011; Lahti et al., 2012). However, the scale of the analysis
is an issue: the huge matrix of pairwise associations can be hard to interpret
and leads to a massive multiple testing problem.
When analyzing a single-omics type, an established solution to the scale
problem of the data is to consider sets of features, rather than individual ones.
This alleviates the multiple testing problem and improves power (Menezes et al.,
2009, 2016; Khatri et al., 2012; Huang et al., 2011; Maleki et al., 2020; Zhao
and Rhee, 2023), and also leverages the existing biological knowledge, providing
context and interpretability. Feature sets can be defined based on shared biolog-
ical characteristics or attributes such as location, function, biological pathway
or disease association. Popular feature set resources include Reactome, KEGG,
MSigDB, OncoKB, dbSNP and TCGA. The concept of feature sets has been
extended to multi-omics analyses. For example, Chaturvedi et al. (2016) pro-
posed a test for association of two-way feature sets: combinations of a feature
set in one omics type with a feature set in another, for example for identify-
ing genomic regions that are associated with changes in gene expression of a
molecular pathway.
Simultaneous Enrichment Analysis (SEA) was recently introduced as a novel
way of analyzing feature sets in single-omics (Ebrahimpoor et al., 2019).
It
has several advantages over classical single-omics feature set methods. It has
an in-built multiple testing correction, in contrast with classical feature set
testing methods which require an additional multiple testing step after the initial
analysis.
This multiple testing correction automatically includes all possible
feature sets, obviating the need to pre-specify the collection of feature sets of
interest. This gives great flexibility to researchers: they may decide upon feature
sets of interest after seeing the data, while still maintaining proper Type I
error control. SEA was shown to have at least comparable power to classical
feature set methods when all of the feature sets in Gene Ontology were tested.
Furthermore, rather than merely returning a p-value for the sets, it quantifies the
signal within feature sets. It does this by giving a simultaneous 95%-confidence
lower bound of the true discovery proportion (TDP), i.e., the proportion of truly
active features in the set.
In this paper we explore the extension of SEA to multi-omics.
A direct
application in terms of two-way feature sets is relatively straightforward and
already showcases some of the advantages of SEA. SEA’s flexibility of choosing
feature sets after seeing the data is especially useful in multi-omics, because there
is a quadratic number of two-way feature sets to explore. The large number of
potential feature set combinations is also expected to make SEA competitive in
terms of power. However, the TDP that SEA returns will be in terms of pairs
and ignores the matrix structure of the two-way feature sets. The pair-based
TDP is not easy to interpret in terms of each of the individual omics features
(Luijk et al., 2014). To solve this, we propose alternative definitions of TDP,
quantifying the signal in a way that respects the two-way structure.
These
per-omic TDPs estimate the number of features within a feature set of omic A
2
that are associated with at least one feature in a feature set of omic B (and
vice-versa). We show here that SEA can give 95%-confidence bounds for the
two per-omic TDPs, simultaneous with the pair-TDP, without the need for any
additional multiple testing correction.
We will first revisit SEA and introduce its direct extension to multi-omics.
Subsequently, we present the two novel TDP measures and the way they can be
controlled. This control involves the development of a novel branch-and-bound
algorithm. We call our novel method OCEAN, as it is an extension of SEA. We
demonstrate the utility of OCEAN with an integrated analysis of copy number
(CN) and gene expression (GE) datasets for breast cancer and colon cancer, and
show its ability to identify previously known and novel feature sets of interest
in cancer research.
2
Notation
Though our method is more general, we will restrict our presentation to two
omics types for the sake of simplicity. Assume that we have two omics from a
cohort of n individuals: omic A and omic B, which include p and q features,
respectively. P is a p × q association matrix where the element pjk represents
the corresponding p-value for the pairwise association, each testing the null
hypothesis H0,jk: jth feature of omic A is not associated with the kth feature
of omic B.
We are not primarily interested in testing the individual or elementary hy-
potheses H0,jk. Instead, we are interested in testing the null hypothesis for sets
of features. Let SA ⊆{1, . . . , p} and SB ⊆{1, . . . , q} be feature sets within
omic A and B, respectively. Let M = {1, . . . , p} × {1, . . . , q}, with m = pq
elements, and define S = SA × SB as the subset of M of interest. Considering
all possible choices of SA and SB, there are roughly 2p+q possible sub-matrices
of P, or two-way feature sets, that may be of interest.
3
SEA for multi-omics
We will review SEA, which was developed for analysis of single-omics (Ebrahim-
poor et al., 2019), and present its first extension to multi-omics. SEA contrasts
with other feature set testing methods in two important respects. In the first
place, it does not test only a limited database of feature sets, but all possible
feature sets, and corrects for multiple testing for all of them. This implies that
the validity of the method is not compromised if the user peeks at the data
before choosing feature sets of interest. Secondly, it does not primarily report
a p-value, but a much more informative lower (1 −α)- confidence bound on the
true discovery proportion (TDP), i.e., the proportion of true effects present in
the feature set.
SEA is easily generalized to multi-omics, and we will explain it directly in
those terms. In this generalization, the TDP is defined as follows. Let D ⊆M
3
be the unknown set of true discoveries, i.e., the collection of pairs for which
there is some association between omic A and omic B. Then the true discovery
proportion (TDP) for S is defined as
TDP(S) = d(S)
|S| ,
where d(S) = |D ∩S| is number of correctly identified associations (“true dis-
coveries”) within S, and |S| is the number of elements in S.
The goal of SEA is to give a lower bound for TDP(S) for every S of in-
terest while controlling the Type I error. Goeman et al. (2019) derived such
simultaneous lower bounds ¯d(S) for all d(S) as
¯d(S) =
max
1≤u≤|S| 1 −u + |{i ∈S : hpi ≤uα}|,
(1)
where
h = max{r ∈{0, ..., m}: rp(m−r+j) > jα, for j = 1, ..., r},
(2)
where p(m−r+j) is the (m −r + j)th smallest p-value with index in M.
For this bound, it holds that
P( ¯d(S) ≤d(S) for all S) ≥1 −α,
(3)
i.e., ¯d(S) is a lower (1 −α)- confidence bound for the number of true dis-
coveries in S, and it immediately follows that ¯d(S)/|S| is a (1 −α)-confidence
bound for TDP(S). Importantly, the bound is simultaneous for all S, implying
that it remains valid if S is chosen after seeing the data.
Bounds of the form (3) can be derived from any Closed Testing procedure
(Marcus et al., 1976; Genovese and Wasserman, 2006; Goeman and Solari, 2011).
For the particular bound (1), SEA uses a particular Closed Testing procedure
first proposed by Hommel (1988) that is based on a test of Simes (1986), and
extended to TDP by Goeman et al. (2019). This procedure assumes that the
p-values are generally positively correlated, an assumption that the FDR pro-
cedure of Benjamini and Hochberg (1995) also makes. Goeman et al. (2019)
showed that for this procedure ¯d(S) has good power for large numbers of hy-
potheses, and can be efficiently calculated. The extension of SEA to multi-omics
is very similar to the SEA for a single omic. It allows a researcher to browse
through many feature sets of interest in both omics, choosing the most inter-
esting combination in terms of both biology and TDP. This TDP is defined in
terms of pairs: it is a lower bound to the proportion of omic × omic pairs for
which an association is truly present. We will refer to the TDP derived in this
section as the pair-TDP.
4
OCEAN
While the pair-TDP is a useful overall estimate, it does not specify how many
features from omic A are associated with the set of selected features from omic
4
B or the other way around. We can illustrate this with a toy example in Figure
1. This shows a 15 × 20 matrix of pairwise associations. Two two-way feature
sets are marked in the matrix, both of size 5 × 8, denoted by a and b. For both
sets the pair-TDP is 7/40, yet it is very clear that the structure of associations
in these sets is very different. For set a, all true associations are concentrated in
two of the genes, while for set b the associations are more scattered, indicating
that more of the features in omic A are associated with the feature set of omic
B.
Figure 1: Toy example of a small dataset with 15 genes and 20 SNPs, truly
correlated probes are marked with a black circle. The two-way feature sets
are indicated by red rectangles have the same pair-TDP of 7/40. However,
number of rows including at least one discovery is different for the two sets.
In this section, therefore, we will introduce two new TDP metrics which will
be able to quantify the signal in the two-way feature sets that focus specifically
on both contributing omics. Since the two omics form the rows and columns
of the matrix M we will refer to these as row-TDP and column-TDP. Due to
symmetry it suffices to discuss row-TDP only.
In words, the row-TDP of a two-way feature set SA × SB is the proportion
of features from SA that associates with at least one feature in SB. In Figure
1, row-TDP is 2/5 for two-way feature set a and 4/5 for two-way feature set b.
Column-TDP is 5/8 both for a and b. By reporting row-TDP and column-TDP
in addition to pair-TDP, the researcher gets a much better impression of the
structure of the associations. Both row-TDP and column-TDP are always at
least as large as the pair-TDP.
Formally, for j = 1, . . . , p, let Vj = {j} × {1, . . . , q} be the jth row of M.
We can define row-TDP in terms of set × set null hypotheses as follows. We
5
may see the two-way feature set S = SA × SB as composed of rows. There are
|SA| such rows, defined as Srow(j) = S ∩Vj = {j} × SB for each j ∈SA. Such
row contains signal if d(Srow(j)) > 0; we call these the true discoveries at the
row level. The number of rows that contain signal is
dr(S) = |j ∈SA : d(Vj) > 0|,
(4)
and the row-TDP of S is therefore dr(S)/|SA|.
A lower bound for dr(S) can be derived using the closed testing-based argu-
ments used by Goeman and Solari (2011), as
¯dr(S) = |SA| −max
I⊆SA{|I|: ¯d(I × SB) = 0}.
(5)
To see that this lower bound is valid, let E = { ¯d(S) ≤d(S) for all S} be the
event that SEA did not make an error. By (3), we have P(E) ≥1 −α. If E
happened, then we have
¯dr(S)
≤
|SA| −max
J⊆SA{|J|: d(J × SB) = 0}
=
|SA| −|j ∈SA : d(Vj) = 0|
=
dr(S).
Therefore,
P( ¯dr(S) ≤dr(S)) ≥P(E) ≥1 −α,
which implies that ¯dr(S) is indeed a valid lower bound to the row-TDP of S.
Moreover, we even have simultaneous control:
P( ¯dr(S) ≤dr(S) for all S) ≥P(E) ≥1 −α,
(6)
since the coverage event E is the same for all S.
We can bound the column-TDP in the same way. Since the coverage event
E is the same for row-TDP and for column-TDP, we get simultaneous control
for row-TDP and column-TDP, implying that we do not need to correct for
multiplicity if we want to report both. In fact, the coverage event is also the
same for pair-TDP, so all three can always safely be reported together.
5
Algorithms
In this section we introduce an algorithm targeted to finding the quantity ¯dr(S).
The algorithm consists of two steps. The first step, which we call the single step
shortcut, brackets ¯dr(S). The second step uses a branch-and-bound algorithm
that narrows these brackets further and further until convergence.
To calculate ¯dr(S), according to (5), we need to check for many sets T
whether ¯dr(T) > 0 in SEA. Goeman et al. (2019) showed that the null hypothesis
¯d(T) > 0 if and only if for some 1 ≤r ≤|T|, we have
hp(r:T ) ≤rα,
(7)
6
where p(r:T ) is the rth ordered p-value with index in T and h is defined in
(2). The calculations in (7) essentially use discretized p-values, since it is only
relevant how many multiples of α/h each p-value makes. Defining the p-category
of each p as r = min{r : hp ≤rα}, we can equivalently say that ¯d(T) > 0 if and
only if there exists some u ∈N such that there are u or more p-categories in T
that are at most u. We will work with this latter formulation of (7).
We will illustrate our algorithm with a toy example of a 6 × 7 two-way set.
It is presented in terms of p-categories in Table 1. Here, for example the top
right p-category of 3 indicates that the corresponding p-value is between 2α/h
and 3α/h. We can see that ¯d(V1) > 0, since there is a p-category of 1 in the
first row, and that ¯d(V4) > 0, since there are two p-category of 2 in the fourth
row. All other rows have ¯d(Vj) = 0.
V1
3
948
35
5
14
1
24
V2
11
49
7
2
27
224
18
V3
13
160
20
12
4
2
8
V4
78
2
75
3
5
25
2
V5
17
4
142
80
15
451
31
V6
82
71
23
67
762
5
20
Table 1: Toy example - p-categories matrix
To see this more easily, we can represent the same table in terms of cu-
mulative categories, as shown in Table 2. Per row, the cumulative categories
{cjk ≤u; u ∈N} count the number of p-categories below u = 1, 2, . . .. In this
table, we can read off more directly which rows have ¯d(Vj) > 0, since these rows
have cjk ≥k for some k. For example, we see that ¯d(V1) > 0 since c11 ≥1, and
that ¯d(V4) > 0 since c42 ≥2. The cumulative categories table never needs more
than |S| columns, and is further bounded by Goeman et al. (2019, Lemma 3).
u
1
2
3
4
5
6
7
...
c1k
1
1
2
2
3
3
3
...
c2k
0
1
1
1
1
1
2
...
c3k
0
1
1
2
2
2
2
...
c4k
0
2
3
3
4
4
4
...
c5k
0
0
0
1
1
1
1
...
c6k
0
0
0
0
1
1
1
...
Table 2: Toy example - Cumulative p-category count matrix
We will now use this cumulative table to construct both an upper and a
lower bound for ¯dr(S). We will find B and H such that B ≤¯dr(S) ≤H.
According to (5), to calculate ¯dr(S), it is not sufficient to check whether
¯d(Vj) > 0 for all j, but we also need to look at unions, e.g. ¯d(Vj ∪Vt). From
Table 2 we can easily check whether ¯d is positive for such unions by adding the
7
corresponding rows. For example, though ¯d(V2) = 0 and ¯d(V3) = 0, we see that
¯d(V2 ∪V3) > 0, since c22 + c32 = 2. For every J ⊆SA, define cJ,k = P
j∈J cjk.
To find the bound B, we sort the columns of the cumulative categories
table in ascending order and take a cumulative sum in each column. In the toy
example, the result of this operation is given in Table 3. Call the elements of the
resulting table wjk. Now, we have the property that, if |J| = j, then cJ,k ≥wjk.
To see that this is true, note that each wjk is the sum of the smallest elements
in the corresponding column of the cumulative categories table. It follows that,
if wjk ≥k for some k, then cJ,k ≥k for all J with |J| = j, so ¯d(J × SB) > 0. In
fact, the same automatically holds for all J with |J| ≥j, since wjk is increasing
in j. Therefore, the maximal |J| for which ¯d(J ×SB) = 0 is at most j −1, so, by
(5), ¯dr(S) ≥|SA|−(j −1). To exploit this fact in an optimal way, we must look
for the smallest j such that wjk ≥k. In Table 3, we see that w3k < k for all k,
but w42 = 2, w44 = 4 and w45 = 5, so j = 4 and ¯dr(S) ≥|SA| −(4 −1) = 3.
u
1
2
3
4
5
6
7
...
w1k
0
0
0
0
1
1
1
...
w2k
0
0
0
1
2
2
2
...
w3k
0
1
1
2
3
3
4
...
w4k
0
2
2
4
5
5
6
...
w5k
0
3
4
6
8
8
9
...
w6k
1
5
7
9
12
12
13
...
Table 3: Toy example - Calculation of bound B. The smallest j for
which wjk ≥k, for some k, is 4.
To obtain the heuristic H, we reorder the rows of the cumulative category
table in any way we like, and take the cumulative sum as above.
Call the
values in the resulting table vjk. Each vjk is equal to cJ,k for a specific J with
|J| = j. If, for some j, vjk < k for all k, then there exists an J ⊂SA such that
¯d(J × SB) = 0, so, by (5), ¯dr(S) ≤|SA| −j. It follows that we need to find
the largest j such that vjk < k for all k. Since vjk is increasing in k, we have
j = j∗−1, where j∗is the smallest vjk such that vjk ≥k for some k. Then
¯dr(S) ≤|SA| −(j∗−1). In Table 4, we see that v1k < k for all k, but v21 = 1,
so j = 2 and ¯dr(S) ≤|SA| −(2 −1) = 5.
Combining the bound and the heuristic, we find that 3 ≤¯dr(S) ≤4. Note
the similarity between the calculation of H and B. Both bounds result from
the same algorithm applied to a differently pre-processed table. This algorithm
can be performed in linear time in the number of rows and columns of the table,
by starting at bottom left, going up in the table when vjk ≥k (or wjk ≥k,
respectively) and right otherwise. The row j in which we drop of the right edge
of the table is the largest j for which vjk < k for all k.
8
u
1
2
3
4
5
6
7
...
v1k
0
0
0
1
1
1
1
...
v2k
1
1
2
3
4
4
4
...
v3k
1
1
2
3
5
5
5
...
v4k
1
3
5
6
9
9
9
...
v5k
1
4
6
7
10
10
11
...
v6k
1
5
7
9
12
12
13
...
Table 4: Toy example - Calculation of heuristic H. The smallest j
for which vjk ≥k, for some k, is 2.
The upper bound H is valid for any ordering of the rows, but it can be tighter
or less tight depending on the chosen order. To get a small H, we need to have
rows with small categories concentrated at bottom. To achieve this, we suggest
to order the rows by decreasing adjusted p-values of the Vj’s. Calculation of
adjusted p-values is given in Ebrahimpoor et al. (2019, equation 5).
The search for H and B is summarized in Algorithm 1.
When using the result of the algorithm, the lower bound B is of primary
interest, since replacing ¯dr(S) by the lower bound retains the crucial property
(6). The upper bound tells us how well we approximated ¯dr(S). The precision
can be increased by spending more computational power, as we will show in the
next section.
5.1
Branch and bound
If B = H, the algorithm gives an exact result for ¯dr(S). If B < H, ¯dr(S) is only
bracketed. The brackets can be narrowed by a branch-and-bound algorithm.
We present this algorithm in this section.
Branch and Bound is an optimization technique (Land and Doig, 1960; Mit-
ten, 1970) for discrete problems. It divides the search space into smaller disjoint
sub-spaces (branches), evaluates them using a heuristic, and prunes branches
that cannot lead to better solutions by using a bound. By repeatedly branch-
ing and eliminating unpromising paths, it efficiently searches for the optimal
solution.
Branch-and-bound is useful in our problem, because (5) represents a discrete
optimization problem in the exponential search space of all subsets of SA. We
repeatedly split the space by either considering subsets including a certain row,
or subsets excluding that row. The row to exclude is chosen is the one with the
smallest adjusted p-value. We apply Algorithm 5 in each subspace evaluated by
the algorithm. Here, H plays the role of the heuristic, and B of the bound.
Going back to the toy example, we can see that it is possible to improve
9
Algorithm 1
Input: Matrix of cumulative p-categories with elements cjk and size r × l
function Findj(tjk)
j = r
k = 1
while k ≤l & j ≥1 do
if tjk ≥k then
j = j −1
else
k = k + 1
return j
function bound(cjk)
▷Find B
wjk ←Sort each column of cjk in ascending order
wjk ←Pj
j=1 wjk
B = l −Findj(wjk) + 1
return B
function heuristic(cjk)
▷Find H
vjk ←Sort rows of cjk by pj
adj in descending order
vjk ←Pj
j=1 vjk
H = l −Findj(vjk) + 1
return H
return [B, H]
10
u
u
1
2
3
4
5
6
7
1
2
3
4
5
6
7
w+1
1k
1
1
2
2
3
3
3
v+1
1k
1
1
2
2
3
3
3
w+1
2k
1
1
2
2
4
4
4
v+1
2k
1
2
3
4
5
5
5
w+1
3k
1
1
2
3
5
5
5
v+1
3k
1
3
4
5
6
6
7
w+1
4k
1
2
3
4
6
6
7
v+1
4k
1
5
7
8
10
10
11
w+1
5k
1
3
4
6
8
8
9
v+1
5k
1
5
7
9
11
11
12
w+1
6k
1
5
7
9
12
12
13
v+1
6k
1
5
7
9
12
12
13
Table 5: Toy example - Calculation of H and B for the branch
where the first row from cij matrix is forced to be included in all
combinations (set to w+1
1k and v+1
1k ). This branch must be discarded
based on the value of its bound B = 6; meaning it is not possible
to find an improved Heuristic in this branch.
u
u
1
2
3
4
5
6
7
1
2
3
4
5
6
7
w−1
1k
0
0
0
0
1
1
1
v−1
1k
0
0
0
1
1
1
1
w−1
2k
0
0
0
1
2
2
2
v−1
2k
0
0
0
1
2
2
2
w−1
3k
0
1
1
2
3
3
4
v−1
3k
0
1
1
2
3
3
4
w−1
4k
0
2
2
4
5
5
6
v−1
4k
0
2
2
4
5
5
6
w−1
5k
0
4
5
7
9
9
10
v−1
5k
0
4
5
7
9
9
10
Table 6: Toy example - Calculation of H and B for the branch where
first row from cjk matrix is removed. As v−1
42 ≥2 and v−1
45 ≥5 the
improved heuristic is H = 3 leading to a sure outcome of 3.
the resulting bound by branching based on first row. Table 5 shows the search
for B and H in the subspace where first row is forced to be included; which
is achieved by fixing it on the top row throughout the ordering steps of the
algorithm. Considering the value of B = 6, it is not possible to find a better
Heuristic in this subspace. Table 6 shows the search for B and H in the subspace
where first row is removed. The new Heuristic is smaller than the one calculated
based on the full set and leads to an exact outcome of dr(S) = 3.
The resulting branch-and-bound algorithm is given in Algorithm 2.
Note that the algorithm needs to repeatedly construct cumulative category
count matrices. By some bookkeeping, information from earlier calculated ma-
trices can be reused to speed up the steps of the branch-and-bound algorithm.
This is implemented within OCEAN R package.
The algorithm can be run until convergence, i.e. until the queue is empty.
In that case the calculation of ¯dr(S) is exact. However, this takes exponential
computation time in the worst case.
However, we may stop the procedure
11
Algorithm 2
Initialize
Q = S
i = 0
Get [bound(S), heuristic(S)] from Algorithm 1
H=heuristic(S)
while Q ̸= ∅& i < maxi do
i ←i+1
Ci = last in the queue & remove Ci from queue
B′ = max(bound(Ci), bound(Cp
i )1)
if H ≤B′ then
Do nothing
else
H = min(H, heuristic(Ci))
Split Ci as
C+ = {Ci : first row is forced.}
C−= {Ci : first row is removed.}
Add C+ and C−to Q keeping record of their parent set Ci.
B = min(H, min[bound(Ci); Ci ∈Q)])
return [B, H]
1 Cp
i , or the parent set, is the set that Ci’s are split from as defined above.
12
earlier, e.g. after a fixed number of iterations. This may sometimes still yield
an exact outcome. If not, the final bounds will often be tighter than the one
from Algorithm 1. The resulting improved lower bound will still have the crucial
property (6).
6
Application
To illustrate OCEAN’s flexibility, we will use it in the joint analysis of mRNA
gene expression (GE) and DNA copy number (CN) data from breast cancer
(BRCA, 173 samples) from The Cancer Genome Atlas (TCGA – data generated
by the TCGA Research Network https://www.cancer.gov/tcga). The CN
data available is segmented per sample. To be able to analyse the data, we
chose 3 × 104 equally spaced loci covering the entire genome and extracted the
corresponding segment’s value for each location, yielding a vector of 3×104 CN
values for each of the samples. The GE data was pre-processed as described
in Menezes et al. (2009), which yielded 74985 measurements per sample. To
put results in context, we also analyse similar data from 125 colorectal cancer
samples (CRC), involving 75085 GE features after pre-processing.
We calculated the Pearson correlation coefficient for all gene expression and
copy number probe pairs per cancer type, computing the corresponding p-value
matrices (GE by CN) of sizes 75085×30000 for colon cancer and 74985×30000 for
breast cancer. It is very challenging to draw any conclusion about associations
between CN and GE based upon all 2×109 pairwise tests, due to multiple testing
correction. In addition, selected pairs would have to be put back into a biological
context before yielding useful information. For example, CN is often interpreted
in terms of segments, as CN changes are observed in stretches of DNA. GE, on
the other hand, is often interpreted in the context of biological pathways. So
it would be useful to group some rows and columns of the resulting matrix of
p-values and interpret these groups, effectively using feature sets instead of the
original features.
OCEAN can help by enabling us to do exactly that, in a way that preserves
the required multiple testing correction level. Here we will define GE feature
sets based on hallmark pathways (Liberzon et al., 2015), and either chromosome
arm or chromosome band for CN. For each feature set, GE TDP (row), CN
TDP (column) and pairwise TDP (taking both CN and GE into account) were
calculated.
Scatter plots in Figure 2 compare the results for BRCA and CRC using
three TDP types, using hallmark pathways (GE) and chromosome arms (CN)
as feature sets. In general, there is consistently more signal from CN (Figure2c)
than from GE (Figure 2b) for both cancer types, with very low true discovery
proportions from GE in general, compared to those from CN. The results for
pairwise TDP (Figure 2a) do not offer any patterns and seem to reflect mostly
the GE signal.
Some chromosome arms yield clearer patterns. Indeed, feature sets involving
5q (displayed in green in Figure 2) have relatively high values for all TDPs in
13
Figure 2: Scatter plots of TDP for BRCA (x-axis) and CRC (y-axis), for three different
TDP types: a) pairwise TDP, b) GE TDP, c) CN TDP. The feature sets used are Hallmark
pathways (GE) and chromosome arm (CN). Two chromosome arms (20q and 5q) are marked
across the three plots. The graphs are on different scales to make patterns visible. For the
same graphs made using the same scales, see Supplementary Figure 1
BRCA, but for CRC only some of these sets carry a large signal for CN TDP.
This is consistent with reports of loss of 5q in samples of a breast cancer subtype,
and this loss includes at least 2 genes involved in a BRCA1-dependent DNA
repair pathway (see for example Weigman et al. (2012)). As samples presenting
this CN change were reported to have poorer prognosis, the CN change is likely
to impact GE levels, in particular of genes in Hallmark pathways.
Conversely, feature sets involving 20q (displayed in red in Figure 2) display
higher TDPs for CRC than BRCA. This also makes sense, as DNA copy gain on
20q is often observed for CRC (Ried et al., 2019). This copy number gain is in
fact already found in adenomas before progression to carcinoma, suggesting it is
likely to impact GE levels. Indeed, it is known that 20q, among other commonly
observed CN changes, do have a direct impact on GE levels (see references in
Ried et al. (2019)).
Figure 3: Scatter plots of CN TDP (y-axis) and GE TDP (x-axis) for CRC and BRCA: a)
overlayed results of BRCA and CRC, b) results from CRC only, coloured by their pairwise
TDP, c) results from BRCA only, coloured by pairwise TDP. As before, Hallmark pathways
(GE) and chromosome arms (CN) are the feature sets used.
As shown in Figure 3, CRC samples yield stronger CN effect (as measured
by the pairwise TDP in association with GE) than BRCA. This is in accordance
14
with previous studies where GE and CN have shown stronger associations in
CRC than in BRCA (Menezes et al., 2016).
Once more, it is evident that
pairwise TDP, although correlated with GE TDP and CN TDP, does not offer
sufficient specificity in these data.
Figure 4: Hierarchically clustered heatmap of a) GE TDP and b) CN TDP for BRCA. As
before, Hallmark pathways (GE) and chromosome arms (CN) are the feature sets used.
Figure 4 displays heatmaps of GE TDP (a) and CN TDP (b) for two-way fea-
ture sets defined by Hallmark pathways (rows) and chromosome arms (columns)
for the BRCA data. Some patterns are shared between both TDP levels, whilst
others are specific to one TDP type. For instance, 5q shows consistently high
CN and GE TDPs for many Hallmark pathways (see left-most column in figure
4a and right-most column in figure 4b), whereas 1q and 8q only display high
CN TDP with most pathways. This means that a high proportion of CN mea-
surements within 1q and 8q are found to be associated with several Hallmark
pathways, even after multiplicity correction, but the same does not happen with
GE measurements. Similar plots for CRC (Supplementary Figure 2) show that
GE and CN TDPs for 20q have high values for many Hallmark pathways. On
the other hand, CN TDP for 18q and 13q is high for most Hallmark pathways,
but the same is not true for GE TDPs.
Chromosome arms are useful CN feature sets, as there are CN aberrations
which span an entire arm. However, there are also smaller CN aberrations, which
are then likely missed when using an entire chromosome arm. For example, DNA
CN gains on 13q and 20q are often observed in CRC (Ried et al., 2019), and
it may therefore be useful to further explore results at a finer scale on these
chromosome arms.
One finer scale is that of chromosome bands, which are
smaller regions of DNA. So, we recomputed CN TDPs for the CRC data, now
using chromosome bands on 13q and 20q (see 5 for CRC, and Supplementary
15
Figure 3 for the corresponding figure for BRCA using bands in 5q and 1q).
Figure 5: TDPs for CRC results, GE TDP on the upper triangle and CN TDP on the lower
triangle per feature set pair. Hallmark pathways (GE) and chromosome bands (CN) are the
feature sets used. The figure provides details at chromosome band level for the two prominent
chromosome arm from Supplementary Figure 2: a) 13q and b) 20q.
As before, CN TDPs are typically considerably higher than corresponding
GE TDPs, and some Hallmark pathways display consistently high CN TDPs for
most chromosome bands. The uniformity of results across bands suggests there
is not much heterogeneity between bands, probably because many CN changes
span almost the entire chromosome arm. However, there are pathways with CN
TDPs high for only regions in 20q, such as MYC_TARGETS_V1 (Figure 5). So the
use of chromosomal bands helps us zoom into regions within a chromosome arm.
A similar plot in the supplementary provides this level of details for 5q and 1q
from BRCA (Supplementary Figure 3).
These illustrations highlight the flexibility that OCEAN offers for the anal-
ysis of multi-omics data, capturing interesting patterns at different levels of
detail, while strictly preserving type I error.
Note that we have analyzed 2
different datasets and the family-wise error rate (FWER) control holds for all
16
the results from each of these datasets. Reanalyses, such as using new sets as
illustrated above, are quickly performed, as they require merely a recalculation
of TDPs.
7
Implementation
Despite the seemingly complex nature of the OCEAN algorithm, it is remarkably
straightforward to analyze multi-omics data using OCEAN R package available
on GitHub (https://github.com/mitra-ep/OCEAN).
Implementation of OCEAN algorithm involves two main steps: preparing
the matrix and calculating discovery rates. The preparation step encompasses
calculating the pairwise p-value matrix P, determining h (as defined in 2), and
estimating the number of columns for the cumulative categories matrix cjk.
These calculations, which utilize the full dimension of the multi-omics data, are
the most time-consuming part of the process. However, this step is performed
only once for a given omics pair and the results can be used to explore any
potential feature sets of interest. For the BRCA dataset, preprocessing step
took about 23 minutes.
Once the preparation step is completed, Algorithm 1 can be adopted to
calculate the row-TDP and column-TDP for any given two-way feature set and
is quite efficient. It can take between a few seconds to up to eight minutes to
calculate row-TDP for a feature set with 100 to over a 1000 rows. Additionally,
the pair-TDP can be obtained using the SEA algorithm, alongside the other
two discovery rates. The ocean function efficiently computes these three TDPs
at once for a given feature set. For the CRC dataset, calculation of the TDPs
takes around one minute if both number of rows and columns of the feature
set are under 600, and it can take up to four minutes for a feature set of size
300×1000. In case the results are not exact i.e. B ̸= H, 2 will be adopted which
can take longer to run,depending on the size of feature set and the number of
necessary steps for convergence. For instance, for a two-way feature set of size
300 × 500, it takes 30 minutes to run the iterative algorithm for 100 steps, and
about an hour if the algorithm converges at 500 steps, assuming B ̸= H for only
row-TDP (GE TDP). However, the rate of such outcomes was only 1.2% and
4.4% for the CRC data based on Hallmark pathways and chromosome arms,
and 0.4% and 0.8% for BRCA based on Hallmark pathways and chromosome
bands, respectively for GE TDP and CN TDP.
8
Discussion
OCEAN provides a flexible tool to explore multi-omics datasets in terms of
two-way feature sets. While pairwise TDPs, from SEA, effectively summarize
associations and control Type I error, interpreting results can be challenging
due to the complex association structure inherent to multi-omics data. To pro-
vide such insight, in addition to pairwise TDPs, row- and column-TDP metrics
17
were introduced, which separately reflect the correlation pattern for each omics
dataset.
The closed testing framework makes OCEAN flexible in both the number of
two-way feature sets being studied, as well as their definitions and eliminates
limitation to a priori selected feature sets. In particular, it is possible to revise
the feature sets used after observing the data, keeping the FWER control level.
This flexibility enhances the utility of OCEAN in exploring associations of
genomics features in a data-driven and unbiased manner, accommodating the
complexity and dimension of genomics datasets.
OCEAN is not free of assumptions. It assumes positive dependence among
features, just like the widely used Benjamini-Hochberg (BH) procedure. OCEAN
can therefore safely be used whenever the BH procedure can.
The example in section 6 involved studying associations between gene ex-
pression and DNA copy number data. In general, OCEAN is not limited to any
specific omics data type, and also is not tailored to cancer data. The algorithm
can be used to simultaneously analyze any two (or more) omics datasets. In-
deed, generalization of OCEAN to more than two dimensions is straightforward
in theory, involving three-way feature sets tested in terms of TDPs for each
side of a cube. However, extension to more than two feature sets becomes in-
creasingly computationally burdensome due to the high number of associations
involved.
We have explored column and row TDPs, within rectangular sets (same
number of rows for all columns). However OCEAN can be extended to include
other error types, defined in terms of disjoint subdivisons other than rows or
columns. TDP for such other error types can be incorporated within the same
closed testing procedure and will not inflate type-I error.
The proposed approach can be used with any chosen pairwise test to de-
rive the pairwise p-value matrix P. Therefore, another potential extension is
adopting more complex statistical tests, rather than the Pearson’s correlation
test used in this paper. For example, OCEAN can be used to detect causal or
non-linear associations whenever the individual association tests can.
9
Acknowledgments
This research was funded by NWO VIDI grant number 639.072.412. The results
presented in section 6 are based upon data generated by the TCGA Research
Network: https://www.cancer.gov/tcga.
References
Behring, M., Shrestha, S., Manne, U., Cui, X., Gonzalez-Reymundez, A.,
Grueneberg, A., and Vazquez, A. I. (2018).
Integrated landscape of copy
number variation and RNA expression associated with nodal metastasis in
invasive ductal breast carcinoma. Oncotarget, 9(96):36836–36848.
18
Benjamini, Y. and Hochberg, Y. (1995). Controlling the false discovery rate:
a practical and powerful approach to multiple testing. Journal of the Royal
Statistical Society: Series B (Methodological), 57(1):289–300.
Bhattacharya, A., Bense, R. D., Urz´ua-Traslavi˜na, C. G., de Vries, E. G. E.,
van Vugt, M. A. T. M., and Fehrmann, R. S. N. (2020).
Transcriptional
effects of copy number alterations in a large set of human cancers. Nature
Communications, 11(1).
Chaturvedi, N., de Menezes, R. X., and Goeman, J. J. (2016). A global × global
test for testing associations between two large sets of variables. Biometrical
Journal, 59(1):145–158.
Ebrahimpoor, M., Spitali, P., Hettne, K., Tsonaka, R., and Goeman, J. (2019).
Simultaneous enrichment analysis of all possible gene-sets:
Unifying self-
contained and competitive methods. Briefings in Bioinformatics, 21(4):1302–
1312.
Genovese, C. R. and Wasserman, L. (2006).
Exceedance control of the
false discovery proportion. Journal of the American Statistical Association,
101(476):1408–1417.
Goeman, J. J., Meijer, R. J., Krebs, T. J. P., and Solari, A. (2019). Simultaneous
control of all false discovery proportions in large-scale multiple hypothesis
testing. Biometrika.
Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research.
Statistical Science, 26(4):584–597.
Gu, W., Choi, H., and Ghosh, D. (2008). Global associations between copy
number and transcript mRNA microarray data: An empirical study. Cancer
Informatics, 6:CIN.S342.
Hommel, G. (1988). A stagewise rejective multiple test procedure based on a
modified bonferroni test. Biometrika, 75(2):383–386.
Huang, N., Shah, P. K., and Li, C. (2011). Lessons from a decade of integrating
cancer copy number alterations with gene expression profiles. Briefings in
Bioinformatics, 13(3):305–316.
Khatri, P., Sirota, M., and Butte, A. J. (2012). Ten years of pathway anal-
ysis: Current approaches and outstanding challenges. PLoS Computational
Biology, 8(2):e1002375.
Kotliarov, Y., Kotliarova, S., Charong, N., Li, A., Walling, J., Aquilanti, E.,
Ahn, S., Steed, M. E., Su, Q., Center, A., Zenklusen, J. C., and Fine, H. A.
(2009). Correlation analysis between Single-Nucleotide Polymorphism and ex-
pression arrays in gliomas identifies potentially relevant target genes. Cancer
Research, 69(4):1596–1603.
19
Lahti, L., Schafer, M., Klein, H.-U., Bicciato, S., and Dugas, M. (2012). Cancer
gene prioritization by integrative analysis of mRNA expression and DNA copy
number data: a comparative review. Briefings in Bioinformatics, 14(1):27–35.
Land, A. H. and Doig, A. G. (1960). An automatic method of solving discrete
programming problems. Econometrica, 28(3):497.
Liberzon, A., Birger, C., Thorvaldsd´ottir, H., Ghandi, M., Mesirov, J., and
Tamayo, P. (2015).
The molecular signatures database hallmark gene set
collection. Cell Systems, 1(6):417–425.
Luijk, R., Goeman, J. J., Slagboom, E. P., Heijmans, B. T., and van Zwet,
E. W. (2014). An alternative approach to multiple testing for methylation
qtl mapping reduces the proportion of falsely identified cpgs. Bioinformatics,
31(3):340–345.
Maleki, F., Ovens, K., Hogan, D. J., and Kusalik, A. J. (2020). Gene set analysis:
Challenges, opportunities, and future research. Frontiers in Genetics, 11.
Marcus, R. U. T. H., Peritz, E. R. I. C., and Gabriel, K. R. (1976).
On
closed testing procedures with special reference to ordered analysis of vari-
ance. Biometrika, 63(3):655–660.
Menezes, R., Mohammadi, L., J. Goeman, J., and M. Boer, J. (2016). Analysing
multiple types of molecular profiles simultaneously: connecting the needles in
the haystack. BMC bioinformatics, 17:1–16.
Menezes, R. X., Boetzer, M., Sieswerda, M., van Ommen, G.-J. B., and Boer,
J. M. (2009). Integrated analysis of DNA copy number and gene expression
microarray data using gene sets. BMC Bioinformatics, 10(1).
Mitten, L. G. (1970). Branch-and-bound methods: General formulation and
properties. Operations Research, 18(1):24–34.
Ried, T., Meijer, G. A., Harrison, D. J., Grech, G., Franch-Exp´osito, S., Briffa,
R., Carvalho, B., and Camps, J. (2019). The landscape of genomic copy num-
ber alterations in colorectal cancer and their consequences on gene expression
levels and disease outcome. Molecular Aspects of Medicine, 69:48–61.
Simes, R. J. (1986). An improved bonferroni procedure for multiple tests of
significance. Biometrika, 73(3):751–754.
Stranger, B. E., Forrest, M. S., Clark, A. G., Minichiello, M. J., Deutsch, S.,
Lyle, R., Hunt, S., Kahl, B., Antonarakis, S. E., Tavar´e, S., Deloukas, P.,
and Dermitzakis, E. T. (2005). Genome-wide associations of gene expression
variation in humans. PLoS Genetics, 1(6):e78.
Subramanian, I., Verma, S., Kumar, S., Jere, A., and Anamika, K. (2020).
Multi-omics Data Integration, Interpretation, and Its Application. Bioinfor-
matics and Biology Insights, 14:1177932219899051.
20
Weigman, V. J., Chao, H.-H., Shabalin, A. A., He, X., Parker, J. S., Nordgard,
S. H., Grushko, T., Huo, D., Nwachukwu, C., Nobel, A., Kristensen, V. N.,
Børresen-Dale, A.-L., Olopade, O. I., and Perou, C. M. (2012). Basal-like
Breast cancer DNA copy number losses identify genes involved in genomic
instability, response to therapy, and patient survival. Breast Cancer Research
and Treatment, 133(3):865–880.
Zhang, Y., Ng, P. K.-S., Kucherlapati, M., Chen, F., Liu, Y., Tsang, Y. H.,
de Velasco, G., Jeong, K. J., Akbani, R., Hadjipanayis, A., Pantazi, A.,
Bristow, C. A., Lee, E., Mahadeshwar, H. S., Tang, J., Zhang, J., Yang,
L., Seth, S., Lee, S., Ren, X., Song, X., Sun, H., Seidman, J., Luquette,
L. J., Xi, R., Chin, L., Protopopov, A., Westbrook, T. F., Shelley, C. S.,
Choueiri, T. K., Ittmann, M., Waes, C. V., Weinstein, J. N., Liang, H.,
Henske, E. P., Godwin, A. K., Park, P. J., Kucherlapati, R., Scott, K. L.,
Mills, G. B., Kwiatkowski, D. J., and Creighton, C. J. (2017). A pan-cancer
proteogenomic atlas of PI3k/AKT/mTOR pathway alterations. Cancer Cell,
31(6):820–832.e3.
Zhao, K. and Rhee, S. Y. (2023). Interpreting omics data with pathway enrich-
ment analysis. Trends in Genetics, 39(4):308–319.
21
A
Supplementary Material
Details of the results are presented in sections 6 of the main article. Here we
present some additional figures.
Supplementary Figure 1
Scatter plot of TDPs with similar scaling.
Figure 6: Scatter plots of TDP at three levels for CRC against BRCA. a) pairwise TDP,
b) GE TDP, c) CN TDP. The data are aggregated by hallmark pathways for GE and by
chromosome arm for CN.
Supplementary Figure 2
Heatmap of GE TDP aggregated by hallmark pathways (rows) and chromo-
some arms (columns) for CRC in terms of GE TDP (a) and CN TDP (b).
Figure 7: Hierarchically clustered heatmap of a) GE TDP and b) CN TDP for CRC.
22
Supplementary Figure 3
GE TDP and CN TDP for BRCA, with focus on q5 chromosome arm.
Figure 8:
Correlation matrix of BRCA results with GE TDP on the upper triangle and
CN TDP on the lower triangle; CN measurements are aggregated by chromosome band and
GE by hallmark pathways. The figure basically zooms into 5q chromosome arm and provides
details per chromosome band.
23
